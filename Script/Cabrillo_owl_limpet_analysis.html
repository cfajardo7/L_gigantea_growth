<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nyssa/Cindy">
<meta name="dcterms.date" content="2026-01-20">

<title>Cabrillo National Monument: Owl limpet seasonality and community effects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Cabrillo_owl_limpet_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Cabrillo_owl_limpet_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Cabrillo_owl_limpet_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Cabrillo_owl_limpet_analysis_files/libs/bootstrap/bootstrap-4d7f0bce1131f3e5f9547cd857cfbfc8.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="Cabrillo_owl_limpet_analysis_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="Cabrillo_owl_limpet_analysis_files/libs/pagedtable-1.1/js/pagedtable.js"></script>



</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a>
  <ul class="collapse">
  <li><a href="#design-assumptions-and-why-they-matter" id="toc-design-assumptions-and-why-they-matter" class="nav-link" data-scroll-target="#design-assumptions-and-why-they-matter"><span class="header-section-number">1.1</span> Design assumptions and why they matter</a></li>
  </ul></li>
  <li><a href="#packages-and-helpers" id="toc-packages-and-helpers" class="nav-link" data-scroll-target="#packages-and-helpers"><span class="header-section-number">2</span> Packages and helpers</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">3</span> Import data</a></li>
  <li><a href="#data-cleaning-and-harmonization" id="toc-data-cleaning-and-harmonization" class="nav-link" data-scroll-target="#data-cleaning-and-harmonization"><span class="header-section-number">4</span> Data cleaning and harmonization</a></li>
  <li><a href="#question-1-do-limpet-density-and-size-change-by-season" id="toc-question-1-do-limpet-density-and-size-change-by-season" class="nav-link" data-scroll-target="#question-1-do-limpet-density-and-size-change-by-season"><span class="header-section-number">5</span> Question 1: Do limpet density and size change by season?</a>
  <ul class="collapse">
  <li><a href="#a.-density-true-density-transect-area-50-m²" id="toc-a.-density-true-density-transect-area-50-m²" class="nav-link" data-scroll-target="#a.-density-true-density-transect-area-50-m²"><span class="header-section-number">5.1</span> 1A. Density (true density; transect area = 50 m²)</a></li>
  <li><a href="#b.-size-sl_mm-by-season" id="toc-b.-size-sl_mm-by-season" class="nav-link" data-scroll-target="#b.-size-sl_mm-by-season"><span class="header-section-number">5.2</span> 1B. Size (<code>sl_mm</code>) by season</a></li>
  </ul></li>
  <li><a href="#question-2-does-limpet-presence-affect-community-composition-and-does-it-interact-with-season" id="toc-question-2-does-limpet-presence-affect-community-composition-and-does-it-interact-with-season" class="nav-link" data-scroll-target="#question-2-does-limpet-presence-affect-community-composition-and-does-it-interact-with-season"><span class="header-section-number">6</span> Question 2: Does limpet presence affect community composition, and does it interact with season?</a></li>
  <li><a href="#a.-mobile-invertebrates-counts" id="toc-a.-mobile-invertebrates-counts" class="nav-link" data-scroll-target="#a.-mobile-invertebrates-counts"><span class="header-section-number">7</span> 2A. Mobile invertebrates (counts)</a>
  <ul class="collapse">
  <li><a href="#identify-species-columns" id="toc-identify-species-columns" class="nav-link" data-scroll-target="#identify-species-columns"><span class="header-section-number">7.1</span> Identify species columns</a></li>
  <li><a href="#transformations-for-multivariate-analyses" id="toc-transformations-for-multivariate-analyses" class="nav-link" data-scroll-target="#transformations-for-multivariate-analyses"><span class="header-section-number">7.2</span> Transformations for multivariate analyses</a></li>
  <li><a href="#permanova-adonis2-with-permutations-constrained-by-transect" id="toc-permanova-adonis2-with-permutations-constrained-by-transect" class="nav-link" data-scroll-target="#permanova-adonis2-with-permutations-constrained-by-transect"><span class="header-section-number">7.3</span> PERMANOVA (adonis2) with permutations constrained by transect</a></li>
  <li><a href="#check-dispersion-permdisp" id="toc-check-dispersion-permdisp" class="nav-link" data-scroll-target="#check-dispersion-permdisp"><span class="header-section-number">7.4</span> Check dispersion (PERMDISP)</a></li>
  <li><a href="#ordination-nmds-visualize-patterns" id="toc-ordination-nmds-visualize-patterns" class="nav-link" data-scroll-target="#ordination-nmds-visualize-patterns"><span class="header-section-number">7.5</span> Ordination: NMDS (visualize patterns)</a></li>
  <li><a href="#univariate-summaries-total-abundance" id="toc-univariate-summaries-total-abundance" class="nav-link" data-scroll-target="#univariate-summaries-total-abundance"><span class="header-section-number">7.6</span> Univariate summaries (total abundance)</a></li>
  </ul></li>
  <li><a href="#sessile-community-cover-proportional-cover" id="toc-sessile-community-cover-proportional-cover" class="nav-link" data-scroll-target="#sessile-community-cover-proportional-cover"><span class="header-section-number">8</span> Sessile community (% cover / proportional cover)</a>
  <ul class="collapse">
  <li><a href="#identify-sessile-cover-columns-i-dont-trust-this-analysis-rn" id="toc-identify-sessile-cover-columns-i-dont-trust-this-analysis-rn" class="nav-link" data-scroll-target="#identify-sessile-cover-columns-i-dont-trust-this-analysis-rn"><span class="header-section-number">8.1</span> Identify sessile cover columns — i dont trust this analysis rn</a></li>
  <li><a href="#multivariate-test-permanova-on-gower" id="toc-multivariate-test-permanova-on-gower" class="nav-link" data-scroll-target="#multivariate-test-permanova-on-gower"><span class="header-section-number">8.2</span> Multivariate test: PERMANOVA on gower</a></li>
  <li><a href="#dispersion-check" id="toc-dispersion-check" class="nav-link" data-scroll-target="#dispersion-check"><span class="header-section-number">8.3</span> Dispersion check</a></li>
  <li><a href="#ordination-nmds" id="toc-ordination-nmds" class="nav-link" data-scroll-target="#ordination-nmds"><span class="header-section-number">8.4</span> Ordination: NMDS</a></li>
  <li><a href="#univariate-analyses-for-key-functional-groups" id="toc-univariate-analyses-for-key-functional-groups" class="nav-link" data-scroll-target="#univariate-analyses-for-key-functional-groups"><span class="header-section-number">8.5</span> Univariate analyses for key functional groups</a></li>
  </ul></li>
  <li><a href="#ecological-interpretation-how-to-read-results-fill-in-below-with-your-references" id="toc-ecological-interpretation-how-to-read-results-fill-in-below-with-your-references" class="nav-link" data-scroll-target="#ecological-interpretation-how-to-read-results-fill-in-below-with-your-references"><span class="header-section-number">9</span> Ecological interpretation (how to read results – fill in below with your references)</a>
  <ul class="collapse">
  <li><a href="#seasonal-density-and-size-patterns-whats-plausible" id="toc-seasonal-density-and-size-patterns-whats-plausible" class="nav-link" data-scroll-target="#seasonal-density-and-size-patterns-whats-plausible"><span class="header-section-number">9.1</span> 1) Seasonal density and size patterns (what’s plausible)</a></li>
  <li><a href="#limpet-presence-effects-on-community-composition-expected-directions" id="toc-limpet-presence-effects-on-community-composition-expected-directions" class="nav-link" data-scroll-target="#limpet-presence-effects-on-community-composition-expected-directions"><span class="header-section-number">9.2</span> 2) Limpet presence effects on community composition (expected directions)</a></li>
  <li><a href="#potenitial-storyline" id="toc-potenitial-storyline" class="nav-link" data-scroll-target="#potenitial-storyline"><span class="header-section-number">9.3</span> potenitial storyline</a></li>
  <li><a href="#journals-to-think-about" id="toc-journals-to-think-about" class="nav-link" data-scroll-target="#journals-to-think-about"><span class="header-section-number">9.4</span> Journals to think about</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Cabrillo National Monument: Owl limpet seasonality and community effects</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">A mix of univariate of multivariate statistics to test seasonality in both limpet size/density and community responses</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nyssa/Cindy </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">January 20, 2026</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<p>This Quarto notebook analyzes three datasets from <strong>Cabrillo National Monument (San Diego, CA)</strong> to answer:</p>
<ol type="1">
<li><strong>Seasonality in owl limpets (<em>Lottia gigantea</em>)</strong>
<ul>
<li>Does <strong>density</strong> change by <strong>Season</strong>?</li>
<li>Does <strong>size</strong> (shell length, <code>SL_mm</code>) change by <strong>Season</strong>?</li>
</ul></li>
<li><strong>Community consequences of limpet presence</strong>
<ul>
<li>Does <strong>owl limpet presence</strong> (<code>COL_pres</code>) affect:
<ul>
<li><strong>Mobile invertebrate composition</strong> (counts)?</li>
<li><strong>Sessile cover composition</strong> (% cover / proportional cover)?</li>
</ul></li>
<li>Are there <strong>interactions with Season</strong>?</li>
</ul></li>
</ol>
<section id="design-assumptions-and-why-they-matter" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="design-assumptions-and-why-they-matter"><span class="header-section-number">1.1</span> Design assumptions and why they matter</h3>
<ul>
<li>The datasets include repeated sampling across <strong>Transects</strong> and/or <strong>Plots</strong>, so we:
<ul>
<li>use <strong>mixed models</strong> with <strong>random intercepts</strong> for spatial sampling units (e.g., <code>Transect</code>, or <code>Plot_Name</code>),</li>
<li>and constrain permutations by transect for multivariate tests.</li>
</ul></li>
<li><strong>Density</strong>:
<ul>
<li>The transect size was <strong>50 m²</strong> so I divided the counts by this value to get density per transect .</li>
</ul></li>
<li><strong>Community data</strong>:
<ul>
<li>Mobile inverts are <strong>counts</strong> (often overdispersed, zero-inflated).</li>
<li>Sessile “percent cover” is stored as <strong>proportions</strong> (0–1) in this dataset; we still treat it as compositional.</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="packages-and-helpers" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="packages-and-helpers"><span class="header-section-number">2</span> Packages and helpers</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Core</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)     <span class="co"># to clean the names for consistency</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed models</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)     <span class="co"># flexible GLMMs (NB, Gamma, etc.)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)        <span class="co"># LMMs (fallback)</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)     <span class="co"># estimated marginal means / contrasts</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostics</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)      <span class="co"># residual simulation diagnostics for GLMMs</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co"># assumption checks / R2 / collinearity</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co"># tidy() for mixed models</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Multivariate community ecology</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)       <span class="co"># adonis2, metaMDS, betadisper, envfit</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co">#library(pairwiseAdonis) # optional; pairwise PERMANOVA if needed</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Figures</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)      <span class="co"># raincloud/half-eye</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)   <span class="co"># figure layouts</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)      <span class="co"># label_percent etc.</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="co"># A consistent plotting theme for a paper</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span> <span class="co"># base size text is 14</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper: safe logit transform for proportions in [0,1]</span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a><span class="co"># (useful for cover variables with 0s and 1s)</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>logit01 <span class="ot">&lt;-</span> <span class="cf">function</span>(p, <span class="at">eps =</span> <span class="fl">1e-4</span>) {</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(p, eps), <span class="dv">1</span> <span class="sc">-</span> eps)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qlogis</span>(p2)</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<hr>
</section>
<section id="import-data" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="import-data"><span class="header-section-number">3</span> Import data</h2>
<blockquote class="blockquote">
<p><strong>Paths</strong> assume the files are in the same folder as this Quarto file, or are in the working directory. When you move this notebook to the scripts folder and the data files into your data folder, update paths below. Note, I edited these files to remove the transects removed in your other script and to just bring in the normalized community composition data</p>
</blockquote>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># File paths (edit if needed)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>path_size   <span class="ot">&lt;-</span> <span class="st">"limpet_size.csv"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>path_mobile <span class="ot">&lt;-</span> <span class="st">"mobile_counts.csv"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>path_sess   <span class="ot">&lt;-</span> <span class="st">"sessile_percent_cover.csv"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>limpet_size_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_size, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>season <span class="sc">%in%</span> <span class="st">"Spring"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         date <span class="sc">!=</span> <span class="st">"2023_12_10"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="fu">ifelse</span>(season <span class="sc">==</span> <span class="st">"Late_Spring"</span>, <span class="st">"Spring"</span>, season)) <span class="co"># for some reason the season is named Late spring here, but spring everywhere else (This is because when I went out in the winter, I realized that I was loosing tags so we decided to go out and have a re-tagging event in March, or Spring. I re-tagged and measured SL but I didn't do any community surveys, it wasn't part of the plan since I figured it was just about shell length. We then decided to not use the re-tagging event data. I went out again in late May and that is the data that I consider to be the Late_spring data and the only data I use when referring to "Spring". I changed the line of code to reflect that.)</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>mobile_raw      <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_mobile, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>sessile_raw     <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_sess, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(limpet_size_raw)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,364
Columns: 8
$ season    &lt;chr&gt; "Fall", "Fall", "Fall", "Fall", "Fall", "Fall", "Fall", "Fal…
$ date      &lt;chr&gt; "2023_09_29", "2023_09_29", "2023_09_29", "2023_09_29", "202…
$ plot_name &lt;chr&gt; "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1…
$ plot_side &lt;chr&gt; "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", …
$ limpet_no &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…
$ sl_mm     &lt;dbl&gt; 54, 53, 56, 66, 54, 48, 62, 62, 54, 49, 42, 49, 48, 51, 56, …
$ tag_id    &lt;chr&gt; "0", "0", "D006", "0", "0", "0", "0", "0", "0", "0", "0", "0…
$ sex       &lt;chr&gt; "female", "female", "female", "female", "female", "male", "f…</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mobile_raw)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 252
Columns: 23
$ season        &lt;chr&gt; "Fall", "Fall", "Fall", "Fall", "Fall", "Fall", "Fall", …
$ date          &lt;chr&gt; "2023_09", "2023_09", "2023_09", "2023_09", "2023_09", "…
$ transect      &lt;chr&gt; "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1", "C…
$ plot_name     &lt;chr&gt; "CNM_1_E_1", "CNM_1_C_1", "CNM_1_E_2", "CNM_1_C_2", "CNM…
$ l_r           &lt;chr&gt; "L", "R", "R", "L", "L", "R", "R", "L", "L", "R", "L", "…
$ meter_no      &lt;dbl&gt; 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 8, 8, 10, 10, 2, 2, …
$ col_pres      &lt;chr&gt; "YES", "NO", "YES", "NO", "YES", "NO", "YES", "NO", "YES…
$ t_f           &lt;lgl&gt; TRUE, FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, FALSE, TRUE…
$ tag_id        &lt;chr&gt; "D002", "0", "0", "0", "0", "0", "D003", "0", "0", "0", …
$ m_lugubris    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 0,…
$ l_hartwegii   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ l_dentiens    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ l_plena       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ l_keenae      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ l_limatula    &lt;dbl&gt; 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0,…
$ l_scabra      &lt;dbl&gt; 0, 0, 0, 0, 0, 4, 0, 5, 0, 2, 0, 1, 1, 0, 0, 0, 6, 1, 0,…
$ nuttallina_sp &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ mopalia_sp    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ p_crassipes   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ t_eiseni      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ t_funebralis  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ t_gallina     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ l_gigantea    &lt;dbl&gt; 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 6, 4, 1,…</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(sessile_raw)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 250
Columns: 18
$ season                    &lt;chr&gt; "Fall", "Fall", "Fall", "Fall", "Fall", "Fal…
$ date                      &lt;chr&gt; "2023_09", "2023_09", "2023_09", "2023_09", …
$ transect                  &lt;chr&gt; "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1",…
$ plot_name                 &lt;chr&gt; "CNM_1_E_1", "CNM_1_C_1", "CNM_1_E_2", "CNM_…
$ l_r                       &lt;chr&gt; "L", "R", "R", "L", "L", "R", "R", "L", "L",…
$ meter_no                  &lt;dbl&gt; 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 8, 8, 2,…
$ col_pres                  &lt;chr&gt; "Y", "N", "Y", "N", "Y", "N", "Y", "N", "Y",…
$ t_f                       &lt;lgl&gt; TRUE, FALSE, TRUE, FALSE, TRUE, FALSE, TRUE,…
$ tag_id                    &lt;chr&gt; "0", "0", "D002", "0", "0", "0", "D003", "0"…
$ a_elegantissima           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ phragmatopoma_californica &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ chtalmus_balanus          &lt;dbl&gt; 0.16666667, 0.07692308, 0.50000000, 0.090909…
$ bare_rock                 &lt;dbl&gt; 0.83333333, 0.92307692, 0.50000000, 0.909090…
$ ralfsia_sp                &lt;dbl&gt; 0.0000000, 0.0000000, 0.0000000, 0.0000000, …
$ coralline_crust           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ endocaldia_sp             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ p_polymerus               &lt;dbl&gt; 0.0000000, 0.0000000, 0.0000000, 0.0000000, …
$ ulva_sp                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to standardize the colors throughout the manuscript</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>season_colors <span class="ot">&lt;-</span> <span class="fu">c</span>( </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Winter =</span> <span class="st">"#1F4E79"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spring =</span> <span class="st">"#2E8B57"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fall   =</span> <span class="st">"#C65D2E"</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<hr>
</section>
<section id="data-cleaning-and-harmonization" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="data-cleaning-and-harmonization"><span class="header-section-number">4</span> Data cleaning and harmonization</h2>
<p>We standardize: - <code>season</code> as an <strong>ordered factor</strong> - <code>date</code> as a real date (best-effort parse for differences across datasets) - <code>col_pres</code> to <strong>Yes/No</strong> factor - key grouping variables (<code>transect</code>, <code>plot_name</code>, etc.)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Season order </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>season_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fall"</span>, <span class="st">"Winter"</span>,<span class="st">"Spring"</span>,<span class="st">"Summer"</span>) <span class="co"># change this order to change order of the plots</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Limpet size dataset</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>limpet_size <span class="ot">&lt;-</span> limpet_size_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dataset stores date as "YYYY_MM_DD" strings (e.g., 2023_09_29)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_side =</span> <span class="fu">as.factor</span>(plot_side),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sl_mm =</span> <span class="fu">as.numeric</span>(sl_mm)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(season), <span class="sc">!</span><span class="fu">is.na</span>(sl_mm)) <span class="co"># remove the rows with NAs in length or season</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Mobile invertebrate counts</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>mobile <span class="ot">&lt;-</span> mobile_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">transect =</span> <span class="fu">as.factor</span>(transect),</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_pres =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"y"</span>,<span class="st">"yes"</span>,<span class="st">"true"</span>,<span class="st">"t"</span>,<span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"n"</span>,<span class="st">"no"</span>,<span class="st">"false"</span>,<span class="st">"f"</span>,<span class="st">"0"</span>) <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>))</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>transect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CNM_7"</span>, <span class="st">"CNM_8"</span>))</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Sessile percent cover (in this file, cover columns appear to be proportions already: 0–1)</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>sessile <span class="ot">&lt;-</span> sessile_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">transect =</span> <span class="fu">as.factor</span>(transect),</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_pres =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"y"</span>,<span class="st">"yes"</span>,<span class="st">"true"</span>,<span class="st">"t"</span>,<span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"n"</span>,<span class="st">"no"</span>,<span class="st">"false"</span>,<span class="st">"f"</span>,<span class="st">"0"</span>) <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>))</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick checks</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>limpet_size <span class="sc">%&gt;%</span> <span class="fu">count</span>(season)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Fall","2":"1717"},{"1":"Winter","2":"1197"},{"1":"Spring","2":"1450"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mobile <span class="sc">%&gt;%</span> <span class="fu">count</span>(season, col_pres) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["fct"],"align":["left"]},{"label":["col_pres"],"name":[2],"type":["fct"],"align":["left"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"Fall","2":"No","3":"42"},{"1":"Fall","2":"Yes","3":"42"},{"1":"Winter","2":"No","3":"42"},{"1":"Winter","2":"Yes","3":"42"},{"1":"Spring","2":"No","3":"42"},{"1":"Spring","2":"Yes","3":"42"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sessile <span class="sc">%&gt;%</span> <span class="fu">count</span>(season, col_pres) <span class="do">## looks like there are missing pairs of col present</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["fct"],"align":["left"]},{"label":["col_pres"],"name":[2],"type":["fct"],"align":["left"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"Fall","2":"No","3":"41"},{"1":"Fall","2":"Yes","3":"41"},{"1":"Winter","2":"No","3":"42"},{"1":"Winter","2":"Yes","3":"42"},{"1":"Spring","2":"No","3":"42"},{"1":"Spring","2":"Yes","3":"42"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<hr>
</section>
<section id="question-1-do-limpet-density-and-size-change-by-season" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="question-1-do-limpet-density-and-size-change-by-season"><span class="header-section-number">5</span> Question 1: Do limpet density and size change by season?</h2>
<section id="a.-density-true-density-transect-area-50-m²" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="a.-density-true-density-transect-area-50-m²"><span class="header-section-number">5.1</span> 1A. Density (true density; transect area = 50 m²)</h3>
<p>You specified that each limpet-density sampling unit corresponds to a <strong>20 m² transect</strong>. We therefore compute:</p>
<ul>
<li><code>n_limpets</code> = number of limpets observed in a sampling unit</li>
<li><code>density_m2</code> = <code>n_limpets / 20</code></li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>limpet_density <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(season, date, plot_name) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_limpets =</span> <span class="fu">n</span>(),<span class="co"># count all the limpets</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># True density (per m²) using known transect area</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="dv">20</span>, <span class="do">## double check this is correct. How long was the transect and how many meters on either size of the transect did you go? </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_m2 =</span> n_limpets <span class="sc">/</span> area_m2,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_sl =</span> <span class="fu">mean</span>(sl_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># mean size per transect</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_sl =</span> <span class="fu">sd</span>(sl_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># standard deviation in size per transect</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span> <span class="co"># drop the groupings</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>limpet_density <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 18
Columns: 8
$ season     &lt;fct&gt; Fall, Fall, Fall, Fall, Fall, Fall, Winter, Winter, Winter,…
$ date       &lt;date&gt; 2023-09-29, 2023-09-30, 2023-09-30, 2023-09-30, 2023-10-01…
$ plot_name  &lt;fct&gt; CNM_1, CNM_2, CNM_3, CNM_4, CNM_5, CNM_6, CNM_1, CNM_2, CNM…
$ n_limpets  &lt;int&gt; 232, 383, 401, 429, 224, 48, 295, 348, 313, 127, 89, 25, 14…
$ area_m2    &lt;dbl&gt; 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20, 20,…
$ density_m2 &lt;dbl&gt; 11.60, 19.15, 20.05, 21.45, 11.20, 2.40, 14.75, 17.40, 15.6…
$ mean_sl    &lt;dbl&gt; 38.69397, 46.20104, 47.20200, 44.92075, 38.14286, 37.79167,…
$ sd_sl      &lt;dbl&gt; 16.66830, 15.43603, 12.72602, 14.09193, 17.89123, 13.44486,…</code></pre>
</div>
</div>
<section id="exploratory-plot-density-by-season" class="level4" data-number="5.1.1">
<h4 data-number="5.1.1" class="anchored" data-anchor-id="exploratory-plot-density-by-season"><span class="header-section-number">5.1.1</span> Exploratory plot (density by season)</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>p_density <span class="ot">&lt;-</span> limpet_density <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2, <span class="at">fill =</span> season),<span class="at">adjust =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.18</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="do">## this removes the outliers from the boxplot-- only OK because I also have the stat_halfeye and the jitter</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Owl limpet density (individuals m⁻²)"</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal variation in owl limpet density"</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))<span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>p_density</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">#My interpretation: Density is different seasonally. In the fall, density is high all around. There's more plots with 20 or more individuals per meter squared. There's only one plot that has less than 5 individuals per meter squared. That makes sense to me. There were certain plots that the high density was very visible. Plot CNM_6 had the lowest amount of limpets present every season, this was my observation. In the winter, there's a change. The number of individuals per meter squared drops. Three plots have 15+ per meter squared and 3 plots have less than 10. In the spring you can see the addition of recruits to the plots. Spawning occurs in the winter in January/February. Although I am not sure how long the larvae stage is. I can do some research. The Spring data was collected in late spring (Early June), so it gave time for juveniles to find the population and start growing into adults. Again I don't know much about that stage, I'll scower for papers. In these plots, there's a clear addition of individuals per plot consistent with spawning and the abundance of algae due to seasonal upwelling. </span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="model-negative-binomial-glmm-random-effects-for-plot" class="level4" data-number="5.1.2">
<h4 data-number="5.1.2" class="anchored" data-anchor-id="model-negative-binomial-glmm-random-effects-for-plot"><span class="header-section-number">5.1.2</span> Model: negative binomial GLMM (random effects for plot)</h4>
<p>Counts are typically overdispersed; negative binomial is usually appropriate.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>m_density <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts because negative binomial requires count data with an offset for sampled area to estimate density</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  n_limpets <span class="sc">~</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot_name), </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> limpet_density</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_density)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          n_limpets ~ season + offset(log(area_m2)) + (1 | plot_name)
Data: limpet_density

      AIC       BIC    logLik -2*log(L)  df.resid 
    225.2     229.6    -107.6     215.2        13 

Random effects:

Conditional model:
 Groups    Name        Variance Std.Dev.
 plot_name (Intercept) 0.6873   0.8291  
Number of obs: 18, groups:  plot_name, 6

Dispersion parameter for nbinom2 family (): 11.2 

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)    2.5174     0.3619   6.956  3.5e-12 ***
seasonWinter  -0.4965     0.1826  -2.719  0.00655 ** 
seasonSpring  -0.2924     0.1820  -1.606  0.10818    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_overdispersion</span>(m_density)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

 dispersion ratio = 0.281
          p-value = 0.616</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_zeroinflation</span>(m_density)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model has no observed zeros in the response variable.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<section id="diagnostics-dharma" class="level5" data-number="5.1.2.1">
<h5 data-number="5.1.2.1" class="anchored" data-anchor-id="diagnostics-dharma"><span class="header-section-number">5.1.2.1</span> Diagnostics (DHARMa)</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>sim_density <span class="ot">&lt;-</span> DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(m_density, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_density)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testDispersion</span>(sim_density)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.22715, p-value = 0.56
alternative hypothesis: two.sided</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testZeroInflation</span>(sim_density)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa zero-inflation test via comparison to expected zeros with
    simulation under H0 = fitted model

data:  simulationOutput
ratioObsSim = 0, p-value = 1
alternative hypothesis: two.sided</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="effect-sizes-estimated-marginal-means-and-contrasts" class="level5" data-number="5.1.2.2">
<h5 data-number="5.1.2.2" class="anchored" data-anchor-id="effect-sizes-estimated-marginal-means-and-contrasts"><span class="header-section-number">5.1.2.2</span> Effect sizes: estimated marginal means and contrasts</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>emm_density <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_density, <span class="sc">~</span> season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># With the area offset, 'response' is on the expected count scale; divide by area to report density</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>emm_density</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> season response   SE  df asymp.LCL asymp.UCL
 Fall        248 89.7 Inf     122.0       504
 Winter      151 54.7 Inf      74.2       307
 Spring      185 67.0 Inf      91.0       376

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_density, <span class="at">adjust =</span> <span class="st">"tukey"</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast        ratio    SE  df null z.ratio p.value
 Fall / Winter   1.643 0.300 Inf    1   2.719  0.0180
 Fall / Spring   1.340 0.244 Inf    1   1.606  0.2429
 Winter / Spring 0.815 0.147 Inf    1  -1.130  0.4958

P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
</div>
</div>
</section>
<section id="figure-showing-the-actual-model-results-model-based-means-with-uncertainty" class="level5" data-number="5.1.2.3">
<h5 data-number="5.1.2.3" class="anchored" data-anchor-id="figure-showing-the-actual-model-results-model-based-means-with-uncertainty"><span class="header-section-number">5.1.2.3</span> Figure showing the actual model results: model-based means with uncertainty</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>df_density_emm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_density) <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="dv">20</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> response <span class="sc">/</span> area_m2,</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_lower =</span> asymp.LCL <span class="sc">/</span> area_m2,</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_upper =</span> asymp.UCL <span class="sc">/</span> area_m2</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Note add in stars or letters or brackets based on significance testing from the emmeans</span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>p_density_emm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_density_emm, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> limpet_density, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2), </span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> density_lower, <span class="at">ymax =</span> density_upper), <span class="at">width =</span> <span class="fl">0.12</span>) <span class="sc">+</span></span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_signif(comparisons = list(c("Fall", "Winter", "Spring")),</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>              <span class="co">#map_signif_level = TRUE)+ I added these two lines of code and it gives me a bracket between Fall and winter but it says NS above it. does that mean non significant? Because the emmeans comparisons show that between fall and winter the difference between the means is not zero</span></span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Estimated owl limpet density (individuals m⁻²)"</span>,</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Seasonal effect on owl limpet density (model-based NB-GLMM with area offset)"</span>) <span class="sc">+</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>p_density_emm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="b.-size-sl_mm-by-season" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="b.-size-sl_mm-by-season"><span class="header-section-number">5.2</span> 1B. Size (<code>sl_mm</code>) by season</h3>
<p>Because <code>sl_mm</code> is continuous and strictly positive, we typically choose either: - <strong>Gamma GLMM</strong> or <strong>Tweedie GLMM</strong> with log link, or - <strong>LMM</strong> on log-transformed sizes.</p>
<p>Here, we start with <strong>Gamma GLMM</strong> and fallback if needed. The <strong>Gamma</strong> was not a good fit so I went to <em>Tweedie</em> which was better but still not great. Keep looking…. the bimodal sizes makes this harder What about gaussian with log link or inverse gaussian</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>p_size <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> sl_mm, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="fu">aes</span>(<span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.18</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.20</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Shell length (mm)"</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Owl limpet size distribution by season"</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))<span class="sc">+</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>p_size</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="gamma-or-tweedie-glmm-with-random-effects-for-plot" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="gamma-or-tweedie-glmm-with-random-effects-for-plot"><span class="header-section-number">5.2.1</span> Gamma or Tweedie GLMM with random effects for plot</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>m_size_tweedie <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  sl_mm <span class="sc">~</span> season <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot_name),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dispformula =</span> <span class="sc">~</span> season,  <span class="co"># Model dispersion as a function of season because unequal variances</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">tweedie</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="co"># better but still not the best, but I trust more this model</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> limpet_size</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_size_tweedie)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          sl_mm ~ season + (1 | plot_name)
Dispersion:             ~season
Data: limpet_size

      AIC       BIC    logLik -2*log(L)  df.resid 
  36359.4   36410.4  -18171.7   36343.4      4356 

Random effects:

Conditional model:
 Groups    Name        Variance Std.Dev.
 plot_name (Intercept) 0.012    0.1095  
Number of obs: 4364, groups:  plot_name, 6

Conditional model:
              Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   3.744595   0.045843   81.68  &lt; 2e-16 ***
seasonWinter  0.009423   0.013743    0.69    0.493    
seasonSpring -0.057856   0.013551   -4.27 1.96e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Dispersion model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   1.51831    0.05026  30.211   &lt;2e-16 ***
seasonWinter  0.04969    0.04681   1.062   0.2884    
seasonSpring  0.08410    0.05084   1.654   0.0981 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="diagnostics" class="level5" data-number="5.2.1.1">
<h5 data-number="5.2.1.1" class="anchored" data-anchor-id="diagnostics"><span class="header-section-number">5.2.1.1</span> Diagnostics</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>sim_size <span class="ot">&lt;-</span> DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(m_size_tweedie, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_size)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testDispersion</span>(sim_size)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 1.0236, p-value = 0.62
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
<section id="estimated-marginal-means-back-transformed-to-mm" class="level5" data-number="5.2.1.2">
<h5 data-number="5.2.1.2" class="anchored" data-anchor-id="estimated-marginal-means-back-transformed-to-mm"><span class="header-section-number">5.2.1.2</span> Estimated marginal means (back-transformed to mm)</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>emm_size <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_size_tweedie, <span class="sc">~</span> season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>emm_size</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> season response   SE  df asymp.LCL asymp.UCL
 Fall       42.3 1.94 Inf      38.7      46.3
 Winter     42.7 1.98 Inf      39.0      46.7
 Spring     39.9 1.84 Inf      36.5      43.7

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_size, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast        ratio     SE  df null z.ratio p.value
 Fall / Winter   0.991 0.0136 Inf    1  -0.686  0.7719
 Fall / Spring   1.060 0.0144 Inf    1   4.269 &lt;0.0001
 Winter / Spring 1.070 0.0156 Inf    1   4.600 &lt;0.0001

P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
</div>
</div>
</section>
<section id="figure-model-based-seasonal-means" class="level5" data-number="5.2.1.3">
<h5 data-number="5.2.1.3" class="anchored" data-anchor-id="figure-model-based-seasonal-means"><span class="header-section-number">5.2.1.3</span> Figure: model-based seasonal means</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>df_size_emm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_size)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>p_size_emm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_size_emm, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> asymp.LCL, <span class="at">ymax =</span> asymp.UCL), <span class="at">width =</span> <span class="fl">0.12</span>) <span class="sc">+</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Estimated mean shell length (mm)"</span>,</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal effect on owl limpet size (Gamma GLMM)"</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>p_size_emm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="different-kind-of-visual-to-look-at-size-structure-shifts-cdfs" class="level4" data-number="5.2.2">
<h4 data-number="5.2.2" class="anchored" data-anchor-id="different-kind-of-visual-to-look-at-size-structure-shifts-cdfs"><span class="header-section-number">5.2.2</span> Different kind of visual to look at size structure shifts (CDFs)</h4>
<p>Cumulative distributions are great for communicating shifts in size structure (e.g., truncation).</p>
<p>You would interpret this plot by saying: “For each season, what fraction of limpets are smaller than a given shell length?”</p>
<p>Example interpretations of the plot</p>
<p>Steeper ECDF at small sizes in Spring → Maybe recent recruitment or better post-settlement survival</p>
<p>Right-shifted ECDF in Fall/Summer → growth of survivors after spring recruitment?</p>
<p>These patterns often cannot be detected by mean-based models alone.</p>
<p>“We visualized seasonal shifts in owl limpet size structure using empirical cumulative distribution functions (ECDFs), which depict the proportion of individuals that are smaller than a given shell length without assuming an underlying distribution.”</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>p_cdf <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sl_mm, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Shell length (mm)"</span>, <span class="at">y =</span> <span class="st">"Empirical CDF"</span>,</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal shifts in size structure (ECDF)"</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>p_cdf</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>You would start with the mean values that you get from the emmeans output of the size model, state if there are any differences and then interpretit this model. The empirical cumulative distribution functions (ECDFs) showed seasonal differences in size structure beyond mean responses. For a given shell length, the proportion of individuals by size differed among seasons, indicating seasonal shifts in the relative abundance of small versus large individuals. In particular, Spring exhibited a higher proportion of small individuals across much of the size range, whereas Fall and Winter showed a right-shifted distribution consistent with a greater representation of larger individuals.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Bring the figures together for pub quality</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Add in stars with brackes to show significance between seasons based on emmeans</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>(p_density<span class="sc">|</span>p_size<span class="sc">|</span>p_cdf)<span class="sc">+</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"figure1.png"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
</section>
</section>
<section id="question-2-does-limpet-presence-affect-community-composition-and-does-it-interact-with-season" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="question-2-does-limpet-presence-affect-community-composition-and-does-it-interact-with-season"><span class="header-section-number">6</span> Question 2: Does limpet presence affect community composition, and does it interact with season?</h2>
<p>We analyze both: - <strong>Mobile invertebrate counts</strong> (multivariate &amp; univariate) - <strong>Sessile cover composition</strong> (multivariate &amp; univariate) – I am having a hard time with the sessile data. Seems like everything is mostly bare rock and I am not sure what the microalgae are here</p>
<p>Key fixed effects: - <code>col_pres</code> (No vs Yes) - <code>season</code> - <code>col_pres * season</code> interaction</p>
<p>Random/blocking structure: - <code>transect</code> is used for random effects and permutation strata (to respect spatial non-independence).</p>
<hr>
</section>
<section id="a.-mobile-invertebrates-counts" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="a.-mobile-invertebrates-counts"><span class="header-section-number">7</span> 2A. Mobile invertebrates (counts)</h2>
<section id="identify-species-columns" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="identify-species-columns"><span class="header-section-number">7.1</span> Identify species columns</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group by species groups first</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>mobile_grouped<span class="ot">&lt;-</span>mobile <span class="sc">%&gt;%</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Limpets =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(l_limatula, l_scabra, l_gigantea))),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Chitons =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(nuttallina_sp, mopalia_sp, l_hartwegii,l_dentiens))),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Turbans =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(t_eiseni<span class="sc">:</span>t_gallina))),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Periwinkles =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(l_plena, l_keenae))),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Whelks =</span> m_lugubris) <span class="sc">%&gt;%</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(m_lugubris<span class="sc">:</span>l_gigantea)) <span class="co"># what is -c</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="co"># metadata</span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>mobile_meta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"season"</span>,<span class="st">"date"</span>,<span class="st">"transect"</span>,<span class="st">"plot_name"</span>,<span class="st">"l_r"</span>,<span class="st">"meter_no"</span>,<span class="st">"col_pres"</span>,<span class="st">"t_f"</span>,<span class="st">"tag_id"</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>mobile_spp <span class="ot">&lt;-</span> mobile_grouped <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(mobile_meta)) <span class="co">#what is -any_of</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity checks: are these non-negative counts?</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mobile_spp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Limpets          Chitons          Turbans        Periwinkles    
 Min.   : 0.000   Min.   :0.0000   Min.   : 0.000   Min.   : 0.000  
 1st Qu.: 0.000   1st Qu.:0.0000   1st Qu.: 0.000   1st Qu.: 0.000  
 Median : 1.000   Median :0.0000   Median : 0.000   Median : 0.000  
 Mean   : 3.406   Mean   :0.2381   Mean   : 1.925   Mean   : 0.627  
 3rd Qu.: 4.000   3rd Qu.:0.0000   3rd Qu.: 1.000   3rd Qu.: 0.000  
 Max.   :50.000   Max.   :6.0000   Max.   :26.000   Max.   :31.000  
 NA's   :1                                                          
     Whelks      
 Min.   :0.0000  
 1st Qu.:0.0000  
 Median :0.0000  
 Mean   :0.3532  
 3rd Qu.:0.0000  
 Max.   :6.0000  
                 </code></pre>
</div>
</div>
</section>
<section id="transformations-for-multivariate-analyses" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="transformations-for-multivariate-analyses"><span class="header-section-number">7.2</span> Transformations for multivariate analyses</h3>
<p>For community composition, we typically: - use <strong>gower</strong> on square-root transformed counts since lots of zeros. Bray-Curtis did not work.</p>
<p>For Gower, multiplying all counts by the same constant (e.g., converting to per m² when all plots have identical area) does <strong>not</strong> change dissimilarities; we still report univariate abundance in <strong>m⁻²</strong> for interpretability. Information on coding dissimilarity indices https://rdrr.io/cran/vegan/man/vegdist.html</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>mobile_mat <span class="ot">&lt;-</span> mobile_spp <span class="sc">%&gt;%</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span> <span class="co"># make the missing values zeros</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># gower dissimilarity on sqrt counts because 0s present</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>mobile_bc <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">sqrt</span>(mobile_mat), <span class="at">method =</span> <span class="st">"gower"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="permanova-adonis2-with-permutations-constrained-by-transect" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="permanova-adonis2-with-permutations-constrained-by-transect"><span class="header-section-number">7.3</span> PERMANOVA (adonis2) with permutations constrained by transect</h3>
<p>This tests whether multivariate centroids differ by predictors.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>adon_mobile <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  mobile_bc <span class="sc">~</span> col_pres <span class="sc">*</span> season,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">permutations =</span> <span class="dv">999</span>,</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> mobile<span class="sc">$</span>transect</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>adon_mobile</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SumOfSqs"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"0.4170299","3":"0.09071473","4":"4.908432","5":"0.001","_rn_":"Model"},{"1":"246","2":"4.1801271","3":"0.90928527","4":"NA","5":"NA","_rn_":"Residual"},{"1":"251","2":"4.5971570","3":"1.00000000","4":"NA","5":"NA","_rn_":"Total"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Need to add in the pairwise differences-- follow up with this</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#What about pairwise.adonis2()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="check-dispersion-permdisp" class="level3" data-number="7.4">
<h3 data-number="7.4" class="anchored" data-anchor-id="check-dispersion-permdisp"><span class="header-section-number">7.4</span> Check dispersion (PERMDISP)</h3>
<p>PERMANOVA can be sensitive to differences in within-group dispersion.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>disp_mobile <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(mobile_bc, <span class="fu">interaction</span>(mobile<span class="sc">$</span>col_pres, mobile<span class="sc">$</span>season))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(disp_mobile)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"0.4897388","3":"0.097947761","4":"15.45567","5":"3.230241e-13","_rn_":"Groups"},{"1":"246","2":"1.5589846","3":"0.006337336","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(disp_mobile, <span class="at">permutations =</span> <span class="dv">999</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
           Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)    
Groups      5 0.48974 0.097948 15.456    999  0.001 ***
Residuals 246 1.55898 0.006337                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(disp_mobile) <span class="co"># get pairwise differences</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = distances ~ group, data = df)

$group
                              diff           lwr        upr     p adj
Yes.Fall-No.Fall       0.029689076 -0.0202082042 0.07958636 0.5271168
No.Winter-No.Fall      0.096600212  0.0467029325 0.14649749 0.0000010
Yes.Winter-No.Fall     0.064913230  0.0150159504 0.11481051 0.0031399
No.Spring-No.Fall      0.119670461  0.0697731809 0.16956774 0.0000000
Yes.Spring-No.Fall     0.114032795  0.0641355150 0.16393007 0.0000000
No.Winter-Yes.Fall     0.066911137  0.0170138569 0.11680842 0.0020551
Yes.Winter-Yes.Fall    0.035224155 -0.0146731252 0.08512143 0.3296761
No.Spring-Yes.Fall     0.089981385  0.0400841054 0.13987866 0.0000068
Yes.Spring-Yes.Fall    0.084343719  0.0344464394 0.13424100 0.0000314
Yes.Winter-No.Winter  -0.031686982 -0.0815842618 0.01821030 0.4522087
No.Spring-No.Winter    0.023070248 -0.0268270313 0.07296753 0.7692185
Yes.Spring-No.Winter   0.017432583 -0.0324646972 0.06732986 0.9164678
No.Spring-Yes.Winter   0.054757231  0.0048599508 0.10465451 0.0222230
Yes.Spring-Yes.Winter  0.049119565 -0.0007777151 0.09901684 0.0564699
Yes.Spring-No.Spring  -0.005637666 -0.0555349457 0.04425961 0.9995178</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Yes clearly very different dispersion (the size of the circle)--but driven by season based on pairwise</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
</section>
<section id="ordination-nmds-visualize-patterns" class="level3" data-number="7.5">
<h3 data-number="7.5" class="anchored" data-anchor-id="ordination-nmds-visualize-patterns"><span class="header-section-number">7.5</span> Ordination: NMDS (visualize patterns)</h3>
<p>Website with info on metaMDS https://vegandevs.github.io/vegan/reference/metaMDS.html</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>nmds_mobile <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(<span class="fu">sqrt</span>(mobile_mat), <span class="at">distance =</span> <span class="st">"gower"</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trymax =</span> <span class="dv">100</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Run 0 stress 0.1480195 
Run 1 stress 0.1692756 
Run 2 stress 0.1641642 
Run 3 stress 0.1594028 
Run 4 stress 0.1493561 
Run 5 stress 0.1480199 
... Procrustes: rmse 0.0003571177  max resid 0.004283781 
... Similar to previous best
Run 6 stress 0.1686074 
Run 7 stress 0.1521691 
Run 8 stress 0.1565819 
Run 9 stress 0.1491791 
Run 10 stress 0.1880461 
Run 11 stress 0.152402 
Run 12 stress 0.1910246 
Run 13 stress 0.155679 
Run 14 stress 0.1897739 
Run 15 stress 0.1728166 
Run 16 stress 0.1498176 
Run 17 stress 0.1502344 
Run 18 stress 0.1691873 
Run 19 stress 0.1587708 
Run 20 stress 0.1554443 
*** Best solution repeated 1 times</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>nmds_mobile<span class="sc">$</span>stress <span class="co">#get the stress</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1480195</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- NMDS biplot for MOBILE invertebrates ( species vectors) ----</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co">#did you select 42 for a specific reason?</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit species vectors to the NMDS using envfit. envfit finds vectors or vector averages</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    - "display = 'species'" returns directions for each taxa</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co">#    - we fit to sqrt(mobile_mat) if NMDS was based on sqrt counts</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>fit_spp <span class="ot">&lt;-</span> <span class="fu">envfit</span>(nmds_mobile, <span class="fu">sqrt</span>(mobile_mat), <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract site scores</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>sites_df <span class="ot">&lt;-</span> <span class="fu">scores</span>(nmds_mobile, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"site_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(mobile_grouped <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">site_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> <span class="fu">select</span>(site_id, season, col_pres, transect))</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract species vectors + p-values; keep only significant / strong ones</span></span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>vec_df <span class="ot">&lt;-</span> <span class="fu">scores</span>(fit_spp, <span class="at">display =</span> <span class="st">"vectors"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"taxon"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p-values are in fit_spp$vectors$pvals; same order as rows in scores()</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> fit_spp<span class="sc">$</span>vectors<span class="sc">$</span>pvals) <span class="sc">%&gt;%</span></span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vector strength (longer = stronger relationship with ordination)</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="fu">sqrt</span>(NMDS1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> NMDS2<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(p) <span class="do">## all the species have significant vectors</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose which taxa to label: either significant + top N by vector length</span></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>top_n <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>vec_keep <span class="ot">&lt;-</span> vec_df <span class="sc">%&gt;%</span></span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;=</span> alpha) <span class="sc">%&gt;%</span></span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> r, <span class="at">n =</span> top_n)</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale vectors to match plot extent (so arrows look nice)</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a><span class="co">#    This rescales arrows relative to NMDS axes range.</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>arrow_mult <span class="ot">&lt;-</span> <span class="fl">0.85</span> <span class="sc">*</span> <span class="fu">min</span>(</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="fu">range</span>(sites_df<span class="sc">$</span>NMDS1)) <span class="sc">/</span> <span class="fu">diff</span>(<span class="fu">range</span>(vec_keep<span class="sc">$</span>NMDS1)),</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="fu">range</span>(sites_df<span class="sc">$</span>NMDS2)) <span class="sc">/</span> <span class="fu">diff</span>(<span class="fu">range</span>(vec_keep<span class="sc">$</span>NMDS2))</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>vec_keep <span class="ot">&lt;-</span> vec_keep <span class="sc">%&gt;%</span></span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NMDS1 =</span> NMDS1 <span class="sc">*</span> arrow_mult,</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">NMDS2 =</span> NMDS2 <span class="sc">*</span> arrow_mult)</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: sites + ellipses + species vectors (biplot)</span></span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>p_biplot_mobile <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sites_df, <span class="fu">aes</span>(NMDS1, NMDS2)) <span class="sc">+</span></span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sites</span></span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> season, <span class="at">shape =</span> col_pres), <span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group ellipses</span></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(season, col_pres), <span class="at">color =</span> season),</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>               <span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Species arrows</span></span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> vec_keep,</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> NMDS1, <span class="at">yend =</span> NMDS2),</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.7</span>,</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.18</span>, <span class="st">"cm"</span>))</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Species labels</span></span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> vec_keep,</span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">label =</span> taxon),</span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span></span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors) <span class="sc">+</span></span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>    <span class="co">#title = "Mobile invertebrates NMDS biplot",</span></span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Stress = "</span>, <span class="fu">round</span>(nmds_mobile<span class="sc">$</span>stress, <span class="dv">3</span>)),</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Season"</span>,</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span></span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>p_biplot_mobile</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="univariate-summaries-total-abundance" class="level3" data-number="7.6">
<h3 data-number="7.6" class="anchored" data-anchor-id="univariate-summaries-total-abundance"><span class="header-section-number">7.6</span> Univariate summaries (total abundance)</h3>
<p>These are interpretable “whole-community” metrics.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>mobile_alpha <span class="ot">&lt;-</span> mobile_grouped <span class="sc">%&gt;%</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  mobile plot is 0.25 m² -- This is right</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="fl">0.25</span>,</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_abund =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(<span class="fu">all_of</span>(<span class="fu">colnames</span>(mobile_mat))), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_abund_m2 =</span> total_abund <span class="sc">/</span> area_m2,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>mobile_alpha <span class="sc">%&gt;%</span> <span class="fu">select</span>(season, col_pres, transect, total_abund) <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 252
Columns: 4
$ season      &lt;fct&gt; Fall, Fall, Fall, Fall, Fall, Fall, Fall, Fall, Fall, Fall…
$ col_pres    &lt;fct&gt; Yes, No, Yes, No, Yes, No, Yes, No, Yes, No, Yes, No, Yes,…
$ transect    &lt;fct&gt; CNM_1, CNM_1, CNM_1, CNM_1, CNM_1, CNM_1, CNM_1, CNM_1, CN…
$ total_abund &lt;dbl&gt; 0, 1, 0, 1, 0, 6, 0, 5, 1, 2, 1, 1, 2, 0, 0, 1, 24, 6, 1, …</code></pre>
</div>
</div>
<section id="mixed-models-for-individual-metrics" class="level4" data-number="7.6.1">
<h4 data-number="7.6.1" class="anchored" data-anchor-id="mixed-models-for-individual-metrics"><span class="header-section-number">7.6.1</span> Mixed models for Individual metrics</h4>
<ul>
<li><code>total_abund</code>: NB GLMM</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>m_mobile_total <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts with area offset to infer abundance density (per m²)</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  total_abund <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect),</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile_alpha</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mobile_total)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          
total_abund ~ col_pres * season + offset(log(area_m2)) + (1 |      transect)
Data: mobile_alpha

      AIC       BIC    logLik -2*log(L)  df.resid 
   1421.9    1450.2    -703.0    1405.9       244 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 transect (Intercept) 0.03232  0.1798  
Number of obs: 252, groups:  transect, 6

Dispersion parameter for nbinom2 family (): 0.855 

Conditional model:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                1.7670     0.2239   7.893 2.95e-15 ***
col_presYes                0.7886     0.2845   2.772 0.005578 ** 
seasonWinter               1.9102     0.2733   6.989 2.77e-12 ***
seasonSpring               1.8159     0.2755   6.591 4.37e-11 ***
col_presYes:seasonWinter  -1.2486     0.3775  -3.308 0.000941 ***
col_presYes:seasonSpring  -0.7979     0.3784  -2.108 0.034991 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the species pairs What do you mean by this?</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>emm_total <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_mobile_total, <span class="sc">~</span> col_pres<span class="sc">|</span>season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_total, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>season = Fall:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes 0.454 0.129 Inf    1  -2.772  0.0056

season = Winter:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes 1.584 0.396 Inf    1   1.841  0.0656

season = Spring:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes 1.009 0.253 Inf    1   0.037  0.9707

Tests are performed on the log scale </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(m_mobile_total)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here is your example for limpets.  Do for the rest of the species</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>m_mobile_Limpet <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts with area offset to infer abundance density (per m²)</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  Limpets <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect),</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile_alpha</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mobile_Limpet)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          
Limpets ~ col_pres * season + offset(log(area_m2)) + (1 | transect)
Data: mobile_alpha

      AIC       BIC    logLik -2*log(L)  df.resid 
   1129.4    1157.6    -556.7    1113.4       243 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 transect (Intercept) 0.0828   0.2877  
Number of obs: 251, groups:  transect, 6

Dispersion parameter for nbinom2 family (): 0.613 

Conditional model:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                1.6694     0.2683   6.223 4.87e-10 ***
col_presYes                0.4702     0.3331   1.412  0.15807    
seasonWinter               1.5806     0.3164   4.996 5.85e-07 ***
seasonSpring               0.9644     0.3261   2.957  0.00310 ** 
col_presYes:seasonWinter  -1.2140     0.4478  -2.711  0.00671 ** 
col_presYes:seasonSpring  -0.6161     0.4601  -1.339  0.18059    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>emm_limpet <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_mobile_Limpet, <span class="sc">~</span> col_pres<span class="sc">|</span>season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_limpet, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>season = Fall:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes 0.625 0.208 Inf    1  -1.412  0.1581

season = Winter:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes 2.104 0.635 Inf    1   2.463  0.0138

season = Spring:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes 1.157 0.370 Inf    1   0.457  0.6478

Tests are performed on the log scale </code></pre>
</div>
</div>
</section>
<section id="figure-total-abundance-by-col-presence-and-season" class="level4" data-number="7.6.2">
<h4 data-number="7.6.2" class="anchored" data-anchor-id="figure-total-abundance-by-col-presence-and-season"><span class="header-section-number">7.6.2</span> Figure: total abundance by COL presence and season</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># everything</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>p_alpha <span class="ot">&lt;-</span> mobile_alpha <span class="sc">%&gt;%</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Limpets<span class="sc">:</span>Whelks, total_abund_m2 </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>                        ), <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_log =</span> value<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> value_log, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log"</span>)<span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> season), <span class="at">color =</span> <span class="cn">NULL</span>)<span class="sc">+</span> <span class="co">#outlier.shape = NA, alpha = 0.5) +</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>))<span class="sc">+</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> metric, <span class="at">scales =</span> <span class="st">"free_y"</span>)<span class="sc">+</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Density (m⁻²)"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># title = "Mobile invertebrate alpha metrics vs limpet presence and season"</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a><span class="do">## total abundance only</span></span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>p_total <span class="ot">&lt;-</span> mobile_alpha <span class="sc">%&gt;%</span></span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> total_abund_m2<span class="sc">+</span><span class="dv">1</span>, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log"</span>)<span class="sc">+</span></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> season), <span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span> <span class="co">#outlier.shape = NA, alpha = 0.5) +</span></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Total density (m⁻²)"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># title = "Mobile invertebrate alpha metrics vs limpet presence and season"</span></span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a><span class="do">## add in brackets for yes/no pairs for ones that are significant based on emmeans and clean up the title of total_abunc... and double check that the area is correct since I think you did it two different ways</span></span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>p_alpha<span class="sc">+</span>p_biplot_mobile<span class="sc">+</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"figure2.png"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<hr>
</section>
</section>
</section>
<section id="sessile-community-cover-proportional-cover" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="sessile-community-cover-proportional-cover"><span class="header-section-number">8</span> Sessile community (% cover / proportional cover)</h2>
<section id="identify-sessile-cover-columns-i-dont-trust-this-analysis-rn" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="identify-sessile-cover-columns-i-dont-trust-this-analysis-rn"><span class="header-section-number">8.1</span> Identify sessile cover columns — i dont trust this analysis rn</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>sess_meta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"season"</span>,<span class="st">"date"</span>,<span class="st">"transect"</span>,<span class="st">"plot_name"</span>,<span class="st">"l_r"</span>,<span class="st">"meter_no"</span>,<span class="st">"col_pres"</span>,<span class="st">"t_f"</span>,<span class="st">"tag_id"</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>sess_spp <span class="ot">&lt;-</span> sessile <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(sess_meta))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sess_spp)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> a_elegantissima    phragmatopoma_californica chtalmus_balanus   bare_rock     
 Min.   :0.000000   Min.   :0.000000          Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.000000   1st Qu.:0.000000          1st Qu.:0.0000   1st Qu.:0.5000  
 Median :0.000000   Median :0.000000          Median :0.1875   Median :0.7500  
 Mean   :0.006008   Mean   :0.003273          Mean   :0.2876   Mean   :0.6674  
 3rd Qu.:0.000000   3rd Qu.:0.000000          3rd Qu.:0.5000   3rd Qu.:0.9091  
 Max.   :0.181818   Max.   :0.818182          Max.   :1.0000   Max.   :1.0000  
   ralfsia_sp      coralline_crust   endocaldia_sp     p_polymerus      
 Min.   :0.00000   Min.   :0.00000   Min.   :0.0000   Min.   :0.000000  
 1st Qu.:0.00000   1st Qu.:0.00000   1st Qu.:0.0000   1st Qu.:0.000000  
 Median :0.00000   Median :0.00000   Median :0.0000   Median :0.000000  
 Mean   :0.03271   Mean   :0.00025   Mean   :0.0005   Mean   :0.001227  
 3rd Qu.:0.00000   3rd Qu.:0.00000   3rd Qu.:0.0000   3rd Qu.:0.000000  
 Max.   :0.81818   Max.   :0.06250   Max.   :0.1250   Max.   :0.181818  
    ulva_sp         
 Min.   :0.0000000  
 1st Qu.:0.0000000  
 Median :0.0000000  
 Mean   :0.0007273  
 3rd Qu.:0.0000000  
 Max.   :0.1818182  </code></pre>
</div>
</div>
</section>
<section id="multivariate-test-permanova-on-gower" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="multivariate-test-permanova-on-gower"><span class="header-section-number">8.2</span> Multivariate test: PERMANOVA on gower</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>sess_mat <span class="ot">&lt;-</span> sess_spp <span class="sc">%&gt;%</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>sess_bc <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">sqrt</span>(sess_mat), <span class="at">method =</span> <span class="st">"gower"</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>adon_sess <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  sess_bc <span class="sc">~</span> col_pres <span class="sc">*</span> season,</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sessile,</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">permutations =</span> <span class="dv">999</span>,</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> sessile<span class="sc">$</span>transect</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a>adon_sess</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SumOfSqs"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"0.0296972","3":"0.01600622","4":"0.7938094","5":"0.471","_rn_":"Model"},{"1":"244","2":"1.8256567","3":"0.98399378","4":"NA","5":"NA","_rn_":"Residual"},{"1":"249","2":"1.8553539","3":"1.00000000","4":"NA","5":"NA","_rn_":"Total"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="dispersion-check" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="dispersion-check"><span class="header-section-number">8.3</span> Dispersion check</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>disp_sess <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(sess_bc, <span class="fu">interaction</span>(sessile<span class="sc">$</span>col_pres, sessile<span class="sc">$</span>season))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(disp_sess)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"0.009812048","3":"0.001962410","4":"0.5544589","5":"0.7348477","_rn_":"Groups"},{"1":"244","2":"0.863594997","3":"0.003539324","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(disp_sess, <span class="at">permutations =</span> <span class="dv">999</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
           Df  Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups      5 0.00981 0.0019624 0.5545    999  0.736
Residuals 244 0.86359 0.0035393                     </code></pre>
</div>
</div>
</section>
<section id="ordination-nmds" class="level3" data-number="8.4">
<h3 data-number="8.4" class="anchored" data-anchor-id="ordination-nmds"><span class="header-section-number">8.4</span> Ordination: NMDS</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>nmds_sess <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(sess_mat, <span class="at">distance =</span> <span class="st">"gower"</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trymax =</span> <span class="dv">100</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Run 0 stress 0.05862834 
Run 1 stress 0.06245211 
Run 2 stress 0.07386725 
Run 3 stress 0.0742436 
Run 4 stress 0.08405822 
Run 5 stress 0.05892637 
... Procrustes: rmse 0.03746138  max resid 0.461335 
Run 6 stress 0.07103843 
Run 7 stress 0.07792467 
Run 8 stress 0.077055 
Run 9 stress 0.06410562 
Run 10 stress 0.08543962 
Run 11 stress 0.05830955 
... New best solution
... Procrustes: rmse 0.03589337  max resid 0.4639827 
Run 12 stress 0.07623066 
Run 13 stress 0.06378709 
Run 14 stress 0.07374243 
Run 15 stress 0.08535586 
Run 16 stress 0.07619291 
Run 17 stress 0.06365092 
Run 18 stress 0.08268312 
Run 19 stress 0.08742689 
Run 20 stress 0.07539135 
Run 21 stress 0.07750249 
Run 22 stress 0.07883622 
Run 23 stress 0.07905419 
Run 24 stress 0.0812617 
Run 25 stress 0.08202223 
Run 26 stress 0.06546656 
Run 27 stress 0.0731233 
Run 28 stress 0.06213846 
Run 29 stress 0.07037871 
Run 30 stress 0.0855544 
Run 31 stress 0.06362198 
Run 32 stress 0.08606739 
Run 33 stress 0.07459162 
Run 34 stress 0.07069818 
Run 35 stress 0.08438234 
Run 36 stress 0.0699207 
Run 37 stress 0.07568006 
Run 38 stress 0.06774502 
Run 39 stress 0.06844069 
Run 40 stress 0.05931549 
Run 41 stress 0.06790879 
Run 42 stress 0.06939055 
Run 43 stress 0.08002224 
Run 44 stress 0.08784417 
Run 45 stress 0.08174879 
Run 46 stress 0.05806177 
... New best solution
... Procrustes: rmse 0.007646512  max resid 0.08948159 
Run 47 stress 0.068319 
Run 48 stress 0.07171781 
Run 49 stress 0.07745645 
Run 50 stress 0.07209809 
Run 51 stress 0.06334206 
Run 52 stress 0.06438393 
Run 53 stress 0.07684932 
Run 54 stress 0.07419469 
Run 55 stress 0.06605373 
Run 56 stress 0.05931553 
Run 57 stress 0.07291517 
Run 58 stress 0.07135171 
Run 59 stress 0.0850247 
Run 60 stress 0.06808327 
Run 61 stress 0.07402712 
Run 62 stress 0.06582011 
Run 63 stress 0.06942964 
Run 64 stress 0.07438355 
Run 65 stress 0.06202241 
Run 66 stress 0.08189186 
Run 67 stress 0.0642783 
Run 68 stress 0.06552749 
Run 69 stress 0.05952904 
Run 70 stress 0.06268411 
Run 71 stress 0.08163993 
Run 72 stress 0.07255202 
Run 73 stress 0.06232907 
Run 74 stress 0.06248579 
Run 75 stress 0.07931045 
Run 76 stress 0.07528347 
Run 77 stress 0.07475254 
Run 78 stress 0.06446054 
Run 79 stress 0.0698297 
Run 80 stress 0.07328289 
Run 81 stress 0.07913513 
Run 82 stress 0.06605379 
Run 83 stress 0.07421258 
Run 84 stress 0.06182793 
Run 85 stress 0.06446043 
Run 86 stress 0.08643119 
Run 87 stress 0.07999955 
Run 88 stress 0.07540636 
Run 89 stress 0.07354145 
Run 90 stress 0.06207342 
Run 91 stress 0.07278984 
Run 92 stress 0.06199389 
Run 93 stress 0.06039343 
Run 94 stress 0.07154626 
Run 95 stress 0.07448662 
Run 96 stress 0.07300186 
Run 97 stress 0.08500218 
Run 98 stress 0.07410527 
Run 99 stress 0.06878617 
Run 100 stress 0.07083381 
*** Best solution was not repeated -- monoMDS stopping criteria:
    10: no. of iterations &gt;= maxit
    76: stress ratio &gt; sratmax
    14: scale factor of the gradient &lt; sfgrmin</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>nmds_sess<span class="sc">$</span>stress</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05806177</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>scores_sess <span class="ot">&lt;-</span> <span class="fu">scores</span>(nmds_sess, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(sessile <span class="sc">%&gt;%</span> <span class="fu">select</span>(season, col_pres, transect))</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>p_nmds_sess <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scores_sess, <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(season, col_pres)), <span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sessile community: NMDS (gower on proportional cover)"</span>,</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Stress = "</span>, <span class="fu">round</span>(nmds_sess<span class="sc">$</span>stress, <span class="dv">3</span>)),</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span>, <span class="at">color =</span> <span class="st">"Season"</span>) <span class="sc">+</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>p_nmds_sess</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="univariate-analyses-for-key-functional-groups" class="level3" data-number="8.5">
<h3 data-number="8.5" class="anchored" data-anchor-id="univariate-analyses-for-key-functional-groups"><span class="header-section-number">8.5</span> Univariate analyses for key functional groups</h3>
<p>Depending on your ecological framing, response variables may include: - <strong>Bare rock</strong> (space availability) - <strong>Erect fleshy algae</strong> (here likely <code>ulva_sp</code>, <code>endocaldia_sp</code>, etc.) - <strong>Crustose coralline algae</strong> (<code>coralline_crust</code>) - <strong>Barnacles</strong> (<code>chtalmus_balanus</code>) - <strong>Tube worms</strong> (<code>phragmatopoma_californica</code>) etc.</p>
<p>Where is the microalgae?</p>
<p>Because cover is proportional (0–1), a practical approach is: - transform with <code>logit01()</code> and use LMM/GLMM with Gaussian errors, OR - Beta regression (more complex; <code>glmmTMB</code> can do it with <code>family = beta_family()</code>).</p>
<p>Here we demonstrate logit-transformed LMMs with transect random intercepts.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose a few focal cover variables to test (edit for your hypotheses)</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>focal_cover <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bare_rock"</span>, <span class="st">"ulva_sp"</span>, <span class="st">"coralline_crust"</span>, <span class="st">"chtalmus_balanus"</span>, <span class="st">"ralfsia_sp"</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>sess_long <span class="ot">&lt;-</span> sessile <span class="sc">%&gt;%</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">all_of</span>(focal_cover), <span class="at">names_to =</span> <span class="st">"taxon"</span>, <span class="at">values_to =</span> <span class="st">"cover"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cover =</span> <span class="fu">as.numeric</span>(cover),</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cover_logit =</span> <span class="fu">logit01</span>(cover)</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit one model per taxon (pre-specified list!)</span></span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a>models_cover <span class="ot">&lt;-</span> sess_long <span class="sc">%&gt;%</span></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(taxon) <span class="sc">%&gt;%</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_map</span>(<span class="sc">~</span>{</span>
<span id="cb88-15"><a href="#cb88-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lmer</span>(cover_logit <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect), <span class="at">data =</span> .x)</span>
<span id="cb88-16"><a href="#cb88-16" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb88-17"><a href="#cb88-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-18"><a href="#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(models_cover) <span class="ot">&lt;-</span> <span class="fu">unique</span>(sess_long<span class="sc">$</span>taxon)</span>
<span id="cb88-19"><a href="#cb88-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-20"><a href="#cb88-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Summaries</span></span>
<span id="cb88-21"><a href="#cb88-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(models_cover, summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$bare_rock
Linear mixed model fit by REML ['lmerMod']
Formula: cover_logit ~ col_pres * season + (1 | transect)
   Data: .x

REML criterion at convergence: 1365.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8264 -0.4175 -0.1045  0.2594  2.3935 

Random effects:
 Groups   Name        Variance Std.Dev.
 transect (Intercept)  1.396   1.182   
 Residual             13.896   3.728   
Number of obs: 250, groups:  transect, 6

Fixed effects:
                         Estimate Std. Error t value
(Intercept)               1.35544    0.75636   1.792
col_presYes              -0.64852    0.82351  -0.787
seasonWinter              0.36470    0.81868   0.445
seasonSpring             -0.09674    0.81868  -0.118
col_presYes:seasonWinter  0.64545    1.15754   0.558
col_presYes:seasonSpring  1.61833    1.15754   1.398

Correlation of Fixed Effects:
            (Intr) cl_prY ssnWnt ssnSpr cl_Y:W
col_presYes -0.545                            
seasonWintr -0.548  0.503                     
seasonSprng -0.548  0.503  0.506              
cl_prsYs:sW  0.387 -0.711 -0.707 -0.358       
cl_prsYs:sS  0.387 -0.711 -0.358 -0.707  0.506

$ulva_sp
Linear mixed model fit by REML ['lmerMod']
Formula: cover_logit ~ col_pres * season + (1 | transect)
   Data: .x

REML criterion at convergence: 1388.4

Scaled residuals: 
     Min       1Q   Median       3Q      Max 
-2.19951 -0.26082  0.08863  0.47952  2.91796 

Random effects:
 Groups   Name        Variance Std.Dev.
 transect (Intercept)  7.424   2.725   
 Residual             14.841   3.852   
Number of obs: 250, groups:  transect, 6

Fixed effects:
                         Estimate Std. Error t value
(Intercept)               -2.7109     1.2649  -2.143
col_presYes                0.2408     0.8511   0.283
seasonWinter              -0.4869     0.8461  -0.575
seasonSpring               0.2146     0.8461   0.254
col_presYes:seasonWinter  -0.1296     1.1963  -0.108
col_presYes:seasonSpring  -0.6306     1.1963  -0.527

Correlation of Fixed Effects:
            (Intr) cl_prY ssnWnt ssnSpr cl_Y:W
col_presYes -0.337                            
seasonWintr -0.339  0.503                     
seasonSprng -0.339  0.503  0.506              
cl_prsYs:sW  0.239 -0.711 -0.707 -0.358       
cl_prsYs:sS  0.239 -0.711 -0.358 -0.707  0.506

$coralline_crust
Linear mixed model fit by REML ['lmerMod']
Formula: cover_logit ~ col_pres * season + (1 | transect)
   Data: .x

REML criterion at convergence: 281.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.3765 -0.0001  0.0000  0.0000 15.4334 

Random effects:
 Groups   Name        Variance  Std.Dev.
 transect (Intercept) 1.233e-06 0.00111 
 Residual             1.691e-01 0.41127 
Number of obs: 250, groups:  transect, 6

Fixed effects:
                           Estimate Std. Error  t value
(Intercept)              -9.210e+00  6.423e-02 -143.391
col_presYes               2.329e-12  9.084e-02    0.000
seasonWinter              1.548e-01  9.029e-02    1.715
seasonSpring             -9.629e-07  9.029e-02    0.000
col_presYes:seasonWinter -1.548e-01  1.277e-01   -1.212
col_presYes:seasonSpring -2.307e-12  1.277e-01    0.000

Correlation of Fixed Effects:
            (Intr) cl_prY ssnWnt ssnSpr cl_Y:W
col_presYes -0.707                            
seasonWintr -0.711  0.503                     
seasonSprng -0.711  0.503  0.506              
cl_prsYs:sW  0.503 -0.711 -0.707 -0.358       
cl_prsYs:sS  0.503 -0.711 -0.358 -0.707  0.506

$chtalmus_balanus
Linear mixed model fit by REML ['lmerMod']
Formula: cover_logit ~ col_pres * season + (1 | transect)
   Data: .x

REML criterion at convergence: 1176

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.4219 -0.5043 -0.2642  0.0471  3.3669 

Random effects:
 Groups   Name        Variance Std.Dev.
 transect (Intercept) 0.9112   0.9546  
 Residual             6.3616   2.5222  
Number of obs: 250, groups:  transect, 6

Fixed effects:
                         Estimate Std. Error t value
(Intercept)               -8.4063     0.5543 -15.166
col_presYes                1.2122     0.5572   2.176
seasonWinter               0.3427     0.5539   0.619
seasonSpring              -0.2213     0.5539  -0.400
col_presYes:seasonWinter  -0.8846     0.7832  -1.129
col_presYes:seasonSpring  -1.4852     0.7832  -1.896

Correlation of Fixed Effects:
            (Intr) cl_prY ssnWnt ssnSpr cl_Y:W
col_presYes -0.503                            
seasonWintr -0.506  0.503                     
seasonSprng -0.506  0.503  0.506              
cl_prsYs:sW  0.358 -0.711 -0.707 -0.358       
cl_prsYs:sS  0.358 -0.711 -0.358 -0.707  0.506

$ralfsia_sp
Linear mixed model fit by REML ['lmerMod']
Formula: cover_logit ~ col_pres * season + (1 | transect)
   Data: .x

REML criterion at convergence: 364

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.3857  0.0000  0.0000  0.0000 15.4288 

Random effects:
 Groups   Name        Variance  Std.Dev. 
 transect (Intercept) 1.734e-17 4.164e-09
 Residual             2.374e-01 4.873e-01
Number of obs: 250, groups:  transect, 6

Fixed effects:
                           Estimate Std. Error  t value
(Intercept)              -9.210e+00  7.610e-02 -121.027
col_presYes               1.880e-01  1.076e-01    1.746
seasonWinter             -1.514e-13  1.070e-01    0.000
seasonSpring             -1.514e-13  1.070e-01    0.000
col_presYes:seasonWinter -1.880e-01  1.513e-01   -1.242
col_presYes:seasonSpring -1.880e-01  1.513e-01   -1.242

Correlation of Fixed Effects:
            (Intr) cl_prY ssnWnt ssnSpr cl_Y:W
col_presYes -0.707                            
seasonWintr -0.711  0.503                     
seasonSprng -0.711  0.503  0.506              
cl_prsYs:sW  0.503 -0.711 -0.707 -0.358       
cl_prsYs:sS  0.503 -0.711 -0.358 -0.707  0.506
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
<section id="figure-focal-cover-responses" class="level4" data-number="8.5.1">
<h4 data-number="8.5.1" class="anchored" data-anchor-id="figure-focal-cover-responses"><span class="header-section-number">8.5.1</span> Figure: focal cover responses</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>p_cover <span class="ot">&lt;-</span> sess_long <span class="sc">%&gt;%</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> cover, <span class="at">fill =</span> col_pres)) <span class="sc">+</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_point(position = position_dodge(width = 0.7))+</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>              <span class="co"># outlier.shape = NA, </span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> taxon, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Proportional cover"</span>, <span class="at">fill =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Sessile functional/taxon cover vs limpet presence and season"</span>) <span class="sc">+</span></span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>p_cover</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="ecological-interpretation-how-to-read-results-fill-in-below-with-your-references" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="ecological-interpretation-how-to-read-results-fill-in-below-with-your-references"><span class="header-section-number">9</span> Ecological interpretation (how to read results – fill in below with your references)</h2>
<section id="seasonal-density-and-size-patterns-whats-plausible" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="seasonal-density-and-size-patterns-whats-plausible"><span class="header-section-number">9.1</span> 1) Seasonal density and size patterns (what’s plausible)</h3>
<p>Depending on your results, common mechanisms include:</p>
<ul>
<li><strong>Recruitment pulses</strong> (seasonal larval supply) can increase density of <strong>small</strong> limpets after settlement. – What else do you think?</li>
</ul>
<p>For owl limpets specifically: - <em>Lottia gigantea</em> is well known for <strong>territorial grazing</strong> that can maintain “gardens” of microalgae and influence space availability and algal cover (citations).<br>
- What else?</p>
</section>
<section id="limpet-presence-effects-on-community-composition-expected-directions" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="limpet-presence-effects-on-community-composition-expected-directions"><span class="header-section-number">9.2</span> 2) Limpet presence effects on community composition (expected directions)</h3>
<ul>
<li>fill in</li>
</ul>
<p><strong>Season interactions</strong> are common because: - why?</p>
<hr>
</section>
<section id="potenitial-storyline" class="level3" data-number="9.3">
<h3 data-number="9.3" class="anchored" data-anchor-id="potenitial-storyline"><span class="header-section-number">9.3</span> potenitial storyline</h3>
<p><strong>“Seasonal dynamics modulate the engineering role of a territorial grazer.”</strong></p>
</section>
<section id="journals-to-think-about" class="level3" data-number="9.4">
<h3 data-number="9.4" class="anchored" data-anchor-id="journals-to-think-about"><span class="header-section-number">9.4</span> Journals to think about</h3>
<ul>
<li><em>Marine Ecology Progress Series</em> (MEPS)</li>
<li><em>Journal of Experimental Marine Biology and Ecology</em></li>
<li><em>PeerJ</em></li>
</ul>
<hr>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb91" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Cabrillo National Monument: Owl limpet seasonality and community effects"</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "A mix of univariate of multivariate statistics to test seasonality in both limpet size/density and community responses"</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Nyssa/Cindy"</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.Date(), '%Y-%m-%d')`"</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: false</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>This Quarto notebook analyzes three datasets from **Cabrillo National Monument (San Diego, CA)** to answer:</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Seasonality in owl limpets (*Lottia gigantea*)**</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Does **density** change by **Season**?</span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Does **size** (shell length, `SL_mm`) change by **Season**?</span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Community consequences of limpet presence**</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Does **owl limpet presence** (<span class="in">`COL_pres`</span>) affect:</span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>**Mobile invertebrate composition** (counts)?</span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>**Sessile cover composition** (% cover / proportional cover)?</span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Are there **interactions with Season**?</span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a><span class="fu">### Design assumptions and why they matter </span></span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The datasets include repeated sampling across **Transects** and/or **Plots**, so we:</span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>use **mixed models** with **random intercepts** for spatial sampling units (e.g., <span class="in">`Transect`</span>, or <span class="in">`Plot_Name`</span>),</span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>and constrain permutations by transect for multivariate tests.</span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Density**:</span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>The transect size was **50 m²** so I divided the counts by this value to get density per transect .</span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Community data**:</span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Mobile inverts are **counts** (often overdispersed, zero-inflated).</span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Sessile “percent cover” is stored as **proportions** (0–1) in this dataset; we still treat it as compositional.</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages and helpers</span></span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-55"><a href="#cb91-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-56"><a href="#cb91-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Core</span></span>
<span id="cb91-57"><a href="#cb91-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb91-58"><a href="#cb91-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span>
<span id="cb91-59"><a href="#cb91-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)     <span class="co"># to clean the names for consistency</span></span>
<span id="cb91-60"><a href="#cb91-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-61"><a href="#cb91-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed models</span></span>
<span id="cb91-62"><a href="#cb91-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)     <span class="co"># flexible GLMMs (NB, Gamma, etc.)</span></span>
<span id="cb91-63"><a href="#cb91-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)        <span class="co"># LMMs (fallback)</span></span>
<span id="cb91-64"><a href="#cb91-64" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)     <span class="co"># estimated marginal means / contrasts</span></span>
<span id="cb91-65"><a href="#cb91-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-66"><a href="#cb91-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostics</span></span>
<span id="cb91-67"><a href="#cb91-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)      <span class="co"># residual simulation diagnostics for GLMMs</span></span>
<span id="cb91-68"><a href="#cb91-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co"># assumption checks / R2 / collinearity</span></span>
<span id="cb91-69"><a href="#cb91-69" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co"># tidy() for mixed models</span></span>
<span id="cb91-70"><a href="#cb91-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-71"><a href="#cb91-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Multivariate community ecology</span></span>
<span id="cb91-72"><a href="#cb91-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)       <span class="co"># adonis2, metaMDS, betadisper, envfit</span></span>
<span id="cb91-73"><a href="#cb91-73" aria-hidden="true" tabindex="-1"></a><span class="co">#library(pairwiseAdonis) # optional; pairwise PERMANOVA if needed</span></span>
<span id="cb91-74"><a href="#cb91-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-75"><a href="#cb91-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Figures</span></span>
<span id="cb91-76"><a href="#cb91-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)      <span class="co"># raincloud/half-eye</span></span>
<span id="cb91-77"><a href="#cb91-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)   <span class="co"># figure layouts</span></span>
<span id="cb91-78"><a href="#cb91-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)      <span class="co"># label_percent etc.</span></span>
<span id="cb91-79"><a href="#cb91-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb91-80"><a href="#cb91-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb91-81"><a href="#cb91-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-82"><a href="#cb91-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-83"><a href="#cb91-83" aria-hidden="true" tabindex="-1"></a><span class="co"># A consistent plotting theme for a paper</span></span>
<span id="cb91-84"><a href="#cb91-84" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb91-85"><a href="#cb91-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span> <span class="co"># base size text is 14</span></span>
<span id="cb91-86"><a href="#cb91-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb91-87"><a href="#cb91-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb91-88"><a href="#cb91-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb91-89"><a href="#cb91-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb91-90"><a href="#cb91-90" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb91-91"><a href="#cb91-91" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-92"><a href="#cb91-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-93"><a href="#cb91-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper: safe logit transform for proportions in [0,1]</span></span>
<span id="cb91-94"><a href="#cb91-94" aria-hidden="true" tabindex="-1"></a><span class="co"># (useful for cover variables with 0s and 1s)</span></span>
<span id="cb91-95"><a href="#cb91-95" aria-hidden="true" tabindex="-1"></a>logit01 <span class="ot">&lt;-</span> <span class="cf">function</span>(p, <span class="at">eps =</span> <span class="fl">1e-4</span>) {</span>
<span id="cb91-96"><a href="#cb91-96" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(p, eps), <span class="dv">1</span> <span class="sc">-</span> eps)</span>
<span id="cb91-97"><a href="#cb91-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qlogis</span>(p2)</span>
<span id="cb91-98"><a href="#cb91-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-99"><a href="#cb91-99" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-100"><a href="#cb91-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-101"><a href="#cb91-101" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-102"><a href="#cb91-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-103"><a href="#cb91-103" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import data</span></span>
<span id="cb91-104"><a href="#cb91-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-105"><a href="#cb91-105" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Paths** assume the files are in the same folder as this Quarto file, or are in the working directory.</span></span>
<span id="cb91-106"><a href="#cb91-106" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; When you move this notebook to the scripts folder and the data files into your data folder, update paths below. </span></span>
<span id="cb91-107"><a href="#cb91-107" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Note, I edited these files to remove the transects removed in your other script and to just bring in the normalized community composition data</span></span>
<span id="cb91-108"><a href="#cb91-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-111"><a href="#cb91-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-112"><a href="#cb91-112" aria-hidden="true" tabindex="-1"></a><span class="co"># File paths (edit if needed)</span></span>
<span id="cb91-113"><a href="#cb91-113" aria-hidden="true" tabindex="-1"></a>path_size   <span class="ot">&lt;-</span> <span class="st">"limpet_size.csv"</span></span>
<span id="cb91-114"><a href="#cb91-114" aria-hidden="true" tabindex="-1"></a>path_mobile <span class="ot">&lt;-</span> <span class="st">"mobile_counts.csv"</span></span>
<span id="cb91-115"><a href="#cb91-115" aria-hidden="true" tabindex="-1"></a>path_sess   <span class="ot">&lt;-</span> <span class="st">"sessile_percent_cover.csv"</span></span>
<span id="cb91-116"><a href="#cb91-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-117"><a href="#cb91-117" aria-hidden="true" tabindex="-1"></a>limpet_size_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_size, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb91-118"><a href="#cb91-118" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>season <span class="sc">%in%</span> <span class="st">"Spring"</span>,</span>
<span id="cb91-119"><a href="#cb91-119" aria-hidden="true" tabindex="-1"></a>         date <span class="sc">!=</span> <span class="st">"2023_12_10"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb91-120"><a href="#cb91-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="fu">ifelse</span>(season <span class="sc">==</span> <span class="st">"Late_Spring"</span>, <span class="st">"Spring"</span>, season)) <span class="co"># for some reason the season is named Late spring here, but spring everywhere else (This is because when I went out in the winter, I realized that I was loosing tags so we decided to go out and have a re-tagging event in March, or Spring. I re-tagged and measured SL but I didn't do any community surveys, it wasn't part of the plan since I figured it was just about shell length. We then decided to not use the re-tagging event data. I went out again in late May and that is the data that I consider to be the Late_spring data and the only data I use when referring to "Spring". I changed the line of code to reflect that.)</span></span>
<span id="cb91-121"><a href="#cb91-121" aria-hidden="true" tabindex="-1"></a>mobile_raw      <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_mobile, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb91-122"><a href="#cb91-122" aria-hidden="true" tabindex="-1"></a>sessile_raw     <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_sess, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb91-123"><a href="#cb91-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-124"><a href="#cb91-124" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(limpet_size_raw)</span>
<span id="cb91-125"><a href="#cb91-125" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mobile_raw)</span>
<span id="cb91-126"><a href="#cb91-126" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(sessile_raw)</span>
<span id="cb91-127"><a href="#cb91-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-128"><a href="#cb91-128" aria-hidden="true" tabindex="-1"></a><span class="co"># to standardize the colors throughout the manuscript</span></span>
<span id="cb91-129"><a href="#cb91-129" aria-hidden="true" tabindex="-1"></a>season_colors <span class="ot">&lt;-</span> <span class="fu">c</span>( </span>
<span id="cb91-130"><a href="#cb91-130" aria-hidden="true" tabindex="-1"></a>  <span class="at">Winter =</span> <span class="st">"#1F4E79"</span>,</span>
<span id="cb91-131"><a href="#cb91-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spring =</span> <span class="st">"#2E8B57"</span>,</span>
<span id="cb91-132"><a href="#cb91-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fall   =</span> <span class="st">"#C65D2E"</span></span>
<span id="cb91-133"><a href="#cb91-133" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-134"><a href="#cb91-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-135"><a href="#cb91-135" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-136"><a href="#cb91-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-137"><a href="#cb91-137" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-138"><a href="#cb91-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-139"><a href="#cb91-139" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data cleaning and harmonization</span></span>
<span id="cb91-140"><a href="#cb91-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-141"><a href="#cb91-141" aria-hidden="true" tabindex="-1"></a>We standardize:</span>
<span id="cb91-142"><a href="#cb91-142" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`season`</span> as an **ordered factor**</span>
<span id="cb91-143"><a href="#cb91-143" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`date`</span> as a real date (best-effort parse for differences across datasets)</span>
<span id="cb91-144"><a href="#cb91-144" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`col_pres`</span> to **Yes/No** factor</span>
<span id="cb91-145"><a href="#cb91-145" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>key grouping variables (<span class="in">`transect`</span>, <span class="in">`plot_name`</span>, etc.)</span>
<span id="cb91-146"><a href="#cb91-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-149"><a href="#cb91-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-150"><a href="#cb91-150" aria-hidden="true" tabindex="-1"></a><span class="co"># Season order </span></span>
<span id="cb91-151"><a href="#cb91-151" aria-hidden="true" tabindex="-1"></a>season_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Fall"</span>, <span class="st">"Winter"</span>,<span class="st">"Spring"</span>,<span class="st">"Summer"</span>) <span class="co"># change this order to change order of the plots</span></span>
<span id="cb91-152"><a href="#cb91-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-153"><a href="#cb91-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Limpet size dataset</span></span>
<span id="cb91-154"><a href="#cb91-154" aria-hidden="true" tabindex="-1"></a>limpet_size <span class="ot">&lt;-</span> limpet_size_raw <span class="sc">%&gt;%</span></span>
<span id="cb91-155"><a href="#cb91-155" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb91-156"><a href="#cb91-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb91-157"><a href="#cb91-157" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dataset stores date as "YYYY_MM_DD" strings (e.g., 2023_09_29)</span></span>
<span id="cb91-158"><a href="#cb91-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb91-159"><a href="#cb91-159" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb91-160"><a href="#cb91-160" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_side =</span> <span class="fu">as.factor</span>(plot_side),</span>
<span id="cb91-161"><a href="#cb91-161" aria-hidden="true" tabindex="-1"></a>    <span class="at">sl_mm =</span> <span class="fu">as.numeric</span>(sl_mm)</span>
<span id="cb91-162"><a href="#cb91-162" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb91-163"><a href="#cb91-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(season), <span class="sc">!</span><span class="fu">is.na</span>(sl_mm)) <span class="co"># remove the rows with NAs in length or season</span></span>
<span id="cb91-164"><a href="#cb91-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-165"><a href="#cb91-165" aria-hidden="true" tabindex="-1"></a><span class="co"># Mobile invertebrate counts</span></span>
<span id="cb91-166"><a href="#cb91-166" aria-hidden="true" tabindex="-1"></a>mobile <span class="ot">&lt;-</span> mobile_raw <span class="sc">%&gt;%</span></span>
<span id="cb91-167"><a href="#cb91-167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb91-168"><a href="#cb91-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb91-169"><a href="#cb91-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb91-170"><a href="#cb91-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">transect =</span> <span class="fu">as.factor</span>(transect),</span>
<span id="cb91-171"><a href="#cb91-171" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb91-172"><a href="#cb91-172" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_pres =</span> <span class="fu">case_when</span>(</span>
<span id="cb91-173"><a href="#cb91-173" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"y"</span>,<span class="st">"yes"</span>,<span class="st">"true"</span>,<span class="st">"t"</span>,<span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb91-174"><a href="#cb91-174" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"n"</span>,<span class="st">"no"</span>,<span class="st">"false"</span>,<span class="st">"f"</span>,<span class="st">"0"</span>) <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb91-175"><a href="#cb91-175" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb91-176"><a href="#cb91-176" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>))</span>
<span id="cb91-177"><a href="#cb91-177" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb91-178"><a href="#cb91-178" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>transect <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"CNM_7"</span>, <span class="st">"CNM_8"</span>))</span>
<span id="cb91-179"><a href="#cb91-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-180"><a href="#cb91-180" aria-hidden="true" tabindex="-1"></a><span class="co"># Sessile percent cover (in this file, cover columns appear to be proportions already: 0–1)</span></span>
<span id="cb91-181"><a href="#cb91-181" aria-hidden="true" tabindex="-1"></a>sessile <span class="ot">&lt;-</span> sessile_raw <span class="sc">%&gt;%</span></span>
<span id="cb91-182"><a href="#cb91-182" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb91-183"><a href="#cb91-183" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb91-184"><a href="#cb91-184" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb91-185"><a href="#cb91-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">transect =</span> <span class="fu">as.factor</span>(transect),</span>
<span id="cb91-186"><a href="#cb91-186" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb91-187"><a href="#cb91-187" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_pres =</span> <span class="fu">case_when</span>(</span>
<span id="cb91-188"><a href="#cb91-188" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"y"</span>,<span class="st">"yes"</span>,<span class="st">"true"</span>,<span class="st">"t"</span>,<span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb91-189"><a href="#cb91-189" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"n"</span>,<span class="st">"no"</span>,<span class="st">"false"</span>,<span class="st">"f"</span>,<span class="st">"0"</span>) <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb91-190"><a href="#cb91-190" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb91-191"><a href="#cb91-191" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>))</span>
<span id="cb91-192"><a href="#cb91-192" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-193"><a href="#cb91-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-194"><a href="#cb91-194" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick checks</span></span>
<span id="cb91-195"><a href="#cb91-195" aria-hidden="true" tabindex="-1"></a>limpet_size <span class="sc">%&gt;%</span> <span class="fu">count</span>(season)</span>
<span id="cb91-196"><a href="#cb91-196" aria-hidden="true" tabindex="-1"></a>mobile <span class="sc">%&gt;%</span> <span class="fu">count</span>(season, col_pres) </span>
<span id="cb91-197"><a href="#cb91-197" aria-hidden="true" tabindex="-1"></a>sessile <span class="sc">%&gt;%</span> <span class="fu">count</span>(season, col_pres) <span class="do">## looks like there are missing pairs of col present</span></span>
<span id="cb91-198"><a href="#cb91-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-199"><a href="#cb91-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-200"><a href="#cb91-200" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-201"><a href="#cb91-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-202"><a href="#cb91-202" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 1: Do limpet density and size change by season?</span></span>
<span id="cb91-203"><a href="#cb91-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-204"><a href="#cb91-204" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1A. Density (true density; transect area = 50 m²)</span></span>
<span id="cb91-205"><a href="#cb91-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-206"><a href="#cb91-206" aria-hidden="true" tabindex="-1"></a>You specified that each limpet-density sampling unit corresponds to a **20 m² transect**.</span>
<span id="cb91-207"><a href="#cb91-207" aria-hidden="true" tabindex="-1"></a>We therefore compute:</span>
<span id="cb91-208"><a href="#cb91-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-209"><a href="#cb91-209" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`n_limpets`</span> = number of limpets observed in a sampling unit</span>
<span id="cb91-210"><a href="#cb91-210" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`density_m2`</span> = <span class="in">`n_limpets / 20`</span></span>
<span id="cb91-211"><a href="#cb91-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-214"><a href="#cb91-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-215"><a href="#cb91-215" aria-hidden="true" tabindex="-1"></a>limpet_density <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb91-216"><a href="#cb91-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(season, date, plot_name) <span class="sc">%&gt;%</span></span>
<span id="cb91-217"><a href="#cb91-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb91-218"><a href="#cb91-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_limpets =</span> <span class="fu">n</span>(),<span class="co"># count all the limpets</span></span>
<span id="cb91-219"><a href="#cb91-219" aria-hidden="true" tabindex="-1"></a>    <span class="co"># True density (per m²) using known transect area</span></span>
<span id="cb91-220"><a href="#cb91-220" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="dv">20</span>, <span class="do">## double check this is correct. How long was the transect and how many meters on either size of the transect did you go? </span></span>
<span id="cb91-221"><a href="#cb91-221" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_m2 =</span> n_limpets <span class="sc">/</span> area_m2,</span>
<span id="cb91-222"><a href="#cb91-222" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_sl =</span> <span class="fu">mean</span>(sl_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># mean size per transect</span></span>
<span id="cb91-223"><a href="#cb91-223" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_sl =</span> <span class="fu">sd</span>(sl_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># standard deviation in size per transect</span></span>
<span id="cb91-224"><a href="#cb91-224" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span> <span class="co"># drop the groupings</span></span>
<span id="cb91-225"><a href="#cb91-225" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-226"><a href="#cb91-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-227"><a href="#cb91-227" aria-hidden="true" tabindex="-1"></a>limpet_density <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span>
<span id="cb91-228"><a href="#cb91-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-229"><a href="#cb91-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-230"><a href="#cb91-230" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exploratory plot (density by season)</span></span>
<span id="cb91-231"><a href="#cb91-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-234"><a href="#cb91-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-235"><a href="#cb91-235" aria-hidden="true" tabindex="-1"></a>p_density <span class="ot">&lt;-</span> limpet_density <span class="sc">%&gt;%</span></span>
<span id="cb91-236"><a href="#cb91-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb91-237"><a href="#cb91-237" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2, <span class="at">fill =</span> season),<span class="at">adjust =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb91-238"><a href="#cb91-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.18</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="do">## this removes the outliers from the boxplot-- only OK because I also have the stat_halfeye and the jitter</span></span>
<span id="cb91-239"><a href="#cb91-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb91-240"><a href="#cb91-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Owl limpet density (individuals m⁻²)"</span></span>
<span id="cb91-241"><a href="#cb91-241" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal variation in owl limpet density"</span></span>
<span id="cb91-242"><a href="#cb91-242" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb91-243"><a href="#cb91-243" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb91-244"><a href="#cb91-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb91-245"><a href="#cb91-245" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))<span class="sc">+</span></span>
<span id="cb91-246"><a href="#cb91-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb91-247"><a href="#cb91-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-248"><a href="#cb91-248" aria-hidden="true" tabindex="-1"></a>p_density</span>
<span id="cb91-249"><a href="#cb91-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-250"><a href="#cb91-250" aria-hidden="true" tabindex="-1"></a><span class="co">#My interpretation: Density is different seasonally. In the fall, density is high all around. There's more plots with 20 or more individuals per meter squared. There's only one plot that has less than 5 individuals per meter squared. That makes sense to me. There were certain plots that the high density was very visible. Plot CNM_6 had the lowest amount of limpets present every season, this was my observation. In the winter, there's a change. The number of individuals per meter squared drops. Three plots have 15+ per meter squared and 3 plots have less than 10. In the spring you can see the addition of recruits to the plots. Spawning occurs in the winter in January/February. Although I am not sure how long the larvae stage is. I can do some research. The Spring data was collected in late spring (Early June), so it gave time for juveniles to find the population and start growing into adults. Again I don't know much about that stage, I'll scower for papers. In these plots, there's a clear addition of individuals per plot consistent with spawning and the abundance of algae due to seasonal upwelling. </span></span>
<span id="cb91-251"><a href="#cb91-251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-252"><a href="#cb91-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-253"><a href="#cb91-253" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model: negative binomial GLMM (random effects for plot)</span></span>
<span id="cb91-254"><a href="#cb91-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-255"><a href="#cb91-255" aria-hidden="true" tabindex="-1"></a>Counts are typically overdispersed; negative binomial is usually appropriate.</span>
<span id="cb91-256"><a href="#cb91-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-259"><a href="#cb91-259" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-260"><a href="#cb91-260" aria-hidden="true" tabindex="-1"></a>m_density <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb91-261"><a href="#cb91-261" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts because negative binomial requires count data with an offset for sampled area to estimate density</span></span>
<span id="cb91-262"><a href="#cb91-262" aria-hidden="true" tabindex="-1"></a>  n_limpets <span class="sc">~</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot_name), </span>
<span id="cb91-263"><a href="#cb91-263" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb91-264"><a href="#cb91-264" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> limpet_density</span>
<span id="cb91-265"><a href="#cb91-265" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-266"><a href="#cb91-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-267"><a href="#cb91-267" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_density)</span>
<span id="cb91-268"><a href="#cb91-268" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_overdispersion</span>(m_density)</span>
<span id="cb91-269"><a href="#cb91-269" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_zeroinflation</span>(m_density)</span>
<span id="cb91-270"><a href="#cb91-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-271"><a href="#cb91-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-272"><a href="#cb91-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-273"><a href="#cb91-273" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics (DHARMa)</span></span>
<span id="cb91-274"><a href="#cb91-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-277"><a href="#cb91-277" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-278"><a href="#cb91-278" aria-hidden="true" tabindex="-1"></a>sim_density <span class="ot">&lt;-</span> DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(m_density, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb91-279"><a href="#cb91-279" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_density)</span>
<span id="cb91-280"><a href="#cb91-280" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testDispersion</span>(sim_density)</span>
<span id="cb91-281"><a href="#cb91-281" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testZeroInflation</span>(sim_density)</span>
<span id="cb91-282"><a href="#cb91-282" aria-hidden="true" tabindex="-1"></a><span class="co">#https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html</span></span>
<span id="cb91-283"><a href="#cb91-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-284"><a href="#cb91-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-285"><a href="#cb91-285" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Effect sizes: estimated marginal means and contrasts</span></span>
<span id="cb91-286"><a href="#cb91-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-289"><a href="#cb91-289" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-290"><a href="#cb91-290" aria-hidden="true" tabindex="-1"></a>emm_density <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_density, <span class="sc">~</span> season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb91-291"><a href="#cb91-291" aria-hidden="true" tabindex="-1"></a><span class="co"># With the area offset, 'response' is on the expected count scale; divide by area to report density</span></span>
<span id="cb91-292"><a href="#cb91-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-293"><a href="#cb91-293" aria-hidden="true" tabindex="-1"></a>emm_density</span>
<span id="cb91-294"><a href="#cb91-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-295"><a href="#cb91-295" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_density, <span class="at">adjust =</span> <span class="st">"tukey"</span>) </span>
<span id="cb91-296"><a href="#cb91-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-297"><a href="#cb91-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-298"><a href="#cb91-298" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Figure showing the actual model results: model-based means with uncertainty</span></span>
<span id="cb91-299"><a href="#cb91-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-302"><a href="#cb91-302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-303"><a href="#cb91-303" aria-hidden="true" tabindex="-1"></a>df_density_emm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_density) <span class="sc">%&gt;%</span></span>
<span id="cb91-304"><a href="#cb91-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb91-305"><a href="#cb91-305" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="dv">20</span>,</span>
<span id="cb91-306"><a href="#cb91-306" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> response <span class="sc">/</span> area_m2,</span>
<span id="cb91-307"><a href="#cb91-307" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_lower =</span> asymp.LCL <span class="sc">/</span> area_m2,</span>
<span id="cb91-308"><a href="#cb91-308" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_upper =</span> asymp.UCL <span class="sc">/</span> area_m2</span>
<span id="cb91-309"><a href="#cb91-309" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-310"><a href="#cb91-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-311"><a href="#cb91-311" aria-hidden="true" tabindex="-1"></a><span class="co"># Note add in stars or letters or brackets based on significance testing from the emmeans</span></span>
<span id="cb91-312"><a href="#cb91-312" aria-hidden="true" tabindex="-1"></a>p_density_emm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_density_emm, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb91-313"><a href="#cb91-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> limpet_density, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2), </span>
<span id="cb91-314"><a href="#cb91-314" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb91-315"><a href="#cb91-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb91-316"><a href="#cb91-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> density_lower, <span class="at">ymax =</span> density_upper), <span class="at">width =</span> <span class="fl">0.12</span>) <span class="sc">+</span></span>
<span id="cb91-317"><a href="#cb91-317" aria-hidden="true" tabindex="-1"></a> <span class="co"># geom_signif(comparisons = list(c("Fall", "Winter", "Spring")),</span></span>
<span id="cb91-318"><a href="#cb91-318" aria-hidden="true" tabindex="-1"></a>              <span class="co">#map_signif_level = TRUE)+ I added these two lines of code and it gives me a bracket between Fall and winter but it says NS above it. does that mean non significant? Because the emmeans comparisons show that between fall and winter the difference between the means is not zero</span></span>
<span id="cb91-319"><a href="#cb91-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Estimated owl limpet density (individuals m⁻²)"</span>,</span>
<span id="cb91-320"><a href="#cb91-320" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Seasonal effect on owl limpet density (model-based NB-GLMM with area offset)"</span>) <span class="sc">+</span></span>
<span id="cb91-321"><a href="#cb91-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))</span>
<span id="cb91-322"><a href="#cb91-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-323"><a href="#cb91-323" aria-hidden="true" tabindex="-1"></a>p_density_emm</span>
<span id="cb91-324"><a href="#cb91-324" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-325"><a href="#cb91-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-326"><a href="#cb91-326" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-327"><a href="#cb91-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-328"><a href="#cb91-328" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1B. Size (`sl_mm`) by season</span></span>
<span id="cb91-329"><a href="#cb91-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-330"><a href="#cb91-330" aria-hidden="true" tabindex="-1"></a>Because <span class="in">`sl_mm`</span> is continuous and strictly positive, we typically choose either:</span>
<span id="cb91-331"><a href="#cb91-331" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Gamma GLMM** or **Tweedie GLMM** with log link, or</span>
<span id="cb91-332"><a href="#cb91-332" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**LMM** on log-transformed sizes.</span>
<span id="cb91-333"><a href="#cb91-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-334"><a href="#cb91-334" aria-hidden="true" tabindex="-1"></a>Here, we start with **Gamma GLMM** and fallback if needed.</span>
<span id="cb91-335"><a href="#cb91-335" aria-hidden="true" tabindex="-1"></a>The **Gamma** was not a good fit so I went to *Tweedie* which was better but still not great. Keep looking.... the bimodal sizes makes this harder</span>
<span id="cb91-336"><a href="#cb91-336" aria-hidden="true" tabindex="-1"></a>What about gaussian with log link or inverse gaussian</span>
<span id="cb91-337"><a href="#cb91-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-340"><a href="#cb91-340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-341"><a href="#cb91-341" aria-hidden="true" tabindex="-1"></a>p_size <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb91-342"><a href="#cb91-342" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> sl_mm, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb91-343"><a href="#cb91-343" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="fu">aes</span>(<span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb91-344"><a href="#cb91-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.18</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb91-345"><a href="#cb91-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.20</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb91-346"><a href="#cb91-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Shell length (mm)"</span></span>
<span id="cb91-347"><a href="#cb91-347" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Owl limpet size distribution by season"</span></span>
<span id="cb91-348"><a href="#cb91-348" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb91-349"><a href="#cb91-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))<span class="sc">+</span></span>
<span id="cb91-350"><a href="#cb91-350" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb91-351"><a href="#cb91-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb91-352"><a href="#cb91-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb91-353"><a href="#cb91-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-354"><a href="#cb91-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-355"><a href="#cb91-355" aria-hidden="true" tabindex="-1"></a>p_size</span>
<span id="cb91-356"><a href="#cb91-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-357"><a href="#cb91-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-358"><a href="#cb91-358" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gamma  or Tweedie GLMM with random effects for plot</span></span>
<span id="cb91-359"><a href="#cb91-359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-362"><a href="#cb91-362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-363"><a href="#cb91-363" aria-hidden="true" tabindex="-1"></a>m_size_tweedie <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb91-364"><a href="#cb91-364" aria-hidden="true" tabindex="-1"></a>  sl_mm <span class="sc">~</span> season <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot_name),</span>
<span id="cb91-365"><a href="#cb91-365" aria-hidden="true" tabindex="-1"></a>  <span class="at">dispformula =</span> <span class="sc">~</span> season,  <span class="co"># Model dispersion as a function of season because unequal variances</span></span>
<span id="cb91-366"><a href="#cb91-366" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">tweedie</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="co"># better but still not the best, but I trust more this model</span></span>
<span id="cb91-367"><a href="#cb91-367" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> limpet_size</span>
<span id="cb91-368"><a href="#cb91-368" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-369"><a href="#cb91-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-370"><a href="#cb91-370" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_size_tweedie)</span>
<span id="cb91-371"><a href="#cb91-371" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-372"><a href="#cb91-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-373"><a href="#cb91-373" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb91-374"><a href="#cb91-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-377"><a href="#cb91-377" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-378"><a href="#cb91-378" aria-hidden="true" tabindex="-1"></a>sim_size <span class="ot">&lt;-</span> DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(m_size_tweedie, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb91-379"><a href="#cb91-379" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_size)</span>
<span id="cb91-380"><a href="#cb91-380" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testDispersion</span>(sim_size)</span>
<span id="cb91-381"><a href="#cb91-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-382"><a href="#cb91-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-383"><a href="#cb91-383" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Estimated marginal means (back-transformed to mm)</span></span>
<span id="cb91-384"><a href="#cb91-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-387"><a href="#cb91-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-388"><a href="#cb91-388" aria-hidden="true" tabindex="-1"></a>emm_size <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_size_tweedie, <span class="sc">~</span> season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb91-389"><a href="#cb91-389" aria-hidden="true" tabindex="-1"></a>emm_size</span>
<span id="cb91-390"><a href="#cb91-390" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_size, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb91-391"><a href="#cb91-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-392"><a href="#cb91-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-393"><a href="#cb91-393" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Figure: model-based seasonal means</span></span>
<span id="cb91-394"><a href="#cb91-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-397"><a href="#cb91-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-398"><a href="#cb91-398" aria-hidden="true" tabindex="-1"></a>df_size_emm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_size)</span>
<span id="cb91-399"><a href="#cb91-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-400"><a href="#cb91-400" aria-hidden="true" tabindex="-1"></a>p_size_emm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_size_emm, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb91-401"><a href="#cb91-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb91-402"><a href="#cb91-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> asymp.LCL, <span class="at">ymax =</span> asymp.UCL), <span class="at">width =</span> <span class="fl">0.12</span>) <span class="sc">+</span></span>
<span id="cb91-403"><a href="#cb91-403" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Estimated mean shell length (mm)"</span>,</span>
<span id="cb91-404"><a href="#cb91-404" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal effect on owl limpet size (Gamma GLMM)"</span></span>
<span id="cb91-405"><a href="#cb91-405" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb91-406"><a href="#cb91-406" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))</span>
<span id="cb91-407"><a href="#cb91-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-408"><a href="#cb91-408" aria-hidden="true" tabindex="-1"></a>p_size_emm</span>
<span id="cb91-409"><a href="#cb91-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-410"><a href="#cb91-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-411"><a href="#cb91-411" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Different kind of visual to look at size structure shifts (CDFs)</span></span>
<span id="cb91-412"><a href="#cb91-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-413"><a href="#cb91-413" aria-hidden="true" tabindex="-1"></a>Cumulative distributions are great for communicating shifts in size structure (e.g., truncation).</span>
<span id="cb91-414"><a href="#cb91-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-415"><a href="#cb91-415" aria-hidden="true" tabindex="-1"></a>You would interpret this plot by saying: “For each season, what fraction of limpets are smaller than a given shell length?” </span>
<span id="cb91-416"><a href="#cb91-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-417"><a href="#cb91-417" aria-hidden="true" tabindex="-1"></a>Example interpretations of the plot</span>
<span id="cb91-418"><a href="#cb91-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-419"><a href="#cb91-419" aria-hidden="true" tabindex="-1"></a>Steeper ECDF at small sizes in Spring</span>
<span id="cb91-420"><a href="#cb91-420" aria-hidden="true" tabindex="-1"></a>→ Maybe recent recruitment or better post-settlement survival</span>
<span id="cb91-421"><a href="#cb91-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-422"><a href="#cb91-422" aria-hidden="true" tabindex="-1"></a>Right-shifted ECDF in Fall/Summer </span>
<span id="cb91-423"><a href="#cb91-423" aria-hidden="true" tabindex="-1"></a>→ growth of survivors after spring recruitment?</span>
<span id="cb91-424"><a href="#cb91-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-425"><a href="#cb91-425" aria-hidden="true" tabindex="-1"></a>These patterns often cannot be detected by mean-based models alone.</span>
<span id="cb91-426"><a href="#cb91-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-427"><a href="#cb91-427" aria-hidden="true" tabindex="-1"></a>“We visualized seasonal shifts in owl limpet size structure using empirical cumulative distribution functions (ECDFs), which depict the proportion of individuals that are smaller than a given shell length without assuming an underlying distribution.”</span>
<span id="cb91-430"><a href="#cb91-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-431"><a href="#cb91-431" aria-hidden="true" tabindex="-1"></a>p_cdf <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb91-432"><a href="#cb91-432" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sl_mm, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb91-433"><a href="#cb91-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb91-434"><a href="#cb91-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb91-435"><a href="#cb91-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Shell length (mm)"</span>, <span class="at">y =</span> <span class="st">"Empirical CDF"</span>,</span>
<span id="cb91-436"><a href="#cb91-436" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal shifts in size structure (ECDF)"</span></span>
<span id="cb91-437"><a href="#cb91-437" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb91-438"><a href="#cb91-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb91-439"><a href="#cb91-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-440"><a href="#cb91-440" aria-hidden="true" tabindex="-1"></a>p_cdf</span>
<span id="cb91-441"><a href="#cb91-441" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-442"><a href="#cb91-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-443"><a href="#cb91-443" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-444"><a href="#cb91-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-445"><a href="#cb91-445" aria-hidden="true" tabindex="-1"></a>You would start with the mean values that you get from the emmeans output of the size model, state if there are any differences and then interpretit this model. The empirical cumulative distribution functions (ECDFs) showed  seasonal differences in size structure beyond mean responses. For a given shell length, the proportion of individuals by size differed among seasons, indicating seasonal shifts in the relative abundance of small versus large individuals. In particular, Spring exhibited a higher proportion of small individuals across much of the size range, whereas Fall and Winter showed a right-shifted distribution consistent with a greater representation of larger individuals.</span>
<span id="cb91-446"><a href="#cb91-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-447"><a href="#cb91-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-450"><a href="#cb91-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-451"><a href="#cb91-451" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 14</span></span>
<span id="cb91-452"><a href="#cb91-452" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb91-453"><a href="#cb91-453" aria-hidden="true" tabindex="-1"></a><span class="do">## Bring the figures together for pub quality</span></span>
<span id="cb91-454"><a href="#cb91-454" aria-hidden="true" tabindex="-1"></a><span class="do">## Add in stars with brackes to show significance between seasons based on emmeans</span></span>
<span id="cb91-455"><a href="#cb91-455" aria-hidden="true" tabindex="-1"></a>(p_density<span class="sc">|</span>p_size<span class="sc">|</span>p_cdf)<span class="sc">+</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb91-456"><a href="#cb91-456" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"figure1.png"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb91-457"><a href="#cb91-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-458"><a href="#cb91-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-459"><a href="#cb91-459" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 2: Does limpet presence affect community composition, and does it interact with season?</span></span>
<span id="cb91-460"><a href="#cb91-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-461"><a href="#cb91-461" aria-hidden="true" tabindex="-1"></a>We analyze both:</span>
<span id="cb91-462"><a href="#cb91-462" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Mobile invertebrate counts** (multivariate &amp; univariate)</span>
<span id="cb91-463"><a href="#cb91-463" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Sessile cover composition** (multivariate &amp; univariate) --  I am having a hard time with the sessile data. Seems like everything is mostly bare rock and I am not sure what the microalgae are here</span>
<span id="cb91-464"><a href="#cb91-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-465"><a href="#cb91-465" aria-hidden="true" tabindex="-1"></a>Key fixed effects:</span>
<span id="cb91-466"><a href="#cb91-466" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`col_pres`</span> (No vs Yes)</span>
<span id="cb91-467"><a href="#cb91-467" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`season`</span></span>
<span id="cb91-468"><a href="#cb91-468" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`col_pres * season`</span> interaction</span>
<span id="cb91-469"><a href="#cb91-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-470"><a href="#cb91-470" aria-hidden="true" tabindex="-1"></a>Random/blocking structure:</span>
<span id="cb91-471"><a href="#cb91-471" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`transect`</span> is used for random effects and permutation strata (to respect spatial non-independence).</span>
<span id="cb91-472"><a href="#cb91-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-473"><a href="#cb91-473" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-474"><a href="#cb91-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-475"><a href="#cb91-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-476"><a href="#cb91-476" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2A. Mobile invertebrates (counts)</span></span>
<span id="cb91-477"><a href="#cb91-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-478"><a href="#cb91-478" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identify species columns</span></span>
<span id="cb91-479"><a href="#cb91-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-482"><a href="#cb91-482" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-483"><a href="#cb91-483" aria-hidden="true" tabindex="-1"></a><span class="co"># group by species groups first</span></span>
<span id="cb91-484"><a href="#cb91-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-485"><a href="#cb91-485" aria-hidden="true" tabindex="-1"></a>mobile_grouped<span class="ot">&lt;-</span>mobile <span class="sc">%&gt;%</span></span>
<span id="cb91-486"><a href="#cb91-486" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Limpets =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(l_limatula, l_scabra, l_gigantea))),</span>
<span id="cb91-487"><a href="#cb91-487" aria-hidden="true" tabindex="-1"></a>         <span class="at">Chitons =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(nuttallina_sp, mopalia_sp, l_hartwegii,l_dentiens))),</span>
<span id="cb91-488"><a href="#cb91-488" aria-hidden="true" tabindex="-1"></a>         <span class="at">Turbans =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(t_eiseni<span class="sc">:</span>t_gallina))),</span>
<span id="cb91-489"><a href="#cb91-489" aria-hidden="true" tabindex="-1"></a>         <span class="at">Periwinkles =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(l_plena, l_keenae))),</span>
<span id="cb91-490"><a href="#cb91-490" aria-hidden="true" tabindex="-1"></a>         <span class="at">Whelks =</span> m_lugubris) <span class="sc">%&gt;%</span></span>
<span id="cb91-491"><a href="#cb91-491" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(m_lugubris<span class="sc">:</span>l_gigantea)) <span class="co"># what is -c</span></span>
<span id="cb91-492"><a href="#cb91-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-493"><a href="#cb91-493" aria-hidden="true" tabindex="-1"></a><span class="co"># metadata</span></span>
<span id="cb91-494"><a href="#cb91-494" aria-hidden="true" tabindex="-1"></a>mobile_meta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"season"</span>,<span class="st">"date"</span>,<span class="st">"transect"</span>,<span class="st">"plot_name"</span>,<span class="st">"l_r"</span>,<span class="st">"meter_no"</span>,<span class="st">"col_pres"</span>,<span class="st">"t_f"</span>,<span class="st">"tag_id"</span>)</span>
<span id="cb91-495"><a href="#cb91-495" aria-hidden="true" tabindex="-1"></a>mobile_spp <span class="ot">&lt;-</span> mobile_grouped <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(mobile_meta)) <span class="co">#what is -any_of</span></span>
<span id="cb91-496"><a href="#cb91-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-497"><a href="#cb91-497" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity checks: are these non-negative counts?</span></span>
<span id="cb91-498"><a href="#cb91-498" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mobile_spp)</span>
<span id="cb91-499"><a href="#cb91-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-500"><a href="#cb91-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-501"><a href="#cb91-501" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transformations for multivariate analyses</span></span>
<span id="cb91-502"><a href="#cb91-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-503"><a href="#cb91-503" aria-hidden="true" tabindex="-1"></a>For community composition, we typically:</span>
<span id="cb91-504"><a href="#cb91-504" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>use **gower** on square-root transformed counts since lots of zeros. Bray-Curtis did not work.</span>
<span id="cb91-505"><a href="#cb91-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-506"><a href="#cb91-506" aria-hidden="true" tabindex="-1"></a>For Gower, multiplying all counts by the same constant (e.g., converting to per m² when all plots have identical area) does **not** change dissimilarities; we still report univariate abundance in **m⁻²** for interpretability.</span>
<span id="cb91-507"><a href="#cb91-507" aria-hidden="true" tabindex="-1"></a>Information on coding dissimilarity indices https://rdrr.io/cran/vegan/man/vegdist.html</span>
<span id="cb91-508"><a href="#cb91-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-509"><a href="#cb91-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-512"><a href="#cb91-512" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-513"><a href="#cb91-513" aria-hidden="true" tabindex="-1"></a>mobile_mat <span class="ot">&lt;-</span> mobile_spp <span class="sc">%&gt;%</span></span>
<span id="cb91-514"><a href="#cb91-514" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span> <span class="co"># make the missing values zeros</span></span>
<span id="cb91-515"><a href="#cb91-515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb91-516"><a href="#cb91-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-517"><a href="#cb91-517" aria-hidden="true" tabindex="-1"></a><span class="co"># gower dissimilarity on sqrt counts because 0s present</span></span>
<span id="cb91-518"><a href="#cb91-518" aria-hidden="true" tabindex="-1"></a>mobile_bc <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">sqrt</span>(mobile_mat), <span class="at">method =</span> <span class="st">"gower"</span>)</span>
<span id="cb91-519"><a href="#cb91-519" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-520"><a href="#cb91-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-521"><a href="#cb91-521" aria-hidden="true" tabindex="-1"></a><span class="fu">### PERMANOVA (adonis2) with permutations constrained by transect</span></span>
<span id="cb91-522"><a href="#cb91-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-523"><a href="#cb91-523" aria-hidden="true" tabindex="-1"></a>This tests whether multivariate centroids differ by predictors.</span>
<span id="cb91-524"><a href="#cb91-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-527"><a href="#cb91-527" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-528"><a href="#cb91-528" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb91-529"><a href="#cb91-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-530"><a href="#cb91-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-531"><a href="#cb91-531" aria-hidden="true" tabindex="-1"></a>adon_mobile <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(</span>
<span id="cb91-532"><a href="#cb91-532" aria-hidden="true" tabindex="-1"></a>  mobile_bc <span class="sc">~</span> col_pres <span class="sc">*</span> season,</span>
<span id="cb91-533"><a href="#cb91-533" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile,</span>
<span id="cb91-534"><a href="#cb91-534" aria-hidden="true" tabindex="-1"></a>  <span class="at">permutations =</span> <span class="dv">999</span>,</span>
<span id="cb91-535"><a href="#cb91-535" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> mobile<span class="sc">$</span>transect</span>
<span id="cb91-536"><a href="#cb91-536" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-537"><a href="#cb91-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-538"><a href="#cb91-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-539"><a href="#cb91-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-540"><a href="#cb91-540" aria-hidden="true" tabindex="-1"></a>adon_mobile</span>
<span id="cb91-541"><a href="#cb91-541" aria-hidden="true" tabindex="-1"></a><span class="do">## Need to add in the pairwise differences-- follow up with this</span></span>
<span id="cb91-542"><a href="#cb91-542" aria-hidden="true" tabindex="-1"></a><span class="co">#What about pairwise.adonis2()</span></span>
<span id="cb91-543"><a href="#cb91-543" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-544"><a href="#cb91-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-545"><a href="#cb91-545" aria-hidden="true" tabindex="-1"></a><span class="fu">### Check dispersion (PERMDISP)</span></span>
<span id="cb91-546"><a href="#cb91-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-547"><a href="#cb91-547" aria-hidden="true" tabindex="-1"></a>PERMANOVA can be sensitive to differences in within-group dispersion.</span>
<span id="cb91-548"><a href="#cb91-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-551"><a href="#cb91-551" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-552"><a href="#cb91-552" aria-hidden="true" tabindex="-1"></a>disp_mobile <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(mobile_bc, <span class="fu">interaction</span>(mobile<span class="sc">$</span>col_pres, mobile<span class="sc">$</span>season))</span>
<span id="cb91-553"><a href="#cb91-553" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(disp_mobile)</span>
<span id="cb91-554"><a href="#cb91-554" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(disp_mobile, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb91-555"><a href="#cb91-555" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(disp_mobile) <span class="co"># get pairwise differences</span></span>
<span id="cb91-556"><a href="#cb91-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-557"><a href="#cb91-557" aria-hidden="true" tabindex="-1"></a><span class="co"># Yes clearly very different dispersion (the size of the circle)--but driven by season based on pairwise</span></span>
<span id="cb91-558"><a href="#cb91-558" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-559"><a href="#cb91-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-560"><a href="#cb91-560" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ordination: NMDS (visualize patterns)</span></span>
<span id="cb91-561"><a href="#cb91-561" aria-hidden="true" tabindex="-1"></a>Website with info on metaMDS https://vegandevs.github.io/vegan/reference/metaMDS.html</span>
<span id="cb91-564"><a href="#cb91-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-565"><a href="#cb91-565" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb91-566"><a href="#cb91-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-567"><a href="#cb91-567" aria-hidden="true" tabindex="-1"></a>nmds_mobile <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(<span class="fu">sqrt</span>(mobile_mat), <span class="at">distance =</span> <span class="st">"gower"</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trymax =</span> <span class="dv">100</span>)</span>
<span id="cb91-568"><a href="#cb91-568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-569"><a href="#cb91-569" aria-hidden="true" tabindex="-1"></a>nmds_mobile<span class="sc">$</span>stress <span class="co">#get the stress</span></span>
<span id="cb91-570"><a href="#cb91-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-571"><a href="#cb91-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-572"><a href="#cb91-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-575"><a href="#cb91-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-576"><a href="#cb91-576" aria-hidden="true" tabindex="-1"></a><span class="co"># --- NMDS biplot for MOBILE invertebrates ( species vectors) ----</span></span>
<span id="cb91-577"><a href="#cb91-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-578"><a href="#cb91-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-579"><a href="#cb91-579" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>) <span class="co">#did you select 42 for a specific reason?</span></span>
<span id="cb91-580"><a href="#cb91-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-581"><a href="#cb91-581" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit species vectors to the NMDS using envfit. envfit finds vectors or vector averages</span></span>
<span id="cb91-582"><a href="#cb91-582" aria-hidden="true" tabindex="-1"></a><span class="co">#    - "display = 'species'" returns directions for each taxa</span></span>
<span id="cb91-583"><a href="#cb91-583" aria-hidden="true" tabindex="-1"></a><span class="co">#    - we fit to sqrt(mobile_mat) if NMDS was based on sqrt counts</span></span>
<span id="cb91-584"><a href="#cb91-584" aria-hidden="true" tabindex="-1"></a>fit_spp <span class="ot">&lt;-</span> <span class="fu">envfit</span>(nmds_mobile, <span class="fu">sqrt</span>(mobile_mat), <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb91-585"><a href="#cb91-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-586"><a href="#cb91-586" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract site scores</span></span>
<span id="cb91-587"><a href="#cb91-587" aria-hidden="true" tabindex="-1"></a>sites_df <span class="ot">&lt;-</span> <span class="fu">scores</span>(nmds_mobile, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-588"><a href="#cb91-588" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-589"><a href="#cb91-589" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"site_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-590"><a href="#cb91-590" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(mobile_grouped <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">site_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> <span class="fu">select</span>(site_id, season, col_pres, transect))</span>
<span id="cb91-591"><a href="#cb91-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-592"><a href="#cb91-592" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract species vectors + p-values; keep only significant / strong ones</span></span>
<span id="cb91-593"><a href="#cb91-593" aria-hidden="true" tabindex="-1"></a>vec_df <span class="ot">&lt;-</span> <span class="fu">scores</span>(fit_spp, <span class="at">display =</span> <span class="st">"vectors"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-594"><a href="#cb91-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-595"><a href="#cb91-595" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"taxon"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-596"><a href="#cb91-596" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p-values are in fit_spp$vectors$pvals; same order as rows in scores()</span></span>
<span id="cb91-597"><a href="#cb91-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> fit_spp<span class="sc">$</span>vectors<span class="sc">$</span>pvals) <span class="sc">%&gt;%</span></span>
<span id="cb91-598"><a href="#cb91-598" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vector strength (longer = stronger relationship with ordination)</span></span>
<span id="cb91-599"><a href="#cb91-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="fu">sqrt</span>(NMDS1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> NMDS2<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb91-600"><a href="#cb91-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(p) <span class="do">## all the species have significant vectors</span></span>
<span id="cb91-601"><a href="#cb91-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-602"><a href="#cb91-602" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose which taxa to label: either significant + top N by vector length</span></span>
<span id="cb91-603"><a href="#cb91-603" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb91-604"><a href="#cb91-604" aria-hidden="true" tabindex="-1"></a>top_n <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb91-605"><a href="#cb91-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-606"><a href="#cb91-606" aria-hidden="true" tabindex="-1"></a>vec_keep <span class="ot">&lt;-</span> vec_df <span class="sc">%&gt;%</span></span>
<span id="cb91-607"><a href="#cb91-607" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;=</span> alpha) <span class="sc">%&gt;%</span></span>
<span id="cb91-608"><a href="#cb91-608" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> r, <span class="at">n =</span> top_n)</span>
<span id="cb91-609"><a href="#cb91-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-610"><a href="#cb91-610" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale vectors to match plot extent (so arrows look nice)</span></span>
<span id="cb91-611"><a href="#cb91-611" aria-hidden="true" tabindex="-1"></a><span class="co">#    This rescales arrows relative to NMDS axes range.</span></span>
<span id="cb91-612"><a href="#cb91-612" aria-hidden="true" tabindex="-1"></a>arrow_mult <span class="ot">&lt;-</span> <span class="fl">0.85</span> <span class="sc">*</span> <span class="fu">min</span>(</span>
<span id="cb91-613"><a href="#cb91-613" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="fu">range</span>(sites_df<span class="sc">$</span>NMDS1)) <span class="sc">/</span> <span class="fu">diff</span>(<span class="fu">range</span>(vec_keep<span class="sc">$</span>NMDS1)),</span>
<span id="cb91-614"><a href="#cb91-614" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="fu">range</span>(sites_df<span class="sc">$</span>NMDS2)) <span class="sc">/</span> <span class="fu">diff</span>(<span class="fu">range</span>(vec_keep<span class="sc">$</span>NMDS2))</span>
<span id="cb91-615"><a href="#cb91-615" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-616"><a href="#cb91-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-617"><a href="#cb91-617" aria-hidden="true" tabindex="-1"></a>vec_keep <span class="ot">&lt;-</span> vec_keep <span class="sc">%&gt;%</span></span>
<span id="cb91-618"><a href="#cb91-618" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NMDS1 =</span> NMDS1 <span class="sc">*</span> arrow_mult,</span>
<span id="cb91-619"><a href="#cb91-619" aria-hidden="true" tabindex="-1"></a>         <span class="at">NMDS2 =</span> NMDS2 <span class="sc">*</span> arrow_mult)</span>
<span id="cb91-620"><a href="#cb91-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-621"><a href="#cb91-621" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: sites + ellipses + species vectors (biplot)</span></span>
<span id="cb91-622"><a href="#cb91-622" aria-hidden="true" tabindex="-1"></a>p_biplot_mobile <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sites_df, <span class="fu">aes</span>(NMDS1, NMDS2)) <span class="sc">+</span></span>
<span id="cb91-623"><a href="#cb91-623" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sites</span></span>
<span id="cb91-624"><a href="#cb91-624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> season, <span class="at">shape =</span> col_pres), <span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb91-625"><a href="#cb91-625" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group ellipses</span></span>
<span id="cb91-626"><a href="#cb91-626" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(season, col_pres), <span class="at">color =</span> season),</span>
<span id="cb91-627"><a href="#cb91-627" aria-hidden="true" tabindex="-1"></a>               <span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb91-628"><a href="#cb91-628" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Species arrows</span></span>
<span id="cb91-629"><a href="#cb91-629" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb91-630"><a href="#cb91-630" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> vec_keep,</span>
<span id="cb91-631"><a href="#cb91-631" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> NMDS1, <span class="at">yend =</span> NMDS2),</span>
<span id="cb91-632"><a href="#cb91-632" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb91-633"><a href="#cb91-633" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.7</span>,</span>
<span id="cb91-634"><a href="#cb91-634" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.18</span>, <span class="st">"cm"</span>))</span>
<span id="cb91-635"><a href="#cb91-635" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb91-636"><a href="#cb91-636" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Species labels</span></span>
<span id="cb91-637"><a href="#cb91-637" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb91-638"><a href="#cb91-638" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> vec_keep,</span>
<span id="cb91-639"><a href="#cb91-639" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">label =</span> taxon),</span>
<span id="cb91-640"><a href="#cb91-640" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb91-641"><a href="#cb91-641" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb91-642"><a href="#cb91-642" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb91-643"><a href="#cb91-643" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span></span>
<span id="cb91-644"><a href="#cb91-644" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb91-645"><a href="#cb91-645" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors) <span class="sc">+</span></span>
<span id="cb91-646"><a href="#cb91-646" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb91-647"><a href="#cb91-647" aria-hidden="true" tabindex="-1"></a>    <span class="co">#title = "Mobile invertebrates NMDS biplot",</span></span>
<span id="cb91-648"><a href="#cb91-648" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Stress = "</span>, <span class="fu">round</span>(nmds_mobile<span class="sc">$</span>stress, <span class="dv">3</span>)),</span>
<span id="cb91-649"><a href="#cb91-649" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Season"</span>,</span>
<span id="cb91-650"><a href="#cb91-650" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span></span>
<span id="cb91-651"><a href="#cb91-651" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb91-652"><a href="#cb91-652" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb91-653"><a href="#cb91-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb91-654"><a href="#cb91-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-655"><a href="#cb91-655" aria-hidden="true" tabindex="-1"></a>p_biplot_mobile</span>
<span id="cb91-656"><a href="#cb91-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-657"><a href="#cb91-657" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-658"><a href="#cb91-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-659"><a href="#cb91-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-660"><a href="#cb91-660" aria-hidden="true" tabindex="-1"></a><span class="fu">### Univariate summaries (total abundance)</span></span>
<span id="cb91-661"><a href="#cb91-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-662"><a href="#cb91-662" aria-hidden="true" tabindex="-1"></a>These are interpretable “whole-community” metrics.</span>
<span id="cb91-663"><a href="#cb91-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-666"><a href="#cb91-666" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-667"><a href="#cb91-667" aria-hidden="true" tabindex="-1"></a>mobile_alpha <span class="ot">&lt;-</span> mobile_grouped <span class="sc">%&gt;%</span></span>
<span id="cb91-668"><a href="#cb91-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-669"><a href="#cb91-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb91-670"><a href="#cb91-670" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  mobile plot is 0.25 m² -- This is right</span></span>
<span id="cb91-671"><a href="#cb91-671" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="fl">0.25</span>,</span>
<span id="cb91-672"><a href="#cb91-672" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_abund =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(<span class="fu">all_of</span>(<span class="fu">colnames</span>(mobile_mat))), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb91-673"><a href="#cb91-673" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_abund_m2 =</span> total_abund <span class="sc">/</span> area_m2,</span>
<span id="cb91-674"><a href="#cb91-674" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb91-675"><a href="#cb91-675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb91-676"><a href="#cb91-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-677"><a href="#cb91-677" aria-hidden="true" tabindex="-1"></a>mobile_alpha <span class="sc">%&gt;%</span> <span class="fu">select</span>(season, col_pres, transect, total_abund) <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span>
<span id="cb91-678"><a href="#cb91-678" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-679"><a href="#cb91-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-680"><a href="#cb91-680" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mixed models for Individual metrics</span></span>
<span id="cb91-681"><a href="#cb91-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-682"><a href="#cb91-682" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`total_abund`</span>: NB GLMM</span>
<span id="cb91-683"><a href="#cb91-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-686"><a href="#cb91-686" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-687"><a href="#cb91-687" aria-hidden="true" tabindex="-1"></a>m_mobile_total <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb91-688"><a href="#cb91-688" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts with area offset to infer abundance density (per m²)</span></span>
<span id="cb91-689"><a href="#cb91-689" aria-hidden="true" tabindex="-1"></a>  total_abund <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect),</span>
<span id="cb91-690"><a href="#cb91-690" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb91-691"><a href="#cb91-691" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile_alpha</span>
<span id="cb91-692"><a href="#cb91-692" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-693"><a href="#cb91-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-694"><a href="#cb91-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-695"><a href="#cb91-695" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mobile_total)</span>
<span id="cb91-696"><a href="#cb91-696" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the species pairs What do you mean by this?</span></span>
<span id="cb91-697"><a href="#cb91-697" aria-hidden="true" tabindex="-1"></a>emm_total <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_mobile_total, <span class="sc">~</span> col_pres<span class="sc">|</span>season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb91-698"><a href="#cb91-698" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_total, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb91-699"><a href="#cb91-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-700"><a href="#cb91-700" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(m_mobile_total)</span>
<span id="cb91-701"><a href="#cb91-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-702"><a href="#cb91-702" aria-hidden="true" tabindex="-1"></a><span class="co"># here is your example for limpets.  Do for the rest of the species</span></span>
<span id="cb91-703"><a href="#cb91-703" aria-hidden="true" tabindex="-1"></a>m_mobile_Limpet <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb91-704"><a href="#cb91-704" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts with area offset to infer abundance density (per m²)</span></span>
<span id="cb91-705"><a href="#cb91-705" aria-hidden="true" tabindex="-1"></a>  Limpets <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect),</span>
<span id="cb91-706"><a href="#cb91-706" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb91-707"><a href="#cb91-707" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile_alpha</span>
<span id="cb91-708"><a href="#cb91-708" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-709"><a href="#cb91-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-710"><a href="#cb91-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-711"><a href="#cb91-711" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mobile_Limpet)</span>
<span id="cb91-712"><a href="#cb91-712" aria-hidden="true" tabindex="-1"></a>emm_limpet <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_mobile_Limpet, <span class="sc">~</span> col_pres<span class="sc">|</span>season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb91-713"><a href="#cb91-713" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_limpet, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb91-714"><a href="#cb91-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-715"><a href="#cb91-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-716"><a href="#cb91-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-717"><a href="#cb91-717" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure: total abundance by COL presence and season</span></span>
<span id="cb91-718"><a href="#cb91-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-721"><a href="#cb91-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-722"><a href="#cb91-722" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 14</span></span>
<span id="cb91-723"><a href="#cb91-723" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6 </span></span>
<span id="cb91-724"><a href="#cb91-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-725"><a href="#cb91-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-726"><a href="#cb91-726" aria-hidden="true" tabindex="-1"></a><span class="co"># everything</span></span>
<span id="cb91-727"><a href="#cb91-727" aria-hidden="true" tabindex="-1"></a>p_alpha <span class="ot">&lt;-</span> mobile_alpha <span class="sc">%&gt;%</span></span>
<span id="cb91-728"><a href="#cb91-728" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Limpets<span class="sc">:</span>Whelks, total_abund_m2 </span>
<span id="cb91-729"><a href="#cb91-729" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb91-730"><a href="#cb91-730" aria-hidden="true" tabindex="-1"></a>                        ), <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-731"><a href="#cb91-731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_log =</span> value<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb91-732"><a href="#cb91-732" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> value_log, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb91-733"><a href="#cb91-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log"</span>)<span class="sc">+</span></span>
<span id="cb91-734"><a href="#cb91-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb91-735"><a href="#cb91-735" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb91-736"><a href="#cb91-736" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb91-737"><a href="#cb91-737" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb91-738"><a href="#cb91-738" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> season), <span class="at">color =</span> <span class="cn">NULL</span>)<span class="sc">+</span> <span class="co">#outlier.shape = NA, alpha = 0.5) +</span></span>
<span id="cb91-739"><a href="#cb91-739" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>))<span class="sc">+</span></span>
<span id="cb91-740"><a href="#cb91-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> metric, <span class="at">scales =</span> <span class="st">"free_y"</span>)<span class="sc">+</span></span>
<span id="cb91-741"><a href="#cb91-741" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Density (m⁻²)"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb91-742"><a href="#cb91-742" aria-hidden="true" tabindex="-1"></a>      <span class="co"># title = "Mobile invertebrate alpha metrics vs limpet presence and season"</span></span>
<span id="cb91-743"><a href="#cb91-743" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb91-744"><a href="#cb91-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb91-745"><a href="#cb91-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-746"><a href="#cb91-746" aria-hidden="true" tabindex="-1"></a><span class="do">## total abundance only</span></span>
<span id="cb91-747"><a href="#cb91-747" aria-hidden="true" tabindex="-1"></a>p_total <span class="ot">&lt;-</span> mobile_alpha <span class="sc">%&gt;%</span></span>
<span id="cb91-748"><a href="#cb91-748" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> total_abund_m2<span class="sc">+</span><span class="dv">1</span>, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb91-749"><a href="#cb91-749" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log"</span>)<span class="sc">+</span></span>
<span id="cb91-750"><a href="#cb91-750" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb91-751"><a href="#cb91-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb91-752"><a href="#cb91-752" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb91-753"><a href="#cb91-753" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb91-754"><a href="#cb91-754" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> season), <span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span> <span class="co">#outlier.shape = NA, alpha = 0.5) +</span></span>
<span id="cb91-755"><a href="#cb91-755" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb91-756"><a href="#cb91-756" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Total density (m⁻²)"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb91-757"><a href="#cb91-757" aria-hidden="true" tabindex="-1"></a>      <span class="co"># title = "Mobile invertebrate alpha metrics vs limpet presence and season"</span></span>
<span id="cb91-758"><a href="#cb91-758" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb91-759"><a href="#cb91-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb91-760"><a href="#cb91-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-761"><a href="#cb91-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-762"><a href="#cb91-762" aria-hidden="true" tabindex="-1"></a><span class="do">## add in brackets for yes/no pairs for ones that are significant based on emmeans and clean up the title of total_abunc... and double check that the area is correct since I think you did it two different ways</span></span>
<span id="cb91-763"><a href="#cb91-763" aria-hidden="true" tabindex="-1"></a>p_alpha<span class="sc">+</span>p_biplot_mobile<span class="sc">+</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb91-764"><a href="#cb91-764" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"figure2.png"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb91-765"><a href="#cb91-765" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-766"><a href="#cb91-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-767"><a href="#cb91-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-768"><a href="#cb91-768" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-769"><a href="#cb91-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-770"><a href="#cb91-770" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sessile community (% cover / proportional cover)</span></span>
<span id="cb91-771"><a href="#cb91-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-772"><a href="#cb91-772" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identify sessile cover columns --- i dont trust this analysis rn</span></span>
<span id="cb91-773"><a href="#cb91-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-776"><a href="#cb91-776" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-777"><a href="#cb91-777" aria-hidden="true" tabindex="-1"></a>sess_meta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"season"</span>,<span class="st">"date"</span>,<span class="st">"transect"</span>,<span class="st">"plot_name"</span>,<span class="st">"l_r"</span>,<span class="st">"meter_no"</span>,<span class="st">"col_pres"</span>,<span class="st">"t_f"</span>,<span class="st">"tag_id"</span>)</span>
<span id="cb91-778"><a href="#cb91-778" aria-hidden="true" tabindex="-1"></a>sess_spp <span class="ot">&lt;-</span> sessile <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(sess_meta))</span>
<span id="cb91-779"><a href="#cb91-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-780"><a href="#cb91-780" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sess_spp)</span>
<span id="cb91-781"><a href="#cb91-781" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-782"><a href="#cb91-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-783"><a href="#cb91-783" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multivariate test: PERMANOVA on gower</span></span>
<span id="cb91-784"><a href="#cb91-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-785"><a href="#cb91-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-788"><a href="#cb91-788" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-789"><a href="#cb91-789" aria-hidden="true" tabindex="-1"></a>sess_mat <span class="ot">&lt;-</span> sess_spp <span class="sc">%&gt;%</span></span>
<span id="cb91-790"><a href="#cb91-790" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb91-791"><a href="#cb91-791" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb91-792"><a href="#cb91-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-793"><a href="#cb91-793" aria-hidden="true" tabindex="-1"></a>sess_bc <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">sqrt</span>(sess_mat), <span class="at">method =</span> <span class="st">"gower"</span>)</span>
<span id="cb91-794"><a href="#cb91-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-795"><a href="#cb91-795" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb91-796"><a href="#cb91-796" aria-hidden="true" tabindex="-1"></a>adon_sess <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(</span>
<span id="cb91-797"><a href="#cb91-797" aria-hidden="true" tabindex="-1"></a>  sess_bc <span class="sc">~</span> col_pres <span class="sc">*</span> season,</span>
<span id="cb91-798"><a href="#cb91-798" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sessile,</span>
<span id="cb91-799"><a href="#cb91-799" aria-hidden="true" tabindex="-1"></a>  <span class="at">permutations =</span> <span class="dv">999</span>,</span>
<span id="cb91-800"><a href="#cb91-800" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> sessile<span class="sc">$</span>transect</span>
<span id="cb91-801"><a href="#cb91-801" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb91-802"><a href="#cb91-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-803"><a href="#cb91-803" aria-hidden="true" tabindex="-1"></a>adon_sess</span>
<span id="cb91-804"><a href="#cb91-804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-805"><a href="#cb91-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-806"><a href="#cb91-806" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dispersion check</span></span>
<span id="cb91-807"><a href="#cb91-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-810"><a href="#cb91-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-811"><a href="#cb91-811" aria-hidden="true" tabindex="-1"></a>disp_sess <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(sess_bc, <span class="fu">interaction</span>(sessile<span class="sc">$</span>col_pres, sessile<span class="sc">$</span>season))</span>
<span id="cb91-812"><a href="#cb91-812" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(disp_sess)</span>
<span id="cb91-813"><a href="#cb91-813" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(disp_sess, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb91-814"><a href="#cb91-814" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-815"><a href="#cb91-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-816"><a href="#cb91-816" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ordination: NMDS</span></span>
<span id="cb91-817"><a href="#cb91-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-820"><a href="#cb91-820" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-821"><a href="#cb91-821" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb91-822"><a href="#cb91-822" aria-hidden="true" tabindex="-1"></a>nmds_sess <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(sess_mat, <span class="at">distance =</span> <span class="st">"gower"</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trymax =</span> <span class="dv">100</span>)</span>
<span id="cb91-823"><a href="#cb91-823" aria-hidden="true" tabindex="-1"></a>nmds_sess<span class="sc">$</span>stress</span>
<span id="cb91-824"><a href="#cb91-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-825"><a href="#cb91-825" aria-hidden="true" tabindex="-1"></a>scores_sess <span class="ot">&lt;-</span> <span class="fu">scores</span>(nmds_sess, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-826"><a href="#cb91-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb91-827"><a href="#cb91-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(sessile <span class="sc">%&gt;%</span> <span class="fu">select</span>(season, col_pres, transect))</span>
<span id="cb91-828"><a href="#cb91-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-829"><a href="#cb91-829" aria-hidden="true" tabindex="-1"></a>p_nmds_sess <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scores_sess, <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb91-830"><a href="#cb91-830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb91-831"><a href="#cb91-831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(season, col_pres)), <span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb91-832"><a href="#cb91-832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sessile community: NMDS (gower on proportional cover)"</span>,</span>
<span id="cb91-833"><a href="#cb91-833" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Stress = "</span>, <span class="fu">round</span>(nmds_sess<span class="sc">$</span>stress, <span class="dv">3</span>)),</span>
<span id="cb91-834"><a href="#cb91-834" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span>, <span class="at">color =</span> <span class="st">"Season"</span>) <span class="sc">+</span></span>
<span id="cb91-835"><a href="#cb91-835" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb91-836"><a href="#cb91-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-837"><a href="#cb91-837" aria-hidden="true" tabindex="-1"></a>p_nmds_sess</span>
<span id="cb91-838"><a href="#cb91-838" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-839"><a href="#cb91-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-840"><a href="#cb91-840" aria-hidden="true" tabindex="-1"></a><span class="fu">### Univariate analyses for key functional groups</span></span>
<span id="cb91-841"><a href="#cb91-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-842"><a href="#cb91-842" aria-hidden="true" tabindex="-1"></a>Depending on your ecological framing,  response variables may include:</span>
<span id="cb91-843"><a href="#cb91-843" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Bare rock** (space availability)</span>
<span id="cb91-844"><a href="#cb91-844" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Erect fleshy algae** (here likely <span class="in">`ulva_sp`</span>, <span class="in">`endocaldia_sp`</span>, etc.)</span>
<span id="cb91-845"><a href="#cb91-845" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Crustose coralline algae** (<span class="in">`coralline_crust`</span>)</span>
<span id="cb91-846"><a href="#cb91-846" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Barnacles** (<span class="in">`chtalmus_balanus`</span>)</span>
<span id="cb91-847"><a href="#cb91-847" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Tube worms** (<span class="in">`phragmatopoma_californica`</span>) etc.</span>
<span id="cb91-848"><a href="#cb91-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-849"><a href="#cb91-849" aria-hidden="true" tabindex="-1"></a>Where is the microalgae?</span>
<span id="cb91-850"><a href="#cb91-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-851"><a href="#cb91-851" aria-hidden="true" tabindex="-1"></a>Because cover is proportional (0–1), a practical approach is:</span>
<span id="cb91-852"><a href="#cb91-852" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>transform with <span class="in">`logit01()`</span> and use LMM/GLMM with Gaussian errors, OR</span>
<span id="cb91-853"><a href="#cb91-853" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Beta regression (more complex; <span class="in">`glmmTMB`</span> can do it with <span class="in">`family = beta_family()`</span>).</span>
<span id="cb91-854"><a href="#cb91-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-855"><a href="#cb91-855" aria-hidden="true" tabindex="-1"></a>Here we demonstrate logit-transformed LMMs with transect random intercepts.</span>
<span id="cb91-856"><a href="#cb91-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-859"><a href="#cb91-859" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-860"><a href="#cb91-860" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose a few focal cover variables to test (edit for your hypotheses)</span></span>
<span id="cb91-861"><a href="#cb91-861" aria-hidden="true" tabindex="-1"></a>focal_cover <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bare_rock"</span>, <span class="st">"ulva_sp"</span>, <span class="st">"coralline_crust"</span>, <span class="st">"chtalmus_balanus"</span>, <span class="st">"ralfsia_sp"</span>)</span>
<span id="cb91-862"><a href="#cb91-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-863"><a href="#cb91-863" aria-hidden="true" tabindex="-1"></a>sess_long <span class="ot">&lt;-</span> sessile <span class="sc">%&gt;%</span></span>
<span id="cb91-864"><a href="#cb91-864" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">all_of</span>(focal_cover), <span class="at">names_to =</span> <span class="st">"taxon"</span>, <span class="at">values_to =</span> <span class="st">"cover"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb91-865"><a href="#cb91-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb91-866"><a href="#cb91-866" aria-hidden="true" tabindex="-1"></a>    <span class="at">cover =</span> <span class="fu">as.numeric</span>(cover),</span>
<span id="cb91-867"><a href="#cb91-867" aria-hidden="true" tabindex="-1"></a>    <span class="at">cover_logit =</span> <span class="fu">logit01</span>(cover)</span>
<span id="cb91-868"><a href="#cb91-868" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb91-869"><a href="#cb91-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-870"><a href="#cb91-870" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit one model per taxon (pre-specified list!)</span></span>
<span id="cb91-871"><a href="#cb91-871" aria-hidden="true" tabindex="-1"></a>models_cover <span class="ot">&lt;-</span> sess_long <span class="sc">%&gt;%</span></span>
<span id="cb91-872"><a href="#cb91-872" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(taxon) <span class="sc">%&gt;%</span></span>
<span id="cb91-873"><a href="#cb91-873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_map</span>(<span class="sc">~</span>{</span>
<span id="cb91-874"><a href="#cb91-874" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lmer</span>(cover_logit <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect), <span class="at">data =</span> .x)</span>
<span id="cb91-875"><a href="#cb91-875" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb91-876"><a href="#cb91-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-877"><a href="#cb91-877" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(models_cover) <span class="ot">&lt;-</span> <span class="fu">unique</span>(sess_long<span class="sc">$</span>taxon)</span>
<span id="cb91-878"><a href="#cb91-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-879"><a href="#cb91-879" aria-hidden="true" tabindex="-1"></a><span class="co"># Summaries</span></span>
<span id="cb91-880"><a href="#cb91-880" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(models_cover, summary)</span>
<span id="cb91-881"><a href="#cb91-881" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-882"><a href="#cb91-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-883"><a href="#cb91-883" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure: focal cover responses</span></span>
<span id="cb91-884"><a href="#cb91-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-887"><a href="#cb91-887" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb91-888"><a href="#cb91-888" aria-hidden="true" tabindex="-1"></a>p_cover <span class="ot">&lt;-</span> sess_long <span class="sc">%&gt;%</span></span>
<span id="cb91-889"><a href="#cb91-889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> cover, <span class="at">fill =</span> col_pres)) <span class="sc">+</span></span>
<span id="cb91-890"><a href="#cb91-890" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_point(position = position_dodge(width = 0.7))+</span></span>
<span id="cb91-891"><a href="#cb91-891" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb91-892"><a href="#cb91-892" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), </span>
<span id="cb91-893"><a href="#cb91-893" aria-hidden="true" tabindex="-1"></a>              <span class="co"># outlier.shape = NA, </span></span>
<span id="cb91-894"><a href="#cb91-894" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb91-895"><a href="#cb91-895" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> taxon, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb91-896"><a href="#cb91-896" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Proportional cover"</span>, <span class="at">fill =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb91-897"><a href="#cb91-897" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Sessile functional/taxon cover vs limpet presence and season"</span>) <span class="sc">+</span></span>
<span id="cb91-898"><a href="#cb91-898" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb91-899"><a href="#cb91-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-900"><a href="#cb91-900" aria-hidden="true" tabindex="-1"></a>p_cover</span>
<span id="cb91-901"><a href="#cb91-901" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb91-902"><a href="#cb91-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-903"><a href="#cb91-903" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-904"><a href="#cb91-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-905"><a href="#cb91-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-906"><a href="#cb91-906" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ecological interpretation (how to read results -- fill in below with your references)</span></span>
<span id="cb91-907"><a href="#cb91-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-908"><a href="#cb91-908" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1) Seasonal density and size patterns (what’s plausible)</span></span>
<span id="cb91-909"><a href="#cb91-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-910"><a href="#cb91-910" aria-hidden="true" tabindex="-1"></a>Depending on your results, common mechanisms include:</span>
<span id="cb91-911"><a href="#cb91-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-912"><a href="#cb91-912" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Recruitment pulses** (seasonal larval supply) can increase density of **small** limpets after settlement.</span>
<span id="cb91-913"><a href="#cb91-913" aria-hidden="true" tabindex="-1"></a>-- What else do you think?</span>
<span id="cb91-914"><a href="#cb91-914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-915"><a href="#cb91-915" aria-hidden="true" tabindex="-1"></a>For owl limpets specifically:</span>
<span id="cb91-916"><a href="#cb91-916" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*Lottia gigantea* is well known for **territorial grazing** that can maintain “gardens” of microalgae and influence space availability and algal cover (citations).  </span>
<span id="cb91-917"><a href="#cb91-917" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What else?</span>
<span id="cb91-918"><a href="#cb91-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-919"><a href="#cb91-919" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2) Limpet presence effects on community composition (expected directions)</span></span>
<span id="cb91-920"><a href="#cb91-920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-921"><a href="#cb91-921" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>fill in</span>
<span id="cb91-922"><a href="#cb91-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-923"><a href="#cb91-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-924"><a href="#cb91-924" aria-hidden="true" tabindex="-1"></a>**Season interactions** are common because:</span>
<span id="cb91-925"><a href="#cb91-925" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>why?</span>
<span id="cb91-926"><a href="#cb91-926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-927"><a href="#cb91-927" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-928"><a href="#cb91-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-929"><a href="#cb91-929" aria-hidden="true" tabindex="-1"></a><span class="fu">### potenitial storyline</span></span>
<span id="cb91-930"><a href="#cb91-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-931"><a href="#cb91-931" aria-hidden="true" tabindex="-1"></a>**“Seasonal dynamics modulate the engineering role of a territorial grazer.”**</span>
<span id="cb91-932"><a href="#cb91-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-933"><a href="#cb91-933" aria-hidden="true" tabindex="-1"></a><span class="fu">### Journals to think about</span></span>
<span id="cb91-934"><a href="#cb91-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-935"><a href="#cb91-935" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*Marine Ecology Progress Series* (MEPS)</span>
<span id="cb91-936"><a href="#cb91-936" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*Journal of Experimental Marine Biology and Ecology*</span>
<span id="cb91-937"><a href="#cb91-937" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*PeerJ*</span>
<span id="cb91-938"><a href="#cb91-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-939"><a href="#cb91-939" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb91-940"><a href="#cb91-940" aria-hidden="true" tabindex="-1"></a></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>