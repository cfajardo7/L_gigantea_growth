---
title: "Chapter_1_Master"
author: "Cindy Fajardo"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning = FALSE,
                      message = FALSE,
                      fig.path = "../Output/")
```

#Welcome
This Rmarkdown file will be used for the first chapter of my Master's thesis. You will find data manipulation, visualizations, and statistical analysis of data that I collected on the owl limpet population found at Cabrillo National Monument Zone 3 from September 2023- June 2024. The following ecological/biological concepts that are covered are

- Seasonal Growth Rates

- Seasonal Changes in Population Distribution

- Seasonal Changes in Population Density

- Seasonal changes in local community composition in presence/absence of central owl limpet

Below you will find the data frames that I used. Enjoy!

#Libraries
But first, lets load the libraries I used/have stored here for easy convenience
```{r, Libraries}
library("rerddap")
library(tidyverse)
library("tidync")
library("doParallel")
library(lubridate)
library(patchwork)
library(viridis)
library(here)
library(kableExtra)
library(hrbrthemes)
library(emmeans)
library(agricolae)
library(vegan)
library(performance)
library(broom)
library(car)
library(lme4)
library(lmerTest)
library(pscl)
library(ggridges)
library(devtools)
#library(pairwiseAdonis)
library(FSA)
library(see)
library(RColorBrewer)

```

# Read in CSV
In this chunk, I am reading in the csv's that are relevant to growth and community survey data ONLY
```{r, Read in CSV}
master_sl <- read_csv(here("Data","Master_CNM_OL_SL_Data.csv")) %>%
  filter(!Plot_Name %in% c("CNM_7", "CNM_8" )) %>% #filtered out transects not found in all seasons, do %in% to other lines
mutate(sex=ifelse(SL_mm>= 50, "female", "male"))

sess_percentcover <- read_csv(here("Data", "Master_CNM_Sessile_Percent_Data.csv")) %>%
  filter(!Transect%in% c("CNM_7", "CNM_8")) #filtered out transects not found in all seasons

mobiles_master <- read.csv(here("Data", "Master_CNM_Mobile_Data.csv")) %>%
  filter(!Transect %in% c("CNM_7", "CNM_8")) #filtered out transects not found in all seasons

mobiles_matrix_master <- read.csv(here("Data", "Master_CNM_Mobile_Matrix.csv")) %>%
  filter(!Transect %in% c("CNM_7", "CNM_8")) #filtered out transects not found in all seasons

sessile_matrix_master <- read.csv(here("Data", "Master_CNM_Sessile_Matrix.csv")) %>%
  filter(!Transect %in% c("CNM_7", "CNM_8")) #filtered out transects not found in all seasons

cabrillo_yearly_lim_size <- read_csv(here("Data", "yearly_lim_size.csv")) 

master_temperature_data <- read.csv(here("Data", "Logger_CNM_2_2023_10_01__2024_06_10.csv"))

```

# Seasonal Growth Rates
I'll start off with seasonal growth rates. Unfortunately, I continuously got negative rates, meaning there was some type of human error when measuring limpets shell length. But for transparency reasons, I will still show the data and the code.

# Population Average Growth rate of Tagged Limpets from September to February
```{r, Growth rate of Tagged Limpets from September to February}
fall_win_growth_data_sex <- master_sl %>% #calling master shell length data
  filter(Tag_ID != "0", #filtered out un-tagged limpets
        Season %in% c("Winter", "Fall"),
        Date != "2023_12_10") %>% #filtered out non-winter or non- fall data
  mutate(Date = ymd(Date)) %>% #This will give me true date
  group_by(sex, Tag_ID) %>% #grouped them by sex
  reframe(limpet_growth = (SL_mm[Season=="Winter"]-SL_mm[Season=="Fall"])/(as.numeric(Date[Season == "Winter"]-Date[Season=="Fall"]))*30) %>%  #this is to get true growth rate using dates calculated from lubridate then mulitplied by 30 to get growth per month
  #reframe(limpet_growth = (SL_mm[Season=="Winter"]-SL_mm[Season=="Fall"])/4.75) %>% 
  left_join(master_sl %>% #this is to keep original length for fall
              filter(Tag_ID!="0",
                     Season=="Fall") %>% 
              select(Tag_ID,SL_mm, Season))

fall_win_growth_plot <- ggplot(fall_win_growth_data_sex, aes(x=SL_mm,
                        y = limpet_growth,
                        color = sex))+
         geom_point()+ #to have continuous x and continuous y
  labs(title = "Limpet Growth From September 2023-Februray 2024",
       x = "Shell Length",
       y = "Limpet Growth")+
  theme_ipsum_pub()

fall_win_growth_plot
```

# Population Average Growth rate of Tagged Limpets from February to June
This does not include March re-tagging event. After I join the master back to the data frame, all of the males disappear. I'm not sure why.
```{r, Population Average Growth rate of Tagged Limpets from February to June}
win_spr_growth_data_sex <- master_sl %>%
  filter(Tag_ID!="0",
         Season %in% c("Late_Spring", "Winter"),
         Date != "2023_12_10") %>% 
  mutate(Date = ymd(Date)) %>% #This will give me true date
  group_by(sex, Tag_ID) %>%
  reframe(limpet_growth = (SL_mm[Season=="Winter"]-SL_mm[Season=="Late_Spring"])/(as.numeric(Date[Season == "Winter"]-Date[Season=="Late_Spring"]))*30) %>%  #this is to get true growth rate using dates calculated from lubridate then mulitplied by 30 to get growth per month
  #reframe(limpet_growth = (SL_mm[Season=="Winter"]-SL_mm[Season=="Late_Spring"])/4.75) %>% #In this line of code all of the males disappear. I think this is happening because the tagged male limpets that were found were the ones tagged in the retagging event in early spring but the data is not being used. Only female tagged limpets that had been tagged in the original tagging even in September were found.
  left_join(master_sl %>% 
              filter(Tag_ID!="0",
                     Season=="Late_Spring") %>% 
              select(Tag_ID,SL_mm, Season)) #most values are negative

win_spr_growth_plot <- ggplot(win_spr_growth_data_sex, aes(x=SL_mm,
                        y = limpet_growth,
                        color = sex))+
         geom_point()+
  labs(title = "Limpet Growth From February 2024-June 2024",
       x = "Shell Length",
       y = "Limpet Growth")+
  theme_ipsum_pub()
win_spr_growth_plot
#all of the males disappear from the data because the males that were tagged in the Fall may have dissapeared, the tag fell off, or they moved to a location out of the transect or view. I'm considering looking at the "spring" data which is the re-tagging event that happened in March 2024.
```

# Complete Growth Data
```{r, Complete Growth Data}
complete_growth <- bind_rows(fall_win_growth_data_sex, win_spr_growth_data_sex)

comp_growth_scatter <- complete_growth %>% 
          filter(SL_mm > 50,
                 SL_mm < 72) %>%
  mutate(growth_zero = ifelse(limpet_growth<0, 0, limpet_growth)) %>% 
          ggplot(aes(x = SL_mm,
                   y = growth_zero))+
  geom_point(aes(color = Season))+
  geom_smooth(method = "glm", family = gaussian(link ="log")) #exponential decline
              #formula = "y~I(log(x))") #this adds a quadratic function

comp_growth_scatter

```

# ANCOVA For Growth Data
```{r}
complete_growth %>% 
          filter(SL_mm > 50)
comp_growth_mod <- lmer(limpet_growth~poly(SL_mm,2)*Season+(1|Tag_ID), data = complete_growth %>% #want to keep this
          filter(SL_mm > 50,
                 SL_mm < 72))
check_model(comp_growth_mod)
ggsave(here("Output", "Growth_Check_Model.png"))
anova(comp_growth_mod)
summary(comp_growth_mod)

lm_growth <- lm(limpet_growth~poly(SL_mm,2)*Season, data = complete_growth %>% 
          filter(SL_mm > 50))
check_model(lm_growth)
anova(lm_growth)
```



# Re-tagging event
Here I am looking at data between the re-tagging event and the late spring data collection. I only did density this far that is why i am dividing n by 50 not twenty
```{r, Look at later}
#Density?
Spring_Density_Data <- master_sl %>%
  filter(!Season %in% c("Winter", "Fall"),
         Date!="2023_12_10") %>% 
   group_by(Season, Plot_Name)%>%
   count()%>%
   mutate(limpet_density_m2 = n/50)
   
winter_spring_dens_plot <- ggplot(Spring_Density_Data, 
       aes(x=Plot_Name,
           y=limpet_density_m2,
           color=Season))+
  geom_point()+
  scale_color_brewer(palette = "Set1")
winter_spring_dens_plot

 
 # run model for dependent variable ~ independent, then for normality, etc, interpret model
mod_density_winter_spring <-lm(limpet_density_m2~Season, data = Spring_Density_Data)
check_model(mod_density_winter_spring)
anova(mod_density_winter_spring) 
summary(mod_density_winter_spring)

```

# Seasonal Population Distribution
In this section, I will start the seasonal population distribution

# Fall Distribution
```{r, Fall Distribution}
Fall_data <- master_sl %>% 
  select(Season, Date, Plot_Name, SL_mm, Tag_ID, sex) %>% 
  filter(Season=="Fall")

Fall_SL_mean <- mean(Fall_data$SL_mm)

max(Fall_data$SL_mm)
min(Fall_data$SL_mm)

median(Fall_data$SL_mm)

sep_cnm_pop_density <- Fall_data %>% #calling df with shell length data 
  ggplot( aes(x=SL_mm)) + #Sl on x, I am not selecting y so R can use limpet count for density plot
  geom_histogram(fill="purple",#color of bars
           colour="black",#color of bar outline
           alpha= 1,#transparency of bar
           binwidth = 5)+#size of bin
  labs(title = "Shell Length Distribution in Fall 2023",
       x = "Shell Length (mm)",
       y = "Owl Limpet Count")+
  theme(axis.title.y = element_blank(),
        axis.title.x = element_text(size = 10),
        axis.text.x = element_text(size = 9),
        axis.text.y = element_blank())+
  scale_x_continuous(limits = c(0,90))+ #lines I want to show up on x axis
  scale_y_continuous(limits = c(0,220))+ #lines I want to show up on y axis
  geom_vline(xintercept = mean(Fall_data$SL_mm),
             colour="green")+ #draw line where average lies on density
  theme_bw()+
  facet_wrap(~Plot_Name)
 sep_cnm_pop_density
```



# Winter Distribution
When I attempt to use geom_bar with scale_x and scale_y continous, it ommits data at certain Shell lenghts 
```{r, Winter Distribution}
Winter_data <- filter(master_sl, Season == "Winter",
                      Date != "2023_12_10")

Winter_SL_mean <- mean(Winter_data$SL_mm)

max(Winter_data$SL_mm)
min(Winter_data$SL_mm)

median(Winter_data$SL_mm)

Winter_pop_density <- Winter_data %>%
  ggplot( aes(x=SL_mm)) + #Sl on x, I am not selecting y so R can use limpet count for density plot
  geom_histogram(fill="blue",#color of bars
           colour="black",#color of bar outline
           alpha= 1, #transparency of bar 
           binwidth = 5)+ #bin size 
  labs(title = "Shell Length Distribution in Winter 2024",
         x = "Shell Length (mm)",
       y = "Owl Limpet Count")+
  theme(axis.title.y = element_blank(),
        axis.title.x = element_text(size = 10),
        axis.text.x = element_text(size = 9),
        axis.text.y = element_blank())+
  scale_x_continuous(limits = c(0,90))+ #lines I want to show up on x axis
  scale_y_continuous(limits = c(0,220))+ #lines I want to show up on y axis
  geom_vline(xintercept = mean(Winter_data$SL_mm),
             colour="green")+ #draw line where average lies on density
  theme_bw()+
  facet_wrap(~Plot_Name)
  
 Winter_pop_density
```

# Spring Distribution
```{r, Spring Distribution}
Spring_data <- filter(master_sl, Season == "Late_Spring")

Spring_SL_mean <- mean(Spring_data$SL_mm)

max(Spring_data$SL_mm)
min(Spring_data$SL_mm)

median(Spring_data$SL_mm)

spring_pop_density <- Spring_data %>% #calling df with shell length data
  ggplot( aes(x=SL_mm)) + #Sl on x, I am not selecting y so R can use limpet count for density plot
  geom_histogram(fill="pink",#color of bars
           colour="black",#color of bar outline
           alpha= 1,#transparency of bar
           binwidth = 5) + #size of bars
  labs(title = "Shell Length Distribution in Spring 2024",
       x = "Shell Length (mm)",
       y = "Owl Limpet Count")+
  theme(axis.title.y = element_blank(),
        axis.title.x = element_text(size = 10),
        axis.text.x = element_text(size = 9),
        axis.text.y = element_blank())+
  scale_x_continuous(limits = c(0,90))+
  scale_y_continuous(limits = c(0,220))+
  geom_vline(xintercept = mean(Spring_data$SL_mm),
             colour="green")+ #draw line where average lies on density
  theme_bw()+
  facet_wrap(~Plot_Name)
 spring_pop_density
```


# Population Shell Length Distribution Data of All Seasons
```{r, Analyis of Population Density Data of All Seasons}
#Data Manipulation
size_dist_all_seasons <-master_sl %>% 
  filter(Season!="Spring",
         Date!="2023_12_10")


anova_results <- aov(mean_sl ~ Season, data = shell_lenght_mean_per_seas)
summary(anova_results)
anova(anova_results)


all_seasons_sl_boxplot <- ggplot(size_dist_all_seasons,
                                   aes(x=Season,
                                       y=SL_mm,
                                       fill=Season))+
  geom_boxplot(width = 0.7,
               show.legend = FALSE)+
  labs(title = "Shell Length Distribution of Owl Limpets per Season",
       x = "Season",
       y ="Shell Length")+
  scale_y_continuous(breaks = c(20,30,40,50,60,70,80,90))+
  scale_x_discrete(labels=c("Fall","Winter","Spring"))+
  #scale_color_brewer(palette = "Set2")+
  scale_fill_brewer(palette = "Set3")+
  theme_bw()
all_seasons_sl_boxplot
```

# Median graph
```{r}
shell_lenght_stats_per_seas <- size_dist_all_seasons %>% 
  group_by(Season) %>% 
  summarise(mean_sl = mean(SL_mm),
            var_sl = var(SL_mm),
            sd_sl = sd(SL_mm),
            n_sl= n(),# Get the sample size for the group
            se_sl = sd_sl / sqrt(n_sl),
            med_sl = median(SL_mm),
            min_sl = min(SL_mm),
            max_sl = max(SL_mm)) %>% 
  mutate(Seasons = as.factor(Season))

sl_med_SE <- ggplot(shell_lenght_stats_per_seas,
                    aes(x = Seasons,
                        y = med_sl))+
  geom_point(show.legend = FALSE)+
  geom_errorbar(aes(ymin = mean_sl - sd_sl, ymax = mean_sl + sd_sl),
                   width = 0.2)+ # Adds the error bars
  labs(title = "Median and Standard Error  of Shell Length Distribution",
       x = "Season",
       y ="Shell Length")+
  scale_x_discrete(labels=c("Fall","Spring","Winter"))+
  #scale_colour_brewer(palette = "Set3")+
  theme_bw()
sl_med_SE
```

# Analysis of Shell Length Distribution For all seasons
Here I begin the analysis of the shell length distribution to see if they're significantly different between seasons.
```{r}
#models
SL_dis_mod <- kruskal.test(SL_mm~Season, data=size_dist_all_seasons)
check_model(SL_dis_mod) #this disn't work, I got this error
#Error: `check_model()` returned following error: Can't extract variance-covariance matrix. `get_varcov()` returned following
  #error: no applicable method for 'vcov' applied to an object of class "htest"
  #If the error message does not help identifying your problem, another reason why `check_model()` failed might be that
  #models of class `htest` are not yet supported.


shapiro.test(size_dist_all_seasons$SL_mm)
pairwise.wilcox.test(size_dist_all_seasons$SL_mm, size_dist_all_seasons$Season,
                 p.adjust.method = "BH")
dunnTest(SL_mm~Season,
         size_dist_all_seasons,
         method="bonferroni")

log_size_dist_all_seasons <-master_sl %>% 
  filter(Season!="Spring",
         Date!="2023_12_10") %>% 
  mutate(log_sl= log(SL_mm),
         sqr_sl= sqrt(SL_mm))

qqnorm(log_size_dist_all_seasons$log_sl)

#lmer
sl_lmer<-lmer(sqr_sl~Season+(1|Plot_Name), data = log_size_dist_all_seasons)
check_model(sl_lmer)
summary(sl_lmer)

#glmer with family gamma because shell length is continuous
sl_glm<-glmer(SL_mm~Season+(1|Plot_Name), data = log_size_dist_all_seasons, 
             family = Gamma(link="log"))
check_model(sl_glm)
anova(sl_glm)
summary(sl_glm)





#####################
scatter_full <- ggplot(size_dist_all_seasons,
                       aes(x=Season,
                           y=SL_mm))+
  geom_point()+
  geom_smooth(method="lm")+
  facet_wrap(~Season)#regression line, add method = lm 
scatter_full
```

# Post_hoc test for Shell Length Distributions
```{r, Post_hoc test for Shell Length Distributions}
#Post hoc tests
emmeans(sl_glm, list(pairwise~Season), adjust = "tukey")
```


# Population Density
In this section I will look at the population density throughout the seasons and their statistical analysis. 
```{r, Population Density}
all_seasons_Density_Data <- master_sl %>%
   filter(Season!="Spring", #not including re-tagging event
          Date!="2023_12_10")  %>% #not including December
   group_by(Season, Plot_Name) %>% 
   count()%>%
   mutate(limpet_density_m2 = n/20) %>% 
  mutate(Plot = as.factor(Plot_Name)) %>% 
  mutate(log_density = log(limpet_density_m2),
         Seasons = as.factor(Season))

all_seasons_density_plot <- ggplot(all_seasons_Density_Data,
                                   aes(x=Season,
                                       y=log_density,
                                       fill=Season))+
  geom_boxplot(show.legend = FALSE)+
  labs(title = "Owl Limpet Density for All Seasons",
       x = "Season",
       y ="Log Owl Limpet Density/m2")+
  scale_x_discrete(labels=c("Fall","Winter","Spring"))+
  scale_fill_brewer(palette = "Dark2")+
  theme_bw()
  
all_seasons_density_plot  
```

# Linear mixed effects model for population density
```{r, Linear mixed effects model for population density}

# run model for dependent variable ~ independent, then for normality, etc, interpret model
mod_density_all_seasons <-lmer(log_density~Season+(1|Plot), data = all_seasons_Density_Data)
check_model(mod_density_all_seasons)
anova(mod_density_all_seasons)
summary(mod_density_all_seasons)


#i'm going to stick to the generalized mixed effects model because the data is not normally distributed.
#glmm
density_glmm <- glmer(limpet_density_m2 ~ Season + (1 |Plot), 
                    data = all_seasons_Density_Data, 
                    family = Gamma(link = "log"))
check_model(density_glmm)
anova(density_glmm)
summary(density_glmm)


```
# Post Hoc test for population density
```{r}
#Post hoc tests
emmeans(density_glmm, list(pairwise~Season), adjust = "tukey")
```

# Plots for Owl Limper Abundance
```{r, Plots for Owl Limper Abundance}
all_seasons_abundance_Data <- master_sl %>%
   filter(Season!="Spring", #not including re-tagging event
          Date!="2023_12_10")  %>% #not including December
   group_by(Season, Plot_Name) %>% 
   count() %>% 
  mutate(Plot = as.factor(Plot_Name)) %>% 
  mutate(log_abundance = log(n),
          Seasons = as.factor(Season))

all_seasons_abundance_plot <- ggplot(all_seasons_abundance_Data,
                                   aes(x=Season,
                                       y=log_abundance,
                                       fill=Season))+
  geom_boxplot(show.legend = FALSE)+
  labs(title= "Owl Limpet Population Abundance for All Seasons",
       x = "Season",
       y ="Log Owl Limpet Abundance")+
  scale_x_discrete(labels=c("Fall","Winter","Spring"))+
  scale_fill_brewer(palette = "Accent")+
  theme_bw()
  
all_seasons_abundance_plot
```


# Linear models for Owl limpets Abundance per season
```{r, Linear models for Owl limpets Abundance per season}

linear_abundance <-master_sl %>%
   filter(Season!="Spring", #not including re-tagging event
          Date!="2023_12_10")  %>% #not including December
   group_by(Season, Plot_Name) %>% 
   count() 

abun_mod <- kruskal.test(n~Season, data=linear_abundance)
dunnTest(n~Season,
         linear_abundance,
         method="bonferroni")

shapiro.test(linear_abundance$abun)

#mixed effects linear regressions
mod_abundance_all_seasons <-lmer(n~Season+(1|Plot_Name), data = linear_abundance)
check_model(mod_abundance_all_seasons)
anova(mod_abundance_all_seasons)
summary(mod_abundance_all_seasons)

#Post hoc tests
emmeans(mod_abundance_all_seasons, list(pairwise~Season), adjust = "tukey")

#using glmer because i am using transect as a random effect. I am using poisson distribution with log link because data is not normally distributed, even after transforming
#glmm
abun_per_seas_tran <-glmer(n~Season+(1|Plot_Name), data = linear_abundance,family = poisson(link = "log"))
check_model(abun_per_seas_tran)
anova(abun_per_seas_tran)
summary(mod_abundance_all_seasons)

```

# Post Hoc test for Owl Limpet Abundance
```{r, Post Hoc test for Owl Limpet Abundance}
#Post hoc test
emmeans(abun_per_seas_tran, list(pairwise~Season), adjust = "tukey")
```


# MANOVA or perMANOVA of Seasons x Shell Length, Density, Abundance
```{r, MANOVA}

average_data <-master_sl %>% 
  filter(Season!="Spring",
         Date!="2023_12_10") %>% 
  group_by(Season, Plot_Name)

manova_data <-master_sl %>%
   filter(Season!="Spring", #not including re-tagging event
          Date!="2023_12_10") %>% #not including December
   group_by(Season, Plot_Name)%>% 
   count()%>%
   mutate(limpet_density_m2 = n/20) %>% 
  mutate(Plot = as.factor(Plot_Name)) %>% 
  mutate(log_density = log(limpet_density_m2)) %>% 
  ungroup() %>% 
  group_by(Season) %>% 
  mutate(abun = sum(n)) %>% 
  ungroup() %>% 
  group_by(Season, Plot_Name) %>% 
  mutate(SL_avg = mean(average_data$SL_mm))
  
  
  left_join(size_dist_all_seasons, by="Plot_Name") %>% 
  group_by(Season.x, Plot) %>% 
  mutate(SL_avg = mean(SL_mm))


```


# Cabrillo Yearly Data
This Data came from Lauren Pandori. This data in the owl limpet size recorded in all zones from 1990-2021. In this manipulation, I filtered for only Zone III data since I worked in Zone III. I am attempting to see if the there is a dip in the count data at a specific size frame that matches or closely matches my data to see if there is a pattern in size distribution. 
```{r, Cabrillo Yearly Data}
CNM_ZThree__yearly_data <- cabrillo_yearly_lim_size %>%
  filter(zone=="Zone III") %>%
  group_by(survey_year, season_name) %>% 
  reframe(size=rep(size_class,n)) #%>% 
  #filter(survey_year=="1990") this will filter per year to see if there is a dip like my data

CNM_ZThree__yearly_data %>% 
  ggplot(aes(x = size))+
  geom_histogram()+
  facet_wrap(~survey_year)

#Use this to look at Cabrillo Data Per Year 
CNM_ZThree_per_year_data <- CNM_ZThree__yearly_data%>%
  filter(survey_year=="2021") #change this to match the year you are looking for

CNM_ZThree_per_year_data %>% 
  ggplot(aes(x = size))+
  geom_histogram()

dip_CNM_ZThree_per_year_data <- CNM_ZThree__yearly_data %>% 
  filter(survey_year %in% c("1991","1995","1996","1997","1998","2002","2003","2005","2006","2007","2008","2009","2010","2011","2013","2015","2016","2020","2021"))#change this to match the year you are looking for

dip_CNM_ZThree_per_year_data %>% 
  ggplot(aes(x = size))+
  geom_histogram()+
  facet_wrap(~survey_year)
```

# Community Survey Data Manipulation
```{r, Mobile Data Manipulation}
#lets start with manipulating mobile data. I need to make the mobile data sheet long and add another column specifying the functionality of the mobile organism (herbivore, carnivore)

long_mobiles <- mobiles_master %>% 
  pivot_longer(cols = M_lugubris:L_gigantea,
               names_to = "species",
               values_to = "count") %>% 
  mutate(species = as.factor(species)) %>% 
  mutate(functionality = case_when(
  species %in% "M_lugubris" ~ "predator",
  species %in% "L_hartwegii" ~ "macrograzer",
  species %in%  "L_dentiens" ~ "macrograzer",
  species %in%  "L_plena" ~ "mesograzer",
  species %in%  "L_keenae" ~ "mesograzer",
  species %in%  "L_limatula" ~ "macrograzer",
  species %in%  "L_scabra" ~ "macrograzer",
  species %in%  "Nuttallina_sp" ~ "macrograzer",
  species %in%  "Mopalia_sp" ~ "mesograzer",
  species %in%  "P_crassipes" ~ "omnivore",
  species %in%  "T_eiseni" ~ "mesograzer",
  species %in%  "T_funebralis" ~ "mesograzer",
  species %in%  "T_gallina" ~ "mesograzer",
  species %in%  "L_gigantea" ~ "mesograzer"))


```

# Temperature Data
```{r, Temperature data}
temperature_by_season <-master_temperature_data %>% 
  group_by(Season)%>% 
  separate(Date_Time, into = c("date_col", "time_col"), sep = " ", remove = FALSE) %>% 
  summarise(mean_temp = mean(Temperature.C, na.rm = TRUE),
            max_temp = max(Temperature.C, na.rm = TRUE),
            min_temp = min(Temperature.C, na.rm = TRUE)) 

ggplot(temperature_by_season, aes(x =date_col, y = Temperature.C))+
  geom_line()+
  geom_point(aes(color = Season))
```

