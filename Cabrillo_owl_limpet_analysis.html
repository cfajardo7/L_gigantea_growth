<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nyssa/Cindy">
<meta name="dcterms.date" content="2025-12-20">

<title>Cabrillo National Monument: Owl limpet seasonality and community effects</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Cabrillo_owl_limpet_analysis_files/libs/clipboard/clipboard.min.js"></script>
<script src="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/quarto.js"></script>
<script src="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/popper.min.js"></script>
<script src="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/anchor.min.js"></script>
<link href="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Cabrillo_owl_limpet_analysis_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Cabrillo_owl_limpet_analysis_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Cabrillo_owl_limpet_analysis_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Cabrillo_owl_limpet_analysis_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<link href="Cabrillo_owl_limpet_analysis_files/libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">

<script src="Cabrillo_owl_limpet_analysis_files/libs/pagedtable-1.1/js/pagedtable.js"></script>



</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">1</span> Overview</a>
  <ul class="collapse">
  <li><a href="#design-assumptions-and-why-they-matter" id="toc-design-assumptions-and-why-they-matter" class="nav-link" data-scroll-target="#design-assumptions-and-why-they-matter"><span class="header-section-number">1.1</span> Design assumptions and why they matter</a></li>
  </ul></li>
  <li><a href="#packages-and-helpers" id="toc-packages-and-helpers" class="nav-link" data-scroll-target="#packages-and-helpers"><span class="header-section-number">2</span> Packages and helpers</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data"><span class="header-section-number">3</span> Import data</a></li>
  <li><a href="#data-cleaning-and-harmonization" id="toc-data-cleaning-and-harmonization" class="nav-link" data-scroll-target="#data-cleaning-and-harmonization"><span class="header-section-number">4</span> Data cleaning and harmonization</a></li>
  <li><a href="#question-1-do-limpet-density-and-size-change-by-season" id="toc-question-1-do-limpet-density-and-size-change-by-season" class="nav-link" data-scroll-target="#question-1-do-limpet-density-and-size-change-by-season"><span class="header-section-number">5</span> Question 1: Do limpet density and size change by season?</a>
  <ul class="collapse">
  <li><a href="#a.-density-true-density-transect-area-50-m²" id="toc-a.-density-true-density-transect-area-50-m²" class="nav-link" data-scroll-target="#a.-density-true-density-transect-area-50-m²"><span class="header-section-number">5.1</span> 1A. Density (true density; transect area = 50 m²)</a></li>
  <li><a href="#b.-size-sl_mm-by-season" id="toc-b.-size-sl_mm-by-season" class="nav-link" data-scroll-target="#b.-size-sl_mm-by-season"><span class="header-section-number">5.2</span> 1B. Size (<code>sl_mm</code>) by season</a></li>
  </ul></li>
  <li><a href="#question-2-does-limpet-presence-affect-community-composition-and-does-it-interact-with-season" id="toc-question-2-does-limpet-presence-affect-community-composition-and-does-it-interact-with-season" class="nav-link" data-scroll-target="#question-2-does-limpet-presence-affect-community-composition-and-does-it-interact-with-season"><span class="header-section-number">6</span> Question 2: Does limpet presence affect community composition, and does it interact with season?</a></li>
  <li><a href="#a.-mobile-invertebrates-counts" id="toc-a.-mobile-invertebrates-counts" class="nav-link" data-scroll-target="#a.-mobile-invertebrates-counts"><span class="header-section-number">7</span> 2A. Mobile invertebrates (counts)</a>
  <ul class="collapse">
  <li><a href="#identify-species-columns" id="toc-identify-species-columns" class="nav-link" data-scroll-target="#identify-species-columns"><span class="header-section-number">7.1</span> Identify species columns</a></li>
  <li><a href="#transformations-for-multivariate-analyses" id="toc-transformations-for-multivariate-analyses" class="nav-link" data-scroll-target="#transformations-for-multivariate-analyses"><span class="header-section-number">7.2</span> Transformations for multivariate analyses</a></li>
  <li><a href="#permanova-adonis2-with-permutations-constrained-by-transect" id="toc-permanova-adonis2-with-permutations-constrained-by-transect" class="nav-link" data-scroll-target="#permanova-adonis2-with-permutations-constrained-by-transect"><span class="header-section-number">7.3</span> PERMANOVA (adonis2) with permutations constrained by transect</a></li>
  <li><a href="#check-dispersion-permdisp" id="toc-check-dispersion-permdisp" class="nav-link" data-scroll-target="#check-dispersion-permdisp"><span class="header-section-number">7.4</span> Check dispersion (PERMDISP)</a></li>
  <li><a href="#ordination-nmds-visualize-patterns" id="toc-ordination-nmds-visualize-patterns" class="nav-link" data-scroll-target="#ordination-nmds-visualize-patterns"><span class="header-section-number">7.5</span> Ordination: NMDS (visualize patterns)</a></li>
  <li><a href="#univariate-summaries-total-abundance" id="toc-univariate-summaries-total-abundance" class="nav-link" data-scroll-target="#univariate-summaries-total-abundance"><span class="header-section-number">7.6</span> Univariate summaries (total abundance)</a></li>
  </ul></li>
  <li><a href="#sessile-community-cover-proportional-cover" id="toc-sessile-community-cover-proportional-cover" class="nav-link" data-scroll-target="#sessile-community-cover-proportional-cover"><span class="header-section-number">8</span> Sessile community (% cover / proportional cover)</a>
  <ul class="collapse">
  <li><a href="#identify-sessile-cover-columns-i-dont-trust-this-analysis-rn" id="toc-identify-sessile-cover-columns-i-dont-trust-this-analysis-rn" class="nav-link" data-scroll-target="#identify-sessile-cover-columns-i-dont-trust-this-analysis-rn"><span class="header-section-number">8.1</span> Identify sessile cover columns — i dont trust this analysis rn</a></li>
  <li><a href="#multivariate-test-permanova-on-gower" id="toc-multivariate-test-permanova-on-gower" class="nav-link" data-scroll-target="#multivariate-test-permanova-on-gower"><span class="header-section-number">8.2</span> Multivariate test: PERMANOVA on gower</a></li>
  <li><a href="#dispersion-check" id="toc-dispersion-check" class="nav-link" data-scroll-target="#dispersion-check"><span class="header-section-number">8.3</span> Dispersion check</a></li>
  <li><a href="#ordination-nmds" id="toc-ordination-nmds" class="nav-link" data-scroll-target="#ordination-nmds"><span class="header-section-number">8.4</span> Ordination: NMDS</a></li>
  <li><a href="#univariate-analyses-for-key-functional-groups" id="toc-univariate-analyses-for-key-functional-groups" class="nav-link" data-scroll-target="#univariate-analyses-for-key-functional-groups"><span class="header-section-number">8.5</span> Univariate analyses for key functional groups</a></li>
  </ul></li>
  <li><a href="#ecological-interpretation-how-to-read-results-fill-in-below-with-your-references" id="toc-ecological-interpretation-how-to-read-results-fill-in-below-with-your-references" class="nav-link" data-scroll-target="#ecological-interpretation-how-to-read-results-fill-in-below-with-your-references"><span class="header-section-number">9</span> Ecological interpretation (how to read results – fill in below with your references)</a>
  <ul class="collapse">
  <li><a href="#seasonal-density-and-size-patterns-whats-plausible" id="toc-seasonal-density-and-size-patterns-whats-plausible" class="nav-link" data-scroll-target="#seasonal-density-and-size-patterns-whats-plausible"><span class="header-section-number">9.1</span> 1) Seasonal density and size patterns (what’s plausible)</a></li>
  <li><a href="#limpet-presence-effects-on-community-composition-expected-directions" id="toc-limpet-presence-effects-on-community-composition-expected-directions" class="nav-link" data-scroll-target="#limpet-presence-effects-on-community-composition-expected-directions"><span class="header-section-number">9.2</span> 2) Limpet presence effects on community composition (expected directions)</a></li>
  <li><a href="#potenitial-storyline" id="toc-potenitial-storyline" class="nav-link" data-scroll-target="#potenitial-storyline"><span class="header-section-number">9.3</span> potenitial storyline</a></li>
  <li><a href="#journals-to-think-about" id="toc-journals-to-think-about" class="nav-link" data-scroll-target="#journals-to-think-about"><span class="header-section-number">9.4</span> Journals to think about</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Cabrillo National Monument: Owl limpet seasonality and community effects</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">A mix of univariate of multivariate statistics to test seasonality in both limpet size/density and community responses</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Nyssa/Cindy </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 20, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="overview" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="overview"><span class="header-section-number">1</span> Overview</h2>
<p>This Quarto notebook analyzes three datasets from <strong>Cabrillo National Monument (San Diego, CA)</strong> to answer:</p>
<ol type="1">
<li><strong>Seasonality in owl limpets (<em>Lottia gigantea</em>)</strong>
<ul>
<li>Does <strong>density</strong> change by <strong>Season</strong>?</li>
<li>Does <strong>size</strong> (shell length, <code>SL_mm</code>) change by <strong>Season</strong>?</li>
</ul></li>
<li><strong>Community consequences of limpet presence</strong>
<ul>
<li>Does <strong>owl limpet presence</strong> (<code>COL_pres</code>) affect:
<ul>
<li><strong>Mobile invertebrate composition</strong> (counts)?</li>
<li><strong>Sessile cover composition</strong> (% cover / proportional cover)?</li>
</ul></li>
<li>Are there <strong>interactions with Season</strong>?</li>
</ul></li>
</ol>
<section id="design-assumptions-and-why-they-matter" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="design-assumptions-and-why-they-matter"><span class="header-section-number">1.1</span> Design assumptions and why they matter</h3>
<ul>
<li>The datasets include repeated sampling across <strong>Transects</strong> and/or <strong>Plots</strong>, so we:
<ul>
<li>use <strong>mixed models</strong> with <strong>random intercepts</strong> for spatial sampling units (e.g., <code>Transect</code>, or <code>Plot_Name</code>),</li>
<li>and constrain permutations by transect for multivariate tests.</li>
</ul></li>
<li><strong>Density</strong>:
<ul>
<li>The transect size was <strong>50 m²</strong> so I divided the counts by this value to get density per transect .</li>
</ul></li>
<li><strong>Community data</strong>:
<ul>
<li>Mobile inverts are <strong>counts</strong> (often overdispersed, zero-inflated).</li>
<li>Sessile “percent cover” is stored as <strong>proportions</strong> (0–1) in this dataset; we still treat it as compositional.</li>
</ul></li>
</ul>
<hr>
</section>
</section>
<section id="packages-and-helpers" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="packages-and-helpers"><span class="header-section-number">2</span> Packages and helpers</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Core</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)     <span class="co"># to clean the names for consistency</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed models</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)     <span class="co"># flexible GLMMs (NB, Gamma, etc.)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)        <span class="co"># LMMs (fallback)</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)     <span class="co"># estimated marginal means / contrasts</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostics</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)      <span class="co"># residual simulation diagnostics for GLMMs</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co"># assumption checks / R2 / collinearity</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co"># tidy() for mixed models</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Multivariate community ecology</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)       <span class="co"># adonis2, metaMDS, betadisper, envfit</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pairwiseAdonis) <span class="co"># optional; pairwise PERMANOVA if needed</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Figures</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)      <span class="co"># raincloud/half-eye</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)   <span class="co"># figure layouts</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)      <span class="co"># label_percent etc.</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="co"># A consistent plotting theme for a paper</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span> <span class="co"># base size text is 14</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper: safe logit transform for proportions in [0,1]</span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="co"># (useful for cover variables with 0s and 1s)</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>logit01 <span class="ot">&lt;-</span> <span class="cf">function</span>(p, <span class="at">eps =</span> <span class="fl">1e-4</span>) {</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(p, eps), <span class="dv">1</span> <span class="sc">-</span> eps)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qlogis</span>(p2)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="import-data" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="import-data"><span class="header-section-number">3</span> Import data</h2>
<blockquote class="blockquote">
<p><strong>Paths</strong> assume the files are in the same folder as this Quarto file, or are in the working directory. When you move this notebook to the scripts folder and the data files into your data folder, update paths below. Note, I edited these files to remove the transects removed in your other script and to just bring in the normalized community composition data</p>
</blockquote>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># File paths (edit if needed)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>path_size   <span class="ot">&lt;-</span> <span class="st">"limpet_size.csv"</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>path_mobile <span class="ot">&lt;-</span> <span class="st">"mobile_counts.csv"</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>path_sess   <span class="ot">&lt;-</span> <span class="st">"sessile_percent_cover.csv"</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>limpet_size_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_size, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="fu">ifelse</span>(season <span class="sc">==</span> <span class="st">"Late_Spring"</span>, <span class="st">"Spring"</span>, season)) <span class="co"># for some reason the season is named Late spring here, but spring everywhere else</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>mobile_raw      <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_mobile, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>sessile_raw     <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_sess, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(limpet_size_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 4,748
Columns: 8
$ season    &lt;chr&gt; "Fall", "Fall", "Fall", "Fall", "Fall", "Fall", "Fall", "Fal…
$ date      &lt;chr&gt; "2023_09_29", "2023_09_29", "2023_09_29", "2023_09_29", "202…
$ plot_name &lt;chr&gt; "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1…
$ plot_side &lt;chr&gt; "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", "R", …
$ limpet_no &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 1…
$ sl_mm     &lt;dbl&gt; 54, 53, 56, 66, 54, 48, 62, 62, 54, 49, 42, 49, 48, 51, 56, …
$ tag_id    &lt;chr&gt; "0", "0", "D006", "0", "0", "0", "0", "0", "0", "0", "0", "0…
$ sex       &lt;chr&gt; "female", "female", "female", "female", "female", "male", "f…</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mobile_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 240
Columns: 23
$ season        &lt;chr&gt; "Fall", "Fall", "Fall", "Fall", "Fall", "Fall", "Fall", …
$ date          &lt;chr&gt; "2023_09", "2023_09", "2023_09", "2023_09", "2023_09", "…
$ transect      &lt;chr&gt; "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1", "C…
$ plot_name     &lt;chr&gt; "CNM_1_E_1", "CNM_1_C_1", "CNM_1_E_2", "CNM_1_C_2", "CNM…
$ l_r           &lt;chr&gt; "L", "R", "R", "L", "L", "R", "R", "L", "L", "R", "L", "…
$ meter_no      &lt;dbl&gt; 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 8, 8, 10, 10, 2, 2, …
$ col_pres      &lt;chr&gt; "YES", "NO", "YES", "NO", "YES", "NO", "YES", "NO", "YES…
$ t_f           &lt;lgl&gt; TRUE, FALSE, TRUE, FALSE, TRUE, FALSE, TRUE, FALSE, TRUE…
$ tag_id        &lt;chr&gt; "D002", "0", "0", "0", "0", "0", "D003", "0", "0", "0", …
$ m_lugubris    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 1, 0,…
$ l_hartwegii   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ l_dentiens    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ l_plena       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ l_keenae      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ l_limatula    &lt;dbl&gt; 0, 0, 0, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 6, 0, 0,…
$ l_scabra      &lt;dbl&gt; 0, 0, 0, 0, 0, 4, 0, 5, 0, 2, 0, 1, 1, 0, 0, 0, 6, 1, 0,…
$ nuttallina_sp &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ mopalia_sp    &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ p_crassipes   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ t_eiseni      &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ t_funebralis  &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ t_gallina     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ l_gigantea    &lt;dbl&gt; 0, 1, 0, 1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 1, 6, 4, 1,…</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(sessile_raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 241
Columns: 18
$ season                    &lt;chr&gt; "Fall", "Fall", "Fall", "Fall", "Fall", "Fal…
$ date                      &lt;chr&gt; "2023_09", "2023_09", "2023_09", "2023_09", …
$ transect                  &lt;chr&gt; "CNM_1", "CNM_1", "CNM_1", "CNM_1", "CNM_1",…
$ plot_name                 &lt;chr&gt; "CNM_1_E_1", "CNM_1_C_1", "CNM_1_E_2", "CNM_…
$ l_r                       &lt;chr&gt; "L", "R", "R", "L", "L", "R", "R", "L", "L",…
$ meter_no                  &lt;dbl&gt; 1, 1, 2, 2, 3, 3, 4, 4, 5, 5, 6, 6, 8, 8, 10…
$ col_pres                  &lt;chr&gt; "Y", "N", "Y", "N", "Y", "N", "Y", "N", "Y",…
$ t_f                       &lt;lgl&gt; TRUE, FALSE, TRUE, FALSE, TRUE, FALSE, TRUE,…
$ tag_id                    &lt;chr&gt; "0", "0", "D002", "0", "0", "0", "D003", "0"…
$ a_elegantissima           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ phragmatopoma_californica &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ chtalmus_balanus          &lt;dbl&gt; 0.16666667, 0.07692308, 0.50000000, 0.090909…
$ bare_rock                 &lt;dbl&gt; 0.83333333, 0.92307692, 0.50000000, 0.909090…
$ ralfsia_sp                &lt;dbl&gt; 0.0000000, 0.0000000, 0.0000000, 0.0000000, …
$ coralline_crust           &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ endocaldia_sp             &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
$ p_polymerus               &lt;dbl&gt; 0.0000000, 0.0000000, 0.0000000, 0.0000000, …
$ ulva_sp                   &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to standardize the colors throughout the manuscript</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>season_colors <span class="ot">&lt;-</span> <span class="fu">c</span>( </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Winter =</span> <span class="st">"#1F4E79"</span>,</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spring =</span> <span class="st">"#2E8B57"</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fall   =</span> <span class="st">"#C65D2E"</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
<section id="data-cleaning-and-harmonization" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="data-cleaning-and-harmonization"><span class="header-section-number">4</span> Data cleaning and harmonization</h2>
<p>We standardize: - <code>season</code> as an <strong>ordered factor</strong> - <code>date</code> as a real date (best-effort parse for differences across datasets) - <code>col_pres</code> to <strong>Yes/No</strong> factor - key grouping variables (<code>transect</code>, <code>plot_name</code>, etc.)</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Season order </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>season_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Winter"</span>,<span class="st">"Spring"</span>,<span class="st">"Summer"</span>,<span class="st">"Fall"</span>) <span class="co"># change this order to change order of the plots</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Limpet size dataset</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>limpet_size <span class="ot">&lt;-</span> limpet_size_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dataset stores date as "YYYY_MM_DD" strings (e.g., 2023_09_29)</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_side =</span> <span class="fu">as.factor</span>(plot_side),</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">sl_mm =</span> <span class="fu">as.numeric</span>(sl_mm)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(season), <span class="sc">!</span><span class="fu">is.na</span>(sl_mm)) <span class="co"># remove the rows with NAs in length or season</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Mobile invertebrate counts</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>mobile <span class="ot">&lt;-</span> mobile_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">transect =</span> <span class="fu">as.factor</span>(transect),</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_pres =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"y"</span>,<span class="st">"yes"</span>,<span class="st">"true"</span>,<span class="st">"t"</span>,<span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"n"</span>,<span class="st">"no"</span>,<span class="st">"false"</span>,<span class="st">"f"</span>,<span class="st">"0"</span>) <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>))</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Sessile percent cover (in this file, cover columns appear to be proportions already: 0–1)</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>sessile <span class="ot">&lt;-</span> sessile_raw <span class="sc">%&gt;%</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">transect =</span> <span class="fu">as.factor</span>(transect),</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_pres =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"y"</span>,<span class="st">"yes"</span>,<span class="st">"true"</span>,<span class="st">"t"</span>,<span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"n"</span>,<span class="st">"no"</span>,<span class="st">"false"</span>,<span class="st">"f"</span>,<span class="st">"0"</span>) <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>))</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick checks</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>limpet_size <span class="sc">%&gt;%</span> <span class="fu">count</span>(season)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]}],"data":[{"1":"Winter","2":"1316"},{"1":"Spring","2":"1715"},{"1":"Fall","2":"1717"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>mobile <span class="sc">%&gt;%</span> <span class="fu">count</span>(season, col_pres) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["fct"],"align":["left"]},{"label":["col_pres"],"name":[2],"type":["fct"],"align":["left"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"Winter","2":"No","3":"42"},{"1":"Winter","2":"Yes","3":"42"},{"1":"Spring","2":"No","3":"42"},{"1":"Spring","2":"Yes","3":"42"},{"1":"Fall","2":"No","3":"36"},{"1":"Fall","2":"Yes","3":"36"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sessile <span class="sc">%&gt;%</span> <span class="fu">count</span>(season, col_pres) <span class="do">## looks like there are missing pairs of col present</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["season"],"name":[1],"type":["fct"],"align":["left"]},{"label":["col_pres"],"name":[2],"type":["fct"],"align":["left"]},{"label":["n"],"name":[3],"type":["int"],"align":["right"]}],"data":[{"1":"Winter","2":"No","3":"41"},{"1":"Winter","2":"Yes","3":"44"},{"1":"Spring","2":"No","3":"41"},{"1":"Spring","2":"Yes","3":"44"},{"1":"Fall","2":"No","3":"35"},{"1":"Fall","2":"Yes","3":"36"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<hr>
</section>
<section id="question-1-do-limpet-density-and-size-change-by-season" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="question-1-do-limpet-density-and-size-change-by-season"><span class="header-section-number">5</span> Question 1: Do limpet density and size change by season?</h2>
<section id="a.-density-true-density-transect-area-50-m²" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="a.-density-true-density-transect-area-50-m²"><span class="header-section-number">5.1</span> 1A. Density (true density; transect area = 50 m²)</h3>
<p>You specified that each limpet-density sampling unit corresponds to a <strong>50 m² transect</strong>. We therefore compute:</p>
<ul>
<li><code>n_limpets</code> = number of limpets observed in a sampling unit</li>
<li><code>density_m2</code> = <code>n_limpets / 50</code></li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>limpet_density <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(season, date, plot_name) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_limpets =</span> <span class="fu">n</span>(),<span class="co"># count all the limpets</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># True density (per m²) using known transect area</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="dv">50</span>, <span class="do">## double check this is correct. How long was the transect and how many meters on either size of the transect did you go? </span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_m2 =</span> n_limpets <span class="sc">/</span> area_m2,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_sl =</span> <span class="fu">mean</span>(sl_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># mean size per transect</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_sl =</span> <span class="fu">sd</span>(sl_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># standard deviation in size per transect</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span> <span class="co"># drop the groupings</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>limpet_density <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 26
Columns: 8
$ season     &lt;fct&gt; Winter, Winter, Winter, Winter, Winter, Winter, Winter, Win…
$ date       &lt;date&gt; 2023-12-10, 2023-12-10, 2024-02-10, 2024-02-10, 2024-02-10…
$ plot_name  &lt;fct&gt; CNM_5, CNM_6, CNM_1, CNM_2, CNM_3, CNM_4, CNM_5, CNM_6, CNM…
$ n_limpets  &lt;int&gt; 101, 18, 295, 348, 313, 127, 89, 25, 50, 50, 50, 60, 30, 25…
$ area_m2    &lt;dbl&gt; 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50,…
$ density_m2 &lt;dbl&gt; 2.02, 0.36, 5.90, 6.96, 6.26, 2.54, 1.78, 0.50, 1.00, 1.00,…
$ mean_sl    &lt;dbl&gt; 30.46535, 46.44444, 40.76610, 46.30747, 46.71885, 43.81102,…
$ sd_sl      &lt;dbl&gt; 12.90238, 13.53089, 16.24796, 15.83089, 12.89271, 18.26817,…</code></pre>
</div>
</div>
<section id="exploratory-plot-density-by-season" class="level4" data-number="5.1.1">
<h4 data-number="5.1.1" class="anchored" data-anchor-id="exploratory-plot-density-by-season"><span class="header-section-number">5.1.1</span> Exploratory plot (density by season)</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>p_density <span class="ot">&lt;-</span> limpet_density <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2, <span class="at">fill =</span> season),<span class="at">adjust =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.18</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="do">## this removes the outliers from the boxplot-- only OK because I also have the stat_halfeye and the jitter</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Owl limpet density (individuals m⁻²)"</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal variation in owl limpet density"</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))<span class="sc">+</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>p_density</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="model-negative-binomial-glmm-random-effects-for-plot" class="level4" data-number="5.1.2">
<h4 data-number="5.1.2" class="anchored" data-anchor-id="model-negative-binomial-glmm-random-effects-for-plot"><span class="header-section-number">5.1.2</span> Model: negative binomial GLMM (random effects for plot)</h4>
<p>Counts are typically overdispersed; negative binomial is usually appropriate.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>m_density <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts because negative binomial requires count data with an offset for sampled area to estimate density</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  n_limpets <span class="sc">~</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot_name),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> limpet_density</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_density)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          n_limpets ~ season + offset(log(area_m2)) + (1 | plot_name)
Data: limpet_density

      AIC       BIC    logLik -2*log(L)  df.resid 
    321.1     327.4    -155.5     311.1        21 

Random effects:

Conditional model:
 Groups    Name        Variance Std.Dev.
 plot_name (Intercept) 0.5694   0.7546  
Number of obs: 26, groups:  plot_name, 6

Dispersion parameter for nbinom2 family ():  2.7 

Conditional model:
             Estimate Std. Error z value Pr(&gt;|z|)   
(Intercept)    1.0614     0.3791   2.800  0.00511 **
seasonSpring  -0.1866     0.2839  -0.657  0.51090   
seasonFall     0.5682     0.3357   1.692  0.09058 . 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_overdispersion</span>(m_density)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># Overdispersion test

 dispersion ratio = 0.305
          p-value = 0.656</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_zeroinflation</span>(m_density)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Model has no observed zeros in the response variable.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
</div>
<section id="diagnostics-dharma" class="level5" data-number="5.1.2.1">
<h5 data-number="5.1.2.1" class="anchored" data-anchor-id="diagnostics-dharma"><span class="header-section-number">5.1.2.1</span> Diagnostics (DHARMa)</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sim_density <span class="ot">&lt;-</span> DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(m_density, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_density)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testDispersion</span>(sim_density)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 0.29278, p-value = 0.562
alternative hypothesis: two.sided</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testZeroInflation</span>(sim_density)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa zero-inflation test via comparison to expected zeros with
    simulation under H0 = fitted model

data:  simulationOutput
ratioObsSim = 0, p-value = 1
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
<section id="effect-sizes-estimated-marginal-means-and-contrasts" class="level5" data-number="5.1.2.2">
<h5 data-number="5.1.2.2" class="anchored" data-anchor-id="effect-sizes-estimated-marginal-means-and-contrasts"><span class="header-section-number">5.1.2.2</span> Effect sizes: estimated marginal means and contrasts</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>emm_density <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_density, <span class="sc">~</span> season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co"># With the area offset, 'response' is on the expected count scale; divide by area to report density</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>emm_density</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> season response    SE  df asymp.LCL asymp.UCL
 Winter      145  54.8 Inf      68.7       304
 Spring      120  42.8 Inf      59.5       242
 Fall        255 101.8 Inf     116.6       558

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_density, <span class="at">adjust =</span> <span class="st">"tukey"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast        ratio    SE  df null z.ratio p.value
 Winter / Spring 1.205 0.342 Inf    1   0.657  0.7881
 Winter / Fall   0.567 0.190 Inf    1  -1.692  0.2081
 Spring / Fall   0.470 0.146 Inf    1  -2.425  0.0406

P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
</div>
</div>
</section>
<section id="figure-showing-the-actual-model-results-model-based-means-with-uncertainty" class="level5" data-number="5.1.2.3">
<h5 data-number="5.1.2.3" class="anchored" data-anchor-id="figure-showing-the-actual-model-results-model-based-means-with-uncertainty"><span class="header-section-number">5.1.2.3</span> Figure showing the actual model results: model-based means with uncertainty</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df_density_emm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_density) <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="dv">50</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> response <span class="sc">/</span> area_m2,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_lower =</span> asymp.LCL <span class="sc">/</span> area_m2,</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_upper =</span> asymp.UCL <span class="sc">/</span> area_m2</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Note add in stars or letters or brackets based on significance testing from the emmeans</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>p_density_emm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_density_emm, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> limpet_density, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2), </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> density_lower, <span class="at">ymax =</span> density_upper), <span class="at">width =</span> <span class="fl">0.12</span>) <span class="sc">+</span></span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Estimated owl limpet density (individuals m⁻²)"</span>,</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Seasonal effect on owl limpet density (model-based NB-GLMM with area offset)"</span>) <span class="sc">+</span></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>p_density_emm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="b.-size-sl_mm-by-season" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="b.-size-sl_mm-by-season"><span class="header-section-number">5.2</span> 1B. Size (<code>sl_mm</code>) by season</h3>
<p>Because <code>sl_mm</code> is continuous and strictly positive, we typically choose either: - <strong>Gamma GLMM</strong> or <strong>Tweedie GLMM</strong> with log link, or - <strong>LMM</strong> on log-transformed sizes.</p>
<p>Here, we start with <strong>Gamma GLMM</strong> and fallback if needed. The <strong>Gamma</strong> was not a good fit so I went to <em>Tweedie</em> which was better but still not great. Keep looking…. the bimodal sizes makes this harder</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>p_size <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> sl_mm, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="fu">aes</span>(<span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.18</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.20</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Shell length (mm)"</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Owl limpet size distribution by season"</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))<span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>p_size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="gamma-or-tweedie-glmm-with-random-effects-for-plot" class="level4" data-number="5.2.1">
<h4 data-number="5.2.1" class="anchored" data-anchor-id="gamma-or-tweedie-glmm-with-random-effects-for-plot"><span class="header-section-number">5.2.1</span> Gamma or Tweedie GLMM with random effects for plot</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>m_size_gamma <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  sl_mm <span class="sc">~</span> season <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot_name),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dispformula =</span> <span class="sc">~</span> season,  <span class="co"># Model dispersion as a function of season because unequal variances</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">tweedie</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="co"># better but still not the best, but I trust more this model</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> limpet_size</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_size_gamma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: tweedie  ( log )
Formula:          sl_mm ~ season + (1 | plot_name)
Dispersion:             ~season
Data: limpet_size

      AIC       BIC    logLik -2*log(L)  df.resid 
  39588.7   39640.4  -19786.3   39572.7      4740 

Random effects:

Conditional model:
 Groups    Name        Variance Std.Dev.
 plot_name (Intercept) 0.0132   0.1149  
Number of obs: 4748, groups:  plot_name, 6

Conditional model:
               Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   3.7487133  0.0481644   77.83   &lt;2e-16 ***
seasonSpring -0.0239444  0.0136551   -1.75   0.0795 .  
seasonFall    0.0003755  0.0133760    0.03   0.9776    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Dispersion model:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   1.56679    0.02813   55.71   &lt;2e-16 ***
seasonSpring  0.04531    0.03402    1.33    0.183    
seasonFall   -0.03806    0.04556   -0.84    0.404    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<section id="diagnostics" class="level5" data-number="5.2.1.1">
<h5 data-number="5.2.1.1" class="anchored" data-anchor-id="diagnostics"><span class="header-section-number">5.2.1.1</span> Diagnostics</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>sim_size <span class="ot">&lt;-</span> DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(m_size_gamma, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testDispersion</span>(sim_size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    DHARMa nonparametric dispersion test via sd of residuals fitted vs.
    simulated

data:  simulationOutput
dispersion = 1.0117, p-value = 0.77
alternative hypothesis: two.sided</code></pre>
</div>
</div>
</section>
<section id="estimated-marginal-means-back-transformed-to-mm" class="level5" data-number="5.2.1.2">
<h5 data-number="5.2.1.2" class="anchored" data-anchor-id="estimated-marginal-means-back-transformed-to-mm"><span class="header-section-number">5.2.1.2</span> Estimated marginal means (back-transformed to mm)</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>emm_size <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_size_gamma, <span class="sc">~</span> season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>emm_size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> season response   SE  df asymp.LCL asymp.UCL
 Winter     42.5 2.05 Inf      38.6      46.7
 Spring     41.5 1.99 Inf      37.7      45.6
 Fall       42.5 2.03 Inf      38.7      46.7

Confidence level used: 0.95 
Intervals are back-transformed from the log scale </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_size, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> contrast        ratio     SE  df null z.ratio p.value
 Winter / Spring 1.024 0.0140 Inf    1   1.754  0.1855
 Winter / Fall   1.000 0.0134 Inf    1  -0.028  0.9996
 Spring / Fall   0.976 0.0125 Inf    1  -1.906  0.1369

P value adjustment: tukey method for comparing a family of 3 estimates 
Tests are performed on the log scale </code></pre>
</div>
</div>
</section>
<section id="figure-model-based-seasonal-means" class="level5" data-number="5.2.1.3">
<h5 data-number="5.2.1.3" class="anchored" data-anchor-id="figure-model-based-seasonal-means"><span class="header-section-number">5.2.1.3</span> Figure: model-based seasonal means</h5>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>df_size_emm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_size)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>p_size_emm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_size_emm, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> asymp.LCL, <span class="at">ymax =</span> asymp.UCL), <span class="at">width =</span> <span class="fl">0.12</span>) <span class="sc">+</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Estimated mean shell length (mm)"</span>,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal effect on owl limpet size (Gamma GLMM)"</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>p_size_emm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="different-kind-of-visual-to-look-at-size-structure-shifts-cdfs" class="level4" data-number="5.2.2">
<h4 data-number="5.2.2" class="anchored" data-anchor-id="different-kind-of-visual-to-look-at-size-structure-shifts-cdfs"><span class="header-section-number">5.2.2</span> Different kind of visual to look at size structure shifts (CDFs)</h4>
<p>Cumulative distributions are great for communicating shifts in size structure (e.g., truncation).</p>
<p>You would interprethis this plot byt saying: “For each season, what fraction of limpets are smaller than a given shell length?”</p>
<p>Example interpretations of the plot</p>
<p>Steeper ECDF at small sizes in Spring → Maybe recent recruitment or better post-settlement survival</p>
<p>Right-shifted ECDF in Fall/Summer → growth of survivors after spring recruitment?</p>
<p>These patterns often cannot be detected by mean-based models alone.</p>
<p>“We visualized seasonal shifts in owl limpet size structure using empirical cumulative distribution functions (ECDFs), which depict the proportion of individuals that are smaller than a given shell length without assuming an underlying distribution.”</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>p_cdf <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sl_mm, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Shell length (mm)"</span>, <span class="at">y =</span> <span class="st">"Empirical CDF"</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal shifts in size structure (ECDF)"</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>p_cdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
<p>You would start with the mean values that you get from the emmeans output of the size model, state if there are any differences and then interpretit this model. The empirical cumulative distribution functions (ECDFs) showed seasonal differences in size structure beyond mean responses. For a given shell length, the proportion of individuals by size differed among seasons, indicating seasonal shifts in the relative abundance of small versus large individuals. In particular, Spring exhibited a higher proportion of small individuals across much of the size range, whereas Fall and Winter showed a right-shifted distribution consistent with a greater representation of larger individuals.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Bring the figures together for pub quality</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Add in stars with brackes to show significance between seasons based on emmeans</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>(p_density<span class="sc">|</span>p_size<span class="sc">|</span>p_cdf)<span class="sc">+</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"figure1.png"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="question-2-does-limpet-presence-affect-community-composition-and-does-it-interact-with-season" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="question-2-does-limpet-presence-affect-community-composition-and-does-it-interact-with-season"><span class="header-section-number">6</span> Question 2: Does limpet presence affect community composition, and does it interact with season?</h2>
<p>We analyze both: - <strong>Mobile invertebrate counts</strong> (multivariate &amp; univariate) - <strong>Sessile cover composition</strong> (multivariate &amp; univariate) – I am having a hard time with the sessile data. Seems like everything is mostly bare rock and I am not sure what the microalgae are here</p>
<p>Key fixed effects: - <code>col_pres</code> (No vs Yes) - <code>season</code> - <code>col_pres * season</code> interaction</p>
<p>Random/blocking structure: - <code>transect</code> is used for random effects and permutation strata (to respect spatial non-independence).</p>
<hr>
</section>
<section id="a.-mobile-invertebrates-counts" class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="a.-mobile-invertebrates-counts"><span class="header-section-number">7</span> 2A. Mobile invertebrates (counts)</h2>
<section id="identify-species-columns" class="level3" data-number="7.1">
<h3 data-number="7.1" class="anchored" data-anchor-id="identify-species-columns"><span class="header-section-number">7.1</span> Identify species columns</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group by species groups first</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>mobile_grouped<span class="ot">&lt;-</span>mobile <span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Limpets =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(l_limatula, l_scabra, l_gigantea))),</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Chitons =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(nuttallina_sp, mopalia_sp, l_hartwegii,l_dentiens))),</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">Turbans =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(t_eiseni<span class="sc">:</span>t_gallina))),</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">Periwinkles =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(l_plena, l_keenae))),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">Whelks =</span> m_lugubris) <span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(m_lugubris<span class="sc">:</span>l_gigantea))</span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="co"># metadata</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>mobile_meta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"season"</span>,<span class="st">"date"</span>,<span class="st">"transect"</span>,<span class="st">"plot_name"</span>,<span class="st">"l_r"</span>,<span class="st">"meter_no"</span>,<span class="st">"col_pres"</span>,<span class="st">"t_f"</span>,<span class="st">"tag_id"</span>)</span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>mobile_spp <span class="ot">&lt;-</span> mobile_grouped <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(mobile_meta))</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity checks: are these non-negative counts?</span></span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mobile_spp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    Limpets          Chitons        Turbans       Periwinkles   
 Min.   : 0.000   Min.   :0.00   Min.   : 0.00   Min.   : 0.00  
 1st Qu.: 0.000   1st Qu.:0.00   1st Qu.: 0.00   1st Qu.: 0.00  
 Median : 2.000   Median :0.00   Median : 0.00   Median : 0.00  
 Mean   : 3.502   Mean   :0.25   Mean   : 1.95   Mean   : 0.65  
 3rd Qu.: 4.000   3rd Qu.:0.00   3rd Qu.: 1.00   3rd Qu.: 0.00  
 Max.   :50.000   Max.   :6.00   Max.   :26.00   Max.   :31.00  
 NA's   :1                                                      
     Whelks      
 Min.   :0.0000  
 1st Qu.:0.0000  
 Median :0.0000  
 Mean   :0.3583  
 3rd Qu.:0.0000  
 Max.   :6.0000  
                 </code></pre>
</div>
</div>
</section>
<section id="transformations-for-multivariate-analyses" class="level3" data-number="7.2">
<h3 data-number="7.2" class="anchored" data-anchor-id="transformations-for-multivariate-analyses"><span class="header-section-number">7.2</span> Transformations for multivariate analyses</h3>
<p>For community composition, we typically: - use <strong>gower</strong> on square-root transformed counts since lots of zeros. Bray-Curtis did not work.</p>
<p>For Gower, multiplying all counts by the same constant (e.g., converting to per m² when all plots have identical area) does <strong>not</strong> change dissimilarities; we still report univariate abundance in <strong>m⁻²</strong> for interpretability.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>mobile_mat <span class="ot">&lt;-</span> mobile_spp <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span> <span class="co"># make the missing values zeros</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># gower dissimilarity on sqrt counts because 0s present</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>mobile_bc <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">sqrt</span>(mobile_mat), <span class="at">method =</span> <span class="st">"gower"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="permanova-adonis2-with-permutations-constrained-by-transect" class="level3" data-number="7.3">
<h3 data-number="7.3" class="anchored" data-anchor-id="permanova-adonis2-with-permutations-constrained-by-transect"><span class="header-section-number">7.3</span> PERMANOVA (adonis2) with permutations constrained by transect</h3>
<p>This tests whether multivariate centroids differ by predictors.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>adon_mobile <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  mobile_bc <span class="sc">~</span> col_pres <span class="sc">*</span> season,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile,</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">permutations =</span> <span class="dv">999</span>,</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> mobile<span class="sc">$</span>transect</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>adon_mobile</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SumOfSqs"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"0.4141905","3":"0.09194445","4":"4.738697","5":"0.001","_rn_":"Model"},{"1":"234","2":"4.0906002","3":"0.90805555","4":"NA","5":"NA","_rn_":"Residual"},{"1":"239","2":"4.5047907","3":"1.00000000","4":"NA","5":"NA","_rn_":"Total"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Need to add in the pairwise differences-- follow up with this</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="check-dispersion-permdisp" class="level3" data-number="7.4">
<h3 data-number="7.4" class="anchored" data-anchor-id="check-dispersion-permdisp"><span class="header-section-number">7.4</span> Check dispersion (PERMDISP)</h3>
<p>PERMANOVA can be sensitive to differences in within-group dispersion.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>disp_mobile <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(mobile_bc, <span class="fu">interaction</span>(mobile<span class="sc">$</span>col_pres, mobile<span class="sc">$</span>season))</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(disp_mobile)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"0.4856105","3":"0.097122108","4":"15.02943","5":"8.514811e-13","_rn_":"Groups"},{"1":"234","2":"1.5121377","3":"0.006462127","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(disp_mobile, <span class="at">permutations =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
           Df  Sum Sq  Mean Sq      F N.Perm Pr(&gt;F)    
Groups      5 0.48561 0.097122 15.029    999  0.001 ***
Residuals 234 1.51214 0.006462                         
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(disp_mobile) <span class="co"># get pairwise differences</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = distances ~ group, data = df)

$group
                              diff          lwr          upr     p adj
Yes.Winter-No.Winter  -0.031682628 -0.082089233  0.018723977 0.4638156
No.Spring-No.Winter    0.023061022 -0.027345583  0.073467627 0.7767503
Yes.Spring-No.Winter   0.017418686 -0.032987919  0.067825291 0.9198558
No.Fall-No.Winter     -0.099087799 -0.151552657 -0.046622941 0.0000021
Yes.Fall-No.Winter    -0.074262160 -0.126727018 -0.021797302 0.0009115
No.Spring-Yes.Winter   0.054743651  0.004337045  0.105150256 0.0245543
Yes.Spring-Yes.Winter  0.049101314 -0.001305291  0.099507919 0.0611142
No.Fall-Yes.Winter    -0.067405171 -0.119870029 -0.014940313 0.0037281
Yes.Fall-Yes.Winter   -0.042579532 -0.095044390  0.009885326 0.1854772
Yes.Spring-No.Spring  -0.005642337 -0.056048942  0.044764269 0.9995380
No.Fall-No.Spring     -0.122148822 -0.174613680 -0.069683964 0.0000000
Yes.Fall-No.Spring    -0.097323183 -0.149788041 -0.044858325 0.0000034
No.Fall-Yes.Spring    -0.116506485 -0.168971343 -0.064041627 0.0000000
Yes.Fall-Yes.Spring   -0.091680846 -0.144145704 -0.039215988 0.0000150
Yes.Fall-No.Fall       0.024825639 -0.029619717  0.079270995 0.7791953</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Yes clearly very different dispersion (the size of the circle)--but driven by season based on pairwise</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="ordination-nmds-visualize-patterns" class="level3" data-number="7.5">
<h3 data-number="7.5" class="anchored" data-anchor-id="ordination-nmds-visualize-patterns"><span class="header-section-number">7.5</span> Ordination: NMDS (visualize patterns)</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>nmds_mobile <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(<span class="fu">sqrt</span>(mobile_mat), <span class="at">distance =</span> <span class="st">"gower"</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trymax =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Run 0 stress 0.1489316 
Run 1 stress 0.1654009 
Run 2 stress 0.1493779 
... Procrustes: rmse 0.0184872  max resid 0.09501029 
Run 3 stress 0.1512335 
Run 4 stress 0.1679303 
Run 5 stress 0.1605025 
Run 6 stress 0.1705089 
Run 7 stress 0.1553655 
Run 8 stress 0.155486 
Run 9 stress 0.1736175 
Run 10 stress 0.1824326 
Run 11 stress 0.1502856 
Run 12 stress 0.1516814 
Run 13 stress 0.1642361 
Run 14 stress 0.1499779 
Run 15 stress 0.1578936 
Run 16 stress 0.1609995 
Run 17 stress 0.1551711 
Run 18 stress 0.1562567 
Run 19 stress 0.1500442 
Run 20 stress 0.1565818 
Run 21 stress 0.1564403 
Run 22 stress 0.1721126 
Run 23 stress 0.1702597 
Run 24 stress 0.1508816 
Run 25 stress 0.1566659 
Run 26 stress 0.1848796 
Run 27 stress 0.1664247 
Run 28 stress 0.1499771 
Run 29 stress 0.1788115 
Run 30 stress 0.1498233 
Run 31 stress 0.1636457 
Run 32 stress 0.1617082 
Run 33 stress 0.1740417 
Run 34 stress 0.1864239 
Run 35 stress 0.1554597 
Run 36 stress 0.1680007 
Run 37 stress 0.1493769 
... Procrustes: rmse 0.01842455  max resid 0.09482328 
Run 38 stress 0.1501574 
Run 39 stress 0.1517239 
Run 40 stress 0.1671198 
Run 41 stress 0.1745603 
Run 42 stress 0.1675747 
Run 43 stress 0.1733566 
Run 44 stress 0.157234 
Run 45 stress 0.1537599 
Run 46 stress 0.1497737 
Run 47 stress 0.1558914 
Run 48 stress 0.1497397 
Run 49 stress 0.1517776 
Run 50 stress 0.1569672 
Run 51 stress 0.1551634 
Run 52 stress 0.1563097 
Run 53 stress 0.15176 
Run 54 stress 0.1741338 
Run 55 stress 0.1506005 
Run 56 stress 0.1562566 
Run 57 stress 0.1493782 
... Procrustes: rmse 0.01851924  max resid 0.09511483 
Run 58 stress 0.1609774 
Run 59 stress 0.1700217 
Run 60 stress 0.1566831 
Run 61 stress 0.1811786 
Run 62 stress 0.1577438 
Run 63 stress 0.1696181 
Run 64 stress 0.1535253 
Run 65 stress 0.1584971 
Run 66 stress 0.1702018 
Run 67 stress 0.1502856 
Run 68 stress 0.1661467 
Run 69 stress 0.1603195 
Run 70 stress 0.1497739 
Run 71 stress 0.1489312 
... New best solution
... Procrustes: rmse 0.0001565671  max resid 0.001659091 
... Similar to previous best
*** Best solution repeated 1 times</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>nmds_mobile<span class="sc">$</span>stress <span class="co">#get the stress</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1489312</code></pre>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># --- NMDS biplot for MOBILE invertebrates ( species vectors) ----</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit species vectors to the NMDS using envfit</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co">#    - "display = 'species'" returns directions for each taxa</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co">#    - we fit to sqrt(mobile_mat) if NMDS was based on sqrt counts</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>fit_spp <span class="ot">&lt;-</span> <span class="fu">envfit</span>(nmds_mobile, <span class="fu">sqrt</span>(mobile_mat), <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract site scores</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>sites_df <span class="ot">&lt;-</span> <span class="fu">scores</span>(nmds_mobile, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"site_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(mobile_grouped <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">site_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> <span class="fu">select</span>(site_id, season, col_pres, transect))</span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract species vectors + p-values; keep only significant / strong ones</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a>vec_df <span class="ot">&lt;-</span> <span class="fu">scores</span>(fit_spp, <span class="at">display =</span> <span class="st">"vectors"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"taxon"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p-values are in fit_spp$vectors$pvals; same order as rows in scores()</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> fit_spp<span class="sc">$</span>vectors<span class="sc">$</span>pvals) <span class="sc">%&gt;%</span></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vector strength (longer = stronger relationship with ordination)</span></span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="fu">sqrt</span>(NMDS1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> NMDS2<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(p) <span class="do">## all the species have significant vectors</span></span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose which taxa to label: either significant + top N by vector length</span></span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>top_n <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>vec_keep <span class="ot">&lt;-</span> vec_df <span class="sc">%&gt;%</span></span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;=</span> alpha) <span class="sc">%&gt;%</span></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> r, <span class="at">n =</span> top_n)</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale vectors to match plot extent (so arrows look nice)</span></span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a><span class="co">#    This rescales arrows relative to NMDS axes range.</span></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>arrow_mult <span class="ot">&lt;-</span> <span class="fl">0.85</span> <span class="sc">*</span> <span class="fu">min</span>(</span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="fu">range</span>(sites_df<span class="sc">$</span>NMDS1)) <span class="sc">/</span> <span class="fu">diff</span>(<span class="fu">range</span>(vec_keep<span class="sc">$</span>NMDS1)),</span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="fu">range</span>(sites_df<span class="sc">$</span>NMDS2)) <span class="sc">/</span> <span class="fu">diff</span>(<span class="fu">range</span>(vec_keep<span class="sc">$</span>NMDS2))</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a>vec_keep <span class="ot">&lt;-</span> vec_keep <span class="sc">%&gt;%</span></span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NMDS1 =</span> NMDS1 <span class="sc">*</span> arrow_mult,</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a>         <span class="at">NMDS2 =</span> NMDS2 <span class="sc">*</span> arrow_mult)</span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: sites + ellipses + species vectors (biplot)</span></span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>p_biplot_mobile <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sites_df, <span class="fu">aes</span>(NMDS1, NMDS2)) <span class="sc">+</span></span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sites</span></span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> season, <span class="at">shape =</span> col_pres), <span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group ellipses</span></span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(season, col_pres), <span class="at">color =</span> season),</span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a>               <span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Species arrows</span></span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> vec_keep,</span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> NMDS1, <span class="at">yend =</span> NMDS2),</span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.7</span>,</span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.18</span>, <span class="st">"cm"</span>))</span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Species labels</span></span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> vec_keep,</span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">label =</span> taxon),</span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span></span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors) <span class="sc">+</span></span>
<span id="cb61-71"><a href="#cb61-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb61-72"><a href="#cb61-72" aria-hidden="true" tabindex="-1"></a>    <span class="co">#title = "Mobile invertebrates NMDS biplot",</span></span>
<span id="cb61-73"><a href="#cb61-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Stress = "</span>, <span class="fu">round</span>(nmds_mobile<span class="sc">$</span>stress, <span class="dv">3</span>)),</span>
<span id="cb61-74"><a href="#cb61-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Season"</span>,</span>
<span id="cb61-75"><a href="#cb61-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span></span>
<span id="cb61-76"><a href="#cb61-76" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-77"><a href="#cb61-77" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb61-78"><a href="#cb61-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb61-79"><a href="#cb61-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-80"><a href="#cb61-80" aria-hidden="true" tabindex="-1"></a>p_biplot_mobile</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="univariate-summaries-total-abundance" class="level3" data-number="7.6">
<h3 data-number="7.6" class="anchored" data-anchor-id="univariate-summaries-total-abundance"><span class="header-section-number">7.6</span> Univariate summaries (total abundance)</h3>
<p>These are interpretable “whole-community” metrics.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>mobile_alpha <span class="ot">&lt;-</span> mobile_grouped <span class="sc">%&gt;%</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  mobile plot is 0.25 m² -- I think??? what is it?</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="fl">0.25</span>,</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_abund =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(<span class="fu">all_of</span>(<span class="fu">colnames</span>(mobile_mat))), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_abund_m2 =</span> total_abund <span class="sc">/</span> area_m2,</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>mobile_alpha <span class="sc">%&gt;%</span> <span class="fu">select</span>(season, col_pres, transect, total_abund) <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 240
Columns: 4
$ season      &lt;fct&gt; Fall, Fall, Fall, Fall, Fall, Fall, Fall, Fall, Fall, Fall…
$ col_pres    &lt;fct&gt; Yes, No, Yes, No, Yes, No, Yes, No, Yes, No, Yes, No, Yes,…
$ transect    &lt;fct&gt; CNM_1, CNM_1, CNM_1, CNM_1, CNM_1, CNM_1, CNM_1, CNM_1, CN…
$ total_abund &lt;dbl&gt; 0, 1, 0, 1, 0, 6, 0, 5, 1, 2, 1, 1, 2, 0, 0, 1, 24, 6, 1, …</code></pre>
</div>
</div>
<section id="mixed-models-for-individual-metrics" class="level4" data-number="7.6.1">
<h4 data-number="7.6.1" class="anchored" data-anchor-id="mixed-models-for-individual-metrics"><span class="header-section-number">7.6.1</span> Mixed models for Individual metrics</h4>
<ul>
<li><code>total_abund</code>: NB GLMM</li>
</ul>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>m_mobile_total <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts with area offset to infer abundance density (per m²)</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  total_abund <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect),</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile_alpha</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mobile_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          
total_abund ~ col_pres * season + offset(log(area_m2)) + (1 |      transect)
Data: mobile_alpha

      AIC       BIC    logLik -2*log(L)  df.resid 
   1364.8    1392.7    -674.4    1348.8       232 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 transect (Intercept) 0.02907  0.1705  
Number of obs: 240, groups:  transect, 6

Dispersion parameter for nbinom2 family (): 0.845 

Conditional model:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)               3.67555    0.18874  19.474  &lt; 2e-16 ***
col_presYes              -0.45779    0.25104  -1.824 0.068219 .  
seasonSpring             -0.08929    0.24957  -0.358 0.720518    
seasonFall               -2.02975    0.29283  -6.932 4.16e-12 ***
col_presYes:seasonSpring  0.45064    0.35668   1.263 0.206429    
col_presYes:seasonFall    1.33041    0.40046   3.322 0.000893 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the species pairs</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>emm_total <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_mobile_total, <span class="sc">~</span> col_pres<span class="sc">|</span>season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_total, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>season = Winter:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes 1.581 0.397 Inf    1   1.824  0.0682

season = Spring:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes 1.007 0.254 Inf    1   0.028  0.9774

season = Fall:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes 0.418 0.131 Inf    1  -2.782  0.0054

Tests are performed on the log scale </code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(m_mobile_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># here is your example for limpets.  Do for the rest of the species</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>m_mobile_Limpet <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts with area offset to infer abundance density (per m²)</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  Limpets <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect),</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile_alpha</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mobile_Limpet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> Family: nbinom2  ( log )
Formula:          
Limpets ~ col_pres * season + offset(log(area_m2)) + (1 | transect)
Data: mobile_alpha

      AIC       BIC    logLik -2*log(L)  df.resid 
   1086.2    1114.0    -535.1    1070.2       231 

Random effects:

Conditional model:
 Groups   Name        Variance Std.Dev.
 transect (Intercept) 0.1027   0.3205  
Number of obs: 239, groups:  transect, 6

Dispersion parameter for nbinom2 family (): 0.615 

Conditional model:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                3.2409     0.2463  13.158  &lt; 2e-16 ***
col_presYes               -0.7389     0.3019  -2.447  0.01440 *  
seasonSpring              -0.6194     0.3028  -2.045  0.04081 *  
seasonFall                -1.7678     0.3357  -5.266 1.39e-07 ***
col_presYes:seasonSpring   0.6179     0.4375   1.412  0.15782    
col_presYes:seasonFall     1.4722     0.4683   3.144  0.00167 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>emm_limpet <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_mobile_Limpet, <span class="sc">~</span> col_pres<span class="sc">|</span>season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_limpet, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>season = Winter:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes  2.09 0.632 Inf    1   2.447  0.0144

season = Spring:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes  1.13 0.361 Inf    1   0.378  0.7053

season = Fall:
 contrast ratio    SE  df null z.ratio p.value
 No / Yes  0.48 0.174 Inf    1  -2.028  0.0426

Tests are performed on the log scale </code></pre>
</div>
</div>
</section>
<section id="figure-total-abundance-by-col-presence-and-season" class="level4" data-number="7.6.2">
<h4 data-number="7.6.2" class="anchored" data-anchor-id="figure-total-abundance-by-col-presence-and-season"><span class="header-section-number">7.6.2</span> Figure: total abundance by COL presence and season</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># everything</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>p_alpha <span class="ot">&lt;-</span> mobile_alpha <span class="sc">%&gt;%</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Limpets<span class="sc">:</span>Whelks, total_abund_m2 </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>                        ), <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_log =</span> value<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> value_log, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log"</span>)<span class="sc">+</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> season), <span class="at">color =</span> <span class="cn">NULL</span>)<span class="sc">+</span> <span class="co">#outlier.shape = NA, alpha = 0.5) +</span></span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>))<span class="sc">+</span></span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> metric, <span class="at">scales =</span> <span class="st">"free_y"</span>)<span class="sc">+</span></span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Density (m⁻²)"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a>      <span class="co"># title = "Mobile invertebrate alpha metrics vs limpet presence and season"</span></span>
<span id="cb73-18"><a href="#cb73-18" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb73-19"><a href="#cb73-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb73-20"><a href="#cb73-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-21"><a href="#cb73-21" aria-hidden="true" tabindex="-1"></a><span class="do">## total abundance only</span></span>
<span id="cb73-22"><a href="#cb73-22" aria-hidden="true" tabindex="-1"></a>p_total <span class="ot">&lt;-</span> mobile_alpha <span class="sc">%&gt;%</span></span>
<span id="cb73-23"><a href="#cb73-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> total_abund_m2<span class="sc">+</span><span class="dv">1</span>, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb73-24"><a href="#cb73-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log"</span>)<span class="sc">+</span></span>
<span id="cb73-25"><a href="#cb73-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb73-26"><a href="#cb73-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb73-27"><a href="#cb73-27" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb73-28"><a href="#cb73-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb73-29"><a href="#cb73-29" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> season), <span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span> <span class="co">#outlier.shape = NA, alpha = 0.5) +</span></span>
<span id="cb73-30"><a href="#cb73-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb73-31"><a href="#cb73-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Total density (m⁻²)"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb73-32"><a href="#cb73-32" aria-hidden="true" tabindex="-1"></a>      <span class="co"># title = "Mobile invertebrate alpha metrics vs limpet presence and season"</span></span>
<span id="cb73-33"><a href="#cb73-33" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb73-34"><a href="#cb73-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb73-35"><a href="#cb73-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-36"><a href="#cb73-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-37"><a href="#cb73-37" aria-hidden="true" tabindex="-1"></a><span class="do">## add in brackets for yes/no pairs for ones that are significant based on emmeans and clean up the title of total_abunc... and double check that the area is correct since I think you did it two different ways</span></span>
<span id="cb73-38"><a href="#cb73-38" aria-hidden="true" tabindex="-1"></a>p_alpha<span class="sc">+</span>p_biplot_mobile<span class="sc">+</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="1344"></p>
</figure>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"figure2.png"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<hr>
</section>
</section>
</section>
<section id="sessile-community-cover-proportional-cover" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="sessile-community-cover-proportional-cover"><span class="header-section-number">8</span> Sessile community (% cover / proportional cover)</h2>
<section id="identify-sessile-cover-columns-i-dont-trust-this-analysis-rn" class="level3" data-number="8.1">
<h3 data-number="8.1" class="anchored" data-anchor-id="identify-sessile-cover-columns-i-dont-trust-this-analysis-rn"><span class="header-section-number">8.1</span> Identify sessile cover columns — i dont trust this analysis rn</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>sess_meta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"season"</span>,<span class="st">"date"</span>,<span class="st">"transect"</span>,<span class="st">"plot_name"</span>,<span class="st">"l_r"</span>,<span class="st">"meter_no"</span>,<span class="st">"col_pres"</span>,<span class="st">"t_f"</span>,<span class="st">"tag_id"</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>sess_spp <span class="ot">&lt;-</span> sessile <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(sess_meta))</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sess_spp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> a_elegantissima  phragmatopoma_californica chtalmus_balanus   bare_rock     
 Min.   :0.0000   Min.   :0                 Min.   :0.0000   Min.   :0.0000  
 1st Qu.:0.0000   1st Qu.:0                 1st Qu.:0.0000   1st Qu.:0.5000  
 Median :0.0000   Median :0                 Median :0.1875   Median :0.7500  
 Mean   :0.0051   Mean   :0                 Mean   :0.2838   Mean   :0.6749  
 3rd Qu.:0.0000   3rd Qu.:0                 3rd Qu.:0.4545   3rd Qu.:0.9091  
 Max.   :0.1667   Max.   :0                 Max.   :1.0000   Max.   :1.0000  
   ralfsia_sp      coralline_crust     endocaldia_sp        p_polymerus      
 Min.   :0.00000   Min.   :0.0000000   Min.   :0.0000000   Min.   :0.000000  
 1st Qu.:0.00000   1st Qu.:0.0000000   1st Qu.:0.0000000   1st Qu.:0.000000  
 Median :0.00000   Median :0.0000000   Median :0.0000000   Median :0.000000  
 Mean   :0.03298   Mean   :0.0002593   Mean   :0.0005187   Mean   :0.001273  
 3rd Qu.:0.00000   3rd Qu.:0.0000000   3rd Qu.:0.0000000   3rd Qu.:0.000000  
 Max.   :0.81818   Max.   :0.0625000   Max.   :0.1250000   Max.   :0.181818  
    ulva_sp         
 Min.   :0.0000000  
 1st Qu.:0.0000000  
 Median :0.0000000  
 Mean   :0.0007544  
 3rd Qu.:0.0000000  
 Max.   :0.1818182  </code></pre>
</div>
</div>
</section>
<section id="multivariate-test-permanova-on-gower" class="level3" data-number="8.2">
<h3 data-number="8.2" class="anchored" data-anchor-id="multivariate-test-permanova-on-gower"><span class="header-section-number">8.2</span> Multivariate test: PERMANOVA on gower</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>sess_mat <span class="ot">&lt;-</span> sess_spp <span class="sc">%&gt;%</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>sess_bc <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">sqrt</span>(sess_mat), <span class="at">method =</span> <span class="st">"gower"</span>)</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>adon_sess <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>  sess_bc <span class="sc">~</span> col_pres <span class="sc">*</span> season,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sessile,</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">permutations =</span> <span class="dv">999</span>,</span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> sessile<span class="sc">$</span>transect</span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a>adon_sess</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["SumOfSqs"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["R2"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"0.02707702","3":"0.01710917","4":"0.8181284","5":"0.534","_rn_":"Model"},{"1":"235","2":"1.55552597","3":"0.98289083","4":"NA","5":"NA","_rn_":"Residual"},{"1":"240","2":"1.58260299","3":"1.00000000","4":"NA","5":"NA","_rn_":"Total"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="dispersion-check" class="level3" data-number="8.3">
<h3 data-number="8.3" class="anchored" data-anchor-id="dispersion-check"><span class="header-section-number">8.3</span> Dispersion check</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>disp_sess <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(sess_bc, <span class="fu">interaction</span>(sessile<span class="sc">$</span>col_pres, sessile<span class="sc">$</span>season))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(disp_sess)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["Df"],"name":[1],"type":["int"],"align":["right"]},{"label":["Sum Sq"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Mean Sq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["F value"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["Pr(>F)"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"5","2":"0.0135369","3":"0.002707381","4":"0.8989091","5":"0.4825091","_rn_":"Groups"},{"1":"235","2":"0.7077850","3":"0.003011851","4":"NA","5":"NA","_rn_":"Residuals"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(disp_sess, <span class="at">permutations =</span> <span class="dv">999</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
           Df  Sum Sq   Mean Sq      F N.Perm Pr(&gt;F)
Groups      5 0.01354 0.0027074 0.8989    999  0.501
Residuals 235 0.70779 0.0030118                     </code></pre>
</div>
</div>
</section>
<section id="ordination-nmds" class="level3" data-number="8.4">
<h3 data-number="8.4" class="anchored" data-anchor-id="ordination-nmds"><span class="header-section-number">8.4</span> Ordination: NMDS</h3>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>nmds_sess <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(sess_mat, <span class="at">distance =</span> <span class="st">"gower"</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trymax =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Run 0 stress 0.05740934 
Run 1 stress 0.07123927 
Run 2 stress 0.07996556 
Run 3 stress 0.08369677 
Run 4 stress 0.08414332 
Run 5 stress 0.08177604 
Run 6 stress 0.06418628 
Run 7 stress 0.08161958 
Run 8 stress 0.05605864 
... New best solution
... Procrustes: rmse 0.006335537  max resid 0.09642943 
Run 9 stress 0.08153305 
Run 10 stress 0.07967093 
Run 11 stress 0.08734661 
Run 12 stress 0.08339535 
Run 13 stress 0.07948711 
Run 14 stress 0.08265934 
Run 15 stress 0.07046075 
Run 16 stress 0.08711846 
Run 17 stress 0.07229157 
Run 18 stress 0.08611204 
Run 19 stress 0.07467488 
Run 20 stress 0.07185772 
Run 21 stress 0.08760216 
Run 22 stress 0.08698172 
Run 23 stress 0.08019455 
Run 24 stress 0.0762507 
Run 25 stress 0.05880039 
Run 26 stress 0.0827729 
Run 27 stress 0.07909504 
Run 28 stress 0.07968832 
Run 29 stress 0.08417041 
Run 30 stress 0.0774087 
Run 31 stress 0.05878496 
Run 32 stress 0.08642792 
Run 33 stress 0.07081274 
Run 34 stress 0.07323221 
Run 35 stress 0.08819048 
Run 36 stress 0.06322144 
Run 37 stress 0.05878399 
Run 38 stress 0.07890025 
Run 39 stress 0.087898 
Run 40 stress 0.06838705 
Run 41 stress 0.08306189 
Run 42 stress 0.0827603 
Run 43 stress 0.06782013 
Run 44 stress 0.08306559 
Run 45 stress 0.06482403 
Run 46 stress 0.07661064 
Run 47 stress 0.08398423 
Run 48 stress 0.08434384 
Run 49 stress 0.06971111 
Run 50 stress 0.06274988 
Run 51 stress 0.05849546 
Run 52 stress 0.06197518 
Run 53 stress 0.06510409 
Run 54 stress 0.08394029 
Run 55 stress 0.07942564 
Run 56 stress 0.07291217 
Run 57 stress 0.0822933 
Run 58 stress 0.06518959 
Run 59 stress 0.07139404 
Run 60 stress 0.08072635 
Run 61 stress 0.07895587 
Run 62 stress 0.08603784 
Run 63 stress 0.08469142 
Run 64 stress 0.08119509 
Run 65 stress 0.06923559 
Run 66 stress 0.0764816 
Run 67 stress 0.08564673 
Run 68 stress 0.08474302 
Run 69 stress 0.07756212 
Run 70 stress 0.08710173 
Run 71 stress 0.06062404 
Run 72 stress 0.07835221 
Run 73 stress 0.0732897 
Run 74 stress 0.08438178 
Run 75 stress 0.08395705 
Run 76 stress 0.07068419 
Run 77 stress 0.07152341 
Run 78 stress 0.08158971 
Run 79 stress 0.08170725 
Run 80 stress 0.07735774 
Run 81 stress 0.06670814 
Run 82 stress 0.08131518 
Run 83 stress 0.08273408 
Run 84 stress 0.07456874 
Run 85 stress 0.07108209 
Run 86 stress 0.07963305 
Run 87 stress 0.06991005 
Run 88 stress 0.06951594 
Run 89 stress 0.08750777 
Run 90 stress 0.06911316 
Run 91 stress 0.07771445 
Run 92 stress 0.06804276 
Run 93 stress 0.07002528 
Run 94 stress 0.06414735 
Run 95 stress 0.07578108 
Run 96 stress 0.06370066 
Run 97 stress 0.07245112 
Run 98 stress 0.08448136 
Run 99 stress 0.0877698 
Run 100 stress 0.08069743 
*** Best solution was not repeated -- monoMDS stopping criteria:
     5: no. of iterations &gt;= maxit
    83: stress ratio &gt; sratmax
    12: scale factor of the gradient &lt; sfgrmin</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>nmds_sess<span class="sc">$</span>stress</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05605864</code></pre>
</div>
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>scores_sess <span class="ot">&lt;-</span> <span class="fu">scores</span>(nmds_sess, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(sessile <span class="sc">%&gt;%</span> <span class="fu">select</span>(season, col_pres, transect))</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>p_nmds_sess <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scores_sess, <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(season, col_pres)), <span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sessile community: NMDS (gower on proportional cover)"</span>,</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Stress = "</span>, <span class="fu">round</span>(nmds_sess<span class="sc">$</span>stress, <span class="dv">3</span>)),</span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span>, <span class="at">color =</span> <span class="st">"Season"</span>) <span class="sc">+</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a>p_nmds_sess</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="univariate-analyses-for-key-functional-groups" class="level3" data-number="8.5">
<h3 data-number="8.5" class="anchored" data-anchor-id="univariate-analyses-for-key-functional-groups"><span class="header-section-number">8.5</span> Univariate analyses for key functional groups</h3>
<p>Depending on your ecological framing, response variables may include: - <strong>Bare rock</strong> (space availability) - <strong>Erect fleshy algae</strong> (here likely <code>ulva_sp</code>, <code>endocaldia_sp</code>, etc.) - <strong>Crustose coralline algae</strong> (<code>coralline_crust</code>) - <strong>Barnacles</strong> (<code>chtalmus_balanus</code>) - <strong>Tube worms</strong> (<code>phragmatopoma_californica</code>) etc.</p>
<p>Where is the microalgae?</p>
<p>Because cover is proportional (0–1), a practical approach is: - transform with <code>logit01()</code> and use LMM/GLMM with Gaussian errors, OR - Beta regression (more complex; <code>glmmTMB</code> can do it with <code>family = beta_family()</code>).</p>
<p>Here we demonstrate logit-transformed LMMs with transect random intercepts.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose a few focal cover variables to test (edit for your hypotheses)</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>focal_cover <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bare_rock"</span>, <span class="st">"ulva_sp"</span>, <span class="st">"coralline_crust"</span>, <span class="st">"chtalmus_balanus"</span>, <span class="st">"ralfsia_sp"</span>)</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>sess_long <span class="ot">&lt;-</span> sessile <span class="sc">%&gt;%</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">all_of</span>(focal_cover), <span class="at">names_to =</span> <span class="st">"taxon"</span>, <span class="at">values_to =</span> <span class="st">"cover"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">cover =</span> <span class="fu">as.numeric</span>(cover),</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">cover_logit =</span> <span class="fu">logit01</span>(cover)</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit one model per taxon (pre-specified list!)</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>models_cover <span class="ot">&lt;-</span> sess_long <span class="sc">%&gt;%</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(taxon) <span class="sc">%&gt;%</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_map</span>(<span class="sc">~</span>{</span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lmer</span>(cover_logit <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect), <span class="at">data =</span> .x)</span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(models_cover) <span class="ot">&lt;-</span> <span class="fu">unique</span>(sess_long<span class="sc">$</span>taxon)</span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Summaries</span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(models_cover, summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$bare_rock
Linear mixed model fit by REML ['lmerMod']
Formula: cover_logit ~ col_pres * season + (1 | transect)
   Data: .x

REML criterion at convergence: 1274.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.2937 -0.4351 -0.1172  0.2428  2.4750 

Random effects:
 Groups   Name        Variance Std.Dev.
 transect (Intercept)  0.4097  0.640   
 Residual             11.8728  3.446   
Number of obs: 241, groups:  transect, 6

Fixed effects:
                         Estimate Std. Error t value
(Intercept)               1.71033    0.59829   2.859
col_presYes              -0.04118    0.74817  -0.055
seasonSpring             -0.63602    0.76116  -0.836
seasonFall               -0.06670    0.79447  -0.084
col_presYes:seasonSpring  1.28211    1.05812   1.212
col_presYes:seasonFall   -0.57466    1.10859  -0.518

Correlation of Fixed Effects:
            (Intr) cl_prY ssnSpr ssnFll cl_Y:S
col_presYes -0.647                            
seasonSprng -0.636  0.509                     
seasonFall  -0.609  0.486  0.479              
cl_prsYs:sS  0.458 -0.707 -0.720 -0.344       
cl_prsYs:sF  0.437 -0.675 -0.344 -0.713  0.477

$ulva_sp
Linear mixed model fit by REML ['lmerMod']
Formula: cover_logit ~ col_pres * season + (1 | transect)
   Data: .x

REML criterion at convergence: 1316.5

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.1943 -0.3816  0.1132  0.4894  3.2218 

Random effects:
 Groups   Name        Variance Std.Dev.
 transect (Intercept)  5.786   2.406   
 Residual             13.582   3.685   
Number of obs: 241, groups:  transect, 6

Fixed effects:
                         Estimate Std. Error t value
(Intercept)               -3.2127     1.1384  -2.822
col_presYes                0.3020     0.8004   0.377
seasonSpring               0.8927     0.8142   1.096
seasonFall                 0.4340     0.8508   0.510
col_presYes:seasonSpring  -0.8577     1.1320  -0.758
col_presYes:seasonFall    -0.7028     1.1859  -0.593

Correlation of Fixed Effects:
            (Intr) cl_prY ssnSpr ssnFll cl_Y:S
col_presYes -0.364                            
seasonSprng -0.358  0.509                     
seasonFall  -0.342  0.485  0.478              
cl_prsYs:sS  0.257 -0.707 -0.720 -0.343       
cl_prsYs:sF  0.246 -0.675 -0.344 -0.712  0.478

$coralline_crust
Linear mixed model fit by REML ['lmerMod']
Formula: cover_logit ~ col_pres * season + (1 | transect)
   Data: .x

REML criterion at convergence: 280.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.3785  0.0000  0.0000  0.0000 15.1416 

Random effects:
 Groups   Name        Variance  Std.Dev.
 transect (Intercept) 1.076e-17 3.28e-09
 Residual             1.755e-01 4.19e-01
Number of obs: 241, groups:  transect, 6

Fixed effects:
                         Estimate Std. Error  t value
(Intercept)              -9.05165    0.06543 -138.343
col_presYes              -0.15859    0.09094   -1.744
seasonSpring             -0.15859    0.09253   -1.714
seasonFall               -0.15859    0.09642   -1.645
col_presYes:seasonSpring  0.15859    0.12861    1.233
col_presYes:seasonFall    0.15859    0.13476    1.177

Correlation of Fixed Effects:
            (Intr) cl_prY ssnSpr ssnFll cl_Y:S
col_presYes -0.719                            
seasonSprng -0.707  0.509                     
seasonFall  -0.679  0.488  0.480              
cl_prsYs:sS  0.509 -0.707 -0.719 -0.345       
cl_prsYs:sF  0.486 -0.675 -0.343 -0.715  0.477
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')


$chtalmus_balanus
Linear mixed model fit by REML ['lmerMod']
Formula: cover_logit ~ col_pres * season + (1 | transect)
   Data: .x

REML criterion at convergence: 1130.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.5959 -0.5682 -0.2328  0.0854  3.4062 

Random effects:
 Groups   Name        Variance Std.Dev.
 transect (Intercept) 1.070    1.034   
 Residual             6.258    2.502   
Number of obs: 241, groups:  transect, 6

Fixed effects:
                         Estimate Std. Error t value
(Intercept)               -8.0319     0.5753 -13.961
col_presYes                0.3517     0.5433   0.647
seasonSpring              -0.6012     0.5527  -1.088
seasonFall                -0.2982     0.5774  -0.516
col_presYes:seasonSpring  -0.6537     0.7683  -0.851
col_presYes:seasonFall     1.0576     0.8049   1.314

Correlation of Fixed Effects:
            (Intr) cl_prY ssnSpr ssnFll cl_Y:S
col_presYes -0.489                            
seasonSprng -0.480  0.509                     
seasonFall  -0.459  0.485  0.478              
cl_prsYs:sS  0.346 -0.707 -0.720 -0.344       
cl_prsYs:sF  0.330 -0.675 -0.344 -0.712  0.478

$ralfsia_sp
Linear mixed model fit by REML ['lmerMod']
Formula: cover_logit ~ col_pres * season + (1 | transect)
   Data: .x

REML criterion at convergence: 359.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-0.4961 -0.0575  0.0101  0.0131 15.0837 

Random effects:
 Groups   Name        Variance Std.Dev.
 transect (Intercept) 0.001227 0.03503 
 Residual             0.244655 0.49463 
Number of obs: 241, groups:  transect, 6

Fixed effects:
                          Estimate Std. Error  t value
(Intercept)              -9.209532   0.078563 -117.224
col_presYes              -0.001304   0.107376   -0.012
seasonSpring             -0.000863   0.109250   -0.008
seasonFall                0.001485   0.113891    0.013
col_presYes:seasonSpring  0.001667   0.151854    0.011
col_presYes:seasonFall    0.215480   0.159112    1.354

Correlation of Fixed Effects:
            (Intr) cl_prY ssnSpr ssnFll cl_Y:S
col_presYes -0.707                            
seasonSprng -0.695  0.509                     
seasonFall  -0.667  0.488  0.480              
cl_prsYs:sS  0.500 -0.707 -0.720 -0.345       
cl_prsYs:sF  0.477 -0.675 -0.343 -0.715  0.477</code></pre>
</div>
</div>
<section id="figure-focal-cover-responses" class="level4" data-number="8.5.1">
<h4 data-number="8.5.1" class="anchored" data-anchor-id="figure-focal-cover-responses"><span class="header-section-number">8.5.1</span> Figure: focal cover responses</h4>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>p_cover <span class="ot">&lt;-</span> sess_long <span class="sc">%&gt;%</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> cover, <span class="at">fill =</span> col_pres)) <span class="sc">+</span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_point(position = position_dodge(width = 0.7))+</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), </span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>              <span class="co"># outlier.shape = NA, </span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> taxon, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Proportional cover"</span>, <span class="at">fill =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Sessile functional/taxon cover vs limpet presence and season"</span>) <span class="sc">+</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a>p_cover</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Cabrillo_owl_limpet_analysis_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="ecological-interpretation-how-to-read-results-fill-in-below-with-your-references" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="ecological-interpretation-how-to-read-results-fill-in-below-with-your-references"><span class="header-section-number">9</span> Ecological interpretation (how to read results – fill in below with your references)</h2>
<section id="seasonal-density-and-size-patterns-whats-plausible" class="level3" data-number="9.1">
<h3 data-number="9.1" class="anchored" data-anchor-id="seasonal-density-and-size-patterns-whats-plausible"><span class="header-section-number">9.1</span> 1) Seasonal density and size patterns (what’s plausible)</h3>
<p>Depending on your results, common mechanisms include:</p>
<ul>
<li><strong>Recruitment pulses</strong> (seasonal larval supply) can increase density of <strong>small</strong> limpets after settlement. – What else do you think?</li>
</ul>
<p>For owl limpets specifically: - <em>Lottia gigantea</em> is well known for <strong>territorial grazing</strong> that can maintain “gardens” of microalgae and influence space availability and algal cover (citations).<br>
- What else?</p>
</section>
<section id="limpet-presence-effects-on-community-composition-expected-directions" class="level3" data-number="9.2">
<h3 data-number="9.2" class="anchored" data-anchor-id="limpet-presence-effects-on-community-composition-expected-directions"><span class="header-section-number">9.2</span> 2) Limpet presence effects on community composition (expected directions)</h3>
<ul>
<li>fill in</li>
</ul>
<p><strong>Season interactions</strong> are common because: - why?</p>
<hr>
</section>
<section id="potenitial-storyline" class="level3" data-number="9.3">
<h3 data-number="9.3" class="anchored" data-anchor-id="potenitial-storyline"><span class="header-section-number">9.3</span> potenitial storyline</h3>
<p><strong>“Seasonal dynamics modulate the engineering role of a territorial grazer.”</strong></p>
</section>
<section id="journals-to-think-about" class="level3" data-number="9.4">
<h3 data-number="9.4" class="anchored" data-anchor-id="journals-to-think-about"><span class="header-section-number">9.4</span> Journals to think about</h3>
<ul>
<li><em>Marine Ecology Progress Series</em> (MEPS)</li>
<li><em>Journal of Experimental Marine Biology and Ecology</em></li>
<li><em>PeerJ</em></li>
</ul>
<hr>
<!-- -->

</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb89" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Cabrillo National Monument: Owl limpet seasonality and community effects"</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> "A mix of univariate of multivariate statistics to test seasonality in both limpet size/density and community responses"</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Nyssa/Cindy"</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "`r format(Sys.Date(), '%Y-%m-%d')`"</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a><span class="co">    toc-depth: 3</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a><span class="co">    number-sections: true</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a><span class="co">    theme: cosmo</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: show</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a><span class="co">    df-print: paged</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a><span class="co">  message: false</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a><span class="co">  cache: false</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>This Quarto notebook analyzes three datasets from **Cabrillo National Monument (San Diego, CA)** to answer:</span>
<span id="cb89-25"><a href="#cb89-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-26"><a href="#cb89-26" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Seasonality in owl limpets (*Lottia gigantea*)**</span>
<span id="cb89-27"><a href="#cb89-27" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Does **density** change by **Season**?</span>
<span id="cb89-28"><a href="#cb89-28" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Does **size** (shell length, `SL_mm`) change by **Season**?</span>
<span id="cb89-29"><a href="#cb89-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-30"><a href="#cb89-30" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Community consequences of limpet presence**</span>
<span id="cb89-31"><a href="#cb89-31" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Does **owl limpet presence** (<span class="in">`COL_pres`</span>) affect:</span>
<span id="cb89-32"><a href="#cb89-32" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>**Mobile invertebrate composition** (counts)?</span>
<span id="cb89-33"><a href="#cb89-33" aria-hidden="true" tabindex="-1"></a><span class="ss">     - </span>**Sessile cover composition** (% cover / proportional cover)?</span>
<span id="cb89-34"><a href="#cb89-34" aria-hidden="true" tabindex="-1"></a><span class="ss">   - </span>Are there **interactions with Season**?</span>
<span id="cb89-35"><a href="#cb89-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-36"><a href="#cb89-36" aria-hidden="true" tabindex="-1"></a><span class="fu">### Design assumptions and why they matter </span></span>
<span id="cb89-37"><a href="#cb89-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-38"><a href="#cb89-38" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The datasets include repeated sampling across **Transects** and/or **Plots**, so we:</span>
<span id="cb89-39"><a href="#cb89-39" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>use **mixed models** with **random intercepts** for spatial sampling units (e.g., <span class="in">`Transect`</span>, or <span class="in">`Plot_Name`</span>),</span>
<span id="cb89-40"><a href="#cb89-40" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>and constrain permutations by transect for multivariate tests.</span>
<span id="cb89-41"><a href="#cb89-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-42"><a href="#cb89-42" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Density**:</span>
<span id="cb89-43"><a href="#cb89-43" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>The transect size was **50 m²** so I divided the counts by this value to get density per transect .</span>
<span id="cb89-44"><a href="#cb89-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-45"><a href="#cb89-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Community data**:</span>
<span id="cb89-46"><a href="#cb89-46" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Mobile inverts are **counts** (often overdispersed, zero-inflated).</span>
<span id="cb89-47"><a href="#cb89-47" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Sessile “percent cover” is stored as **proportions** (0–1) in this dataset; we still treat it as compositional.</span>
<span id="cb89-48"><a href="#cb89-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-49"><a href="#cb89-49" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-50"><a href="#cb89-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-51"><a href="#cb89-51" aria-hidden="true" tabindex="-1"></a><span class="fu">## Packages and helpers</span></span>
<span id="cb89-52"><a href="#cb89-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-55"><a href="#cb89-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-56"><a href="#cb89-56" aria-hidden="true" tabindex="-1"></a><span class="co"># Core</span></span>
<span id="cb89-57"><a href="#cb89-57" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb89-58"><a href="#cb89-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)     <span class="co"># to clean the names for consistency</span></span>
<span id="cb89-59"><a href="#cb89-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-60"><a href="#cb89-60" aria-hidden="true" tabindex="-1"></a><span class="co"># Mixed models</span></span>
<span id="cb89-61"><a href="#cb89-61" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmmTMB)     <span class="co"># flexible GLMMs (NB, Gamma, etc.)</span></span>
<span id="cb89-62"><a href="#cb89-62" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)        <span class="co"># LMMs (fallback)</span></span>
<span id="cb89-63"><a href="#cb89-63" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)     <span class="co"># estimated marginal means / contrasts</span></span>
<span id="cb89-64"><a href="#cb89-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-65"><a href="#cb89-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Diagnostics</span></span>
<span id="cb89-66"><a href="#cb89-66" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)      <span class="co"># residual simulation diagnostics for GLMMs</span></span>
<span id="cb89-67"><a href="#cb89-67" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(performance) <span class="co"># assumption checks / R2 / collinearity</span></span>
<span id="cb89-68"><a href="#cb89-68" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co"># tidy() for mixed models</span></span>
<span id="cb89-69"><a href="#cb89-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-70"><a href="#cb89-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Multivariate community ecology</span></span>
<span id="cb89-71"><a href="#cb89-71" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)       <span class="co"># adonis2, metaMDS, betadisper, envfit</span></span>
<span id="cb89-72"><a href="#cb89-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pairwiseAdonis) <span class="co"># optional; pairwise PERMANOVA if needed</span></span>
<span id="cb89-73"><a href="#cb89-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-74"><a href="#cb89-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Figures</span></span>
<span id="cb89-75"><a href="#cb89-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggdist)      <span class="co"># raincloud/half-eye</span></span>
<span id="cb89-76"><a href="#cb89-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)   <span class="co"># figure layouts</span></span>
<span id="cb89-77"><a href="#cb89-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)      <span class="co"># label_percent etc.</span></span>
<span id="cb89-78"><a href="#cb89-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb89-79"><a href="#cb89-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-80"><a href="#cb89-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-81"><a href="#cb89-81" aria-hidden="true" tabindex="-1"></a><span class="co"># A consistent plotting theme for a paper</span></span>
<span id="cb89-82"><a href="#cb89-82" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(</span>
<span id="cb89-83"><a href="#cb89-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span> <span class="co"># base size text is 14</span></span>
<span id="cb89-84"><a href="#cb89-84" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb89-85"><a href="#cb89-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb89-86"><a href="#cb89-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb89-87"><a href="#cb89-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb89-88"><a href="#cb89-88" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb89-89"><a href="#cb89-89" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-90"><a href="#cb89-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-91"><a href="#cb89-91" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper: safe logit transform for proportions in [0,1]</span></span>
<span id="cb89-92"><a href="#cb89-92" aria-hidden="true" tabindex="-1"></a><span class="co"># (useful for cover variables with 0s and 1s)</span></span>
<span id="cb89-93"><a href="#cb89-93" aria-hidden="true" tabindex="-1"></a>logit01 <span class="ot">&lt;-</span> <span class="cf">function</span>(p, <span class="at">eps =</span> <span class="fl">1e-4</span>) {</span>
<span id="cb89-94"><a href="#cb89-94" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(<span class="fu">pmax</span>(p, eps), <span class="dv">1</span> <span class="sc">-</span> eps)</span>
<span id="cb89-95"><a href="#cb89-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">qlogis</span>(p2)</span>
<span id="cb89-96"><a href="#cb89-96" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb89-97"><a href="#cb89-97" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-98"><a href="#cb89-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-99"><a href="#cb89-99" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-100"><a href="#cb89-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-101"><a href="#cb89-101" aria-hidden="true" tabindex="-1"></a><span class="fu">## Import data</span></span>
<span id="cb89-102"><a href="#cb89-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-103"><a href="#cb89-103" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; **Paths** assume the files are in the same folder as this Quarto file, or are in the working directory.</span></span>
<span id="cb89-104"><a href="#cb89-104" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; When you move this notebook to the scripts folder and the data files into your data folder, update paths below. </span></span>
<span id="cb89-105"><a href="#cb89-105" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Note, I edited these files to remove the transects removed in your other script and to just bring in the normalized community composition data</span></span>
<span id="cb89-106"><a href="#cb89-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-109"><a href="#cb89-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-110"><a href="#cb89-110" aria-hidden="true" tabindex="-1"></a><span class="co"># File paths (edit if needed)</span></span>
<span id="cb89-111"><a href="#cb89-111" aria-hidden="true" tabindex="-1"></a>path_size   <span class="ot">&lt;-</span> <span class="st">"limpet_size.csv"</span></span>
<span id="cb89-112"><a href="#cb89-112" aria-hidden="true" tabindex="-1"></a>path_mobile <span class="ot">&lt;-</span> <span class="st">"mobile_counts.csv"</span></span>
<span id="cb89-113"><a href="#cb89-113" aria-hidden="true" tabindex="-1"></a>path_sess   <span class="ot">&lt;-</span> <span class="st">"sessile_percent_cover.csv"</span></span>
<span id="cb89-114"><a href="#cb89-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-115"><a href="#cb89-115" aria-hidden="true" tabindex="-1"></a>limpet_size_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_size, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>() <span class="sc">%&gt;%</span></span>
<span id="cb89-116"><a href="#cb89-116" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">season =</span> <span class="fu">ifelse</span>(season <span class="sc">==</span> <span class="st">"Late_Spring"</span>, <span class="st">"Spring"</span>, season)) <span class="co"># for some reason the season is named Late spring here, but spring everywhere else</span></span>
<span id="cb89-117"><a href="#cb89-117" aria-hidden="true" tabindex="-1"></a>mobile_raw      <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_mobile, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb89-118"><a href="#cb89-118" aria-hidden="true" tabindex="-1"></a>sessile_raw     <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(path_sess, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> <span class="fu">clean_names</span>()</span>
<span id="cb89-119"><a href="#cb89-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-120"><a href="#cb89-120" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(limpet_size_raw)</span>
<span id="cb89-121"><a href="#cb89-121" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(mobile_raw)</span>
<span id="cb89-122"><a href="#cb89-122" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(sessile_raw)</span>
<span id="cb89-123"><a href="#cb89-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-124"><a href="#cb89-124" aria-hidden="true" tabindex="-1"></a><span class="co"># to standardize the colors throughout the manuscript</span></span>
<span id="cb89-125"><a href="#cb89-125" aria-hidden="true" tabindex="-1"></a>season_colors <span class="ot">&lt;-</span> <span class="fu">c</span>( </span>
<span id="cb89-126"><a href="#cb89-126" aria-hidden="true" tabindex="-1"></a>  <span class="at">Winter =</span> <span class="st">"#1F4E79"</span>,</span>
<span id="cb89-127"><a href="#cb89-127" aria-hidden="true" tabindex="-1"></a>  <span class="at">Spring =</span> <span class="st">"#2E8B57"</span>,</span>
<span id="cb89-128"><a href="#cb89-128" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fall   =</span> <span class="st">"#C65D2E"</span></span>
<span id="cb89-129"><a href="#cb89-129" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-130"><a href="#cb89-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-131"><a href="#cb89-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-132"><a href="#cb89-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-133"><a href="#cb89-133" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-134"><a href="#cb89-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-135"><a href="#cb89-135" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data cleaning and harmonization</span></span>
<span id="cb89-136"><a href="#cb89-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-137"><a href="#cb89-137" aria-hidden="true" tabindex="-1"></a>We standardize:</span>
<span id="cb89-138"><a href="#cb89-138" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`season`</span> as an **ordered factor**</span>
<span id="cb89-139"><a href="#cb89-139" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`date`</span> as a real date (best-effort parse for differences across datasets)</span>
<span id="cb89-140"><a href="#cb89-140" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`col_pres`</span> to **Yes/No** factor</span>
<span id="cb89-141"><a href="#cb89-141" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>key grouping variables (<span class="in">`transect`</span>, <span class="in">`plot_name`</span>, etc.)</span>
<span id="cb89-142"><a href="#cb89-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-145"><a href="#cb89-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-146"><a href="#cb89-146" aria-hidden="true" tabindex="-1"></a><span class="co"># Season order </span></span>
<span id="cb89-147"><a href="#cb89-147" aria-hidden="true" tabindex="-1"></a>season_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Winter"</span>,<span class="st">"Spring"</span>,<span class="st">"Summer"</span>,<span class="st">"Fall"</span>) <span class="co"># change this order to change order of the plots</span></span>
<span id="cb89-148"><a href="#cb89-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-149"><a href="#cb89-149" aria-hidden="true" tabindex="-1"></a><span class="co"># Limpet size dataset</span></span>
<span id="cb89-150"><a href="#cb89-150" aria-hidden="true" tabindex="-1"></a>limpet_size <span class="ot">&lt;-</span> limpet_size_raw <span class="sc">%&gt;%</span></span>
<span id="cb89-151"><a href="#cb89-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb89-152"><a href="#cb89-152" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb89-153"><a href="#cb89-153" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dataset stores date as "YYYY_MM_DD" strings (e.g., 2023_09_29)</span></span>
<span id="cb89-154"><a href="#cb89-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb89-155"><a href="#cb89-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb89-156"><a href="#cb89-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_side =</span> <span class="fu">as.factor</span>(plot_side),</span>
<span id="cb89-157"><a href="#cb89-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">sl_mm =</span> <span class="fu">as.numeric</span>(sl_mm)</span>
<span id="cb89-158"><a href="#cb89-158" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb89-159"><a href="#cb89-159" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(season), <span class="sc">!</span><span class="fu">is.na</span>(sl_mm)) <span class="co"># remove the rows with NAs in length or season</span></span>
<span id="cb89-160"><a href="#cb89-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-161"><a href="#cb89-161" aria-hidden="true" tabindex="-1"></a><span class="co"># Mobile invertebrate counts</span></span>
<span id="cb89-162"><a href="#cb89-162" aria-hidden="true" tabindex="-1"></a>mobile <span class="ot">&lt;-</span> mobile_raw <span class="sc">%&gt;%</span></span>
<span id="cb89-163"><a href="#cb89-163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb89-164"><a href="#cb89-164" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb89-165"><a href="#cb89-165" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb89-166"><a href="#cb89-166" aria-hidden="true" tabindex="-1"></a>    <span class="at">transect =</span> <span class="fu">as.factor</span>(transect),</span>
<span id="cb89-167"><a href="#cb89-167" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb89-168"><a href="#cb89-168" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_pres =</span> <span class="fu">case_when</span>(</span>
<span id="cb89-169"><a href="#cb89-169" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"y"</span>,<span class="st">"yes"</span>,<span class="st">"true"</span>,<span class="st">"t"</span>,<span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb89-170"><a href="#cb89-170" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"n"</span>,<span class="st">"no"</span>,<span class="st">"false"</span>,<span class="st">"f"</span>,<span class="st">"0"</span>) <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb89-171"><a href="#cb89-171" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb89-172"><a href="#cb89-172" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>))</span>
<span id="cb89-173"><a href="#cb89-173" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-174"><a href="#cb89-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-175"><a href="#cb89-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Sessile percent cover (in this file, cover columns appear to be proportions already: 0–1)</span></span>
<span id="cb89-176"><a href="#cb89-176" aria-hidden="true" tabindex="-1"></a>sessile <span class="ot">&lt;-</span> sessile_raw <span class="sc">%&gt;%</span></span>
<span id="cb89-177"><a href="#cb89-177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb89-178"><a href="#cb89-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">season =</span> <span class="fu">factor</span>(season, <span class="at">levels =</span> season_levels),</span>
<span id="cb89-179"><a href="#cb89-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">date =</span> <span class="fu">parse_date_time</span>(date, <span class="at">orders =</span> <span class="fu">c</span>(<span class="st">"Y_m_d"</span>, <span class="st">"Y_m"</span>, <span class="st">"Y-m-d"</span>, <span class="st">"Y/m/d"</span>)) <span class="sc">%&gt;%</span> <span class="fu">as_date</span>(),</span>
<span id="cb89-180"><a href="#cb89-180" aria-hidden="true" tabindex="-1"></a>    <span class="at">transect =</span> <span class="fu">as.factor</span>(transect),</span>
<span id="cb89-181"><a href="#cb89-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot_name =</span> <span class="fu">as.factor</span>(plot_name),</span>
<span id="cb89-182"><a href="#cb89-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_pres =</span> <span class="fu">case_when</span>(</span>
<span id="cb89-183"><a href="#cb89-183" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"y"</span>,<span class="st">"yes"</span>,<span class="st">"true"</span>,<span class="st">"t"</span>,<span class="st">"1"</span>) <span class="sc">~</span> <span class="st">"Yes"</span>,</span>
<span id="cb89-184"><a href="#cb89-184" aria-hidden="true" tabindex="-1"></a>      <span class="fu">tolower</span>(col_pres) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"n"</span>,<span class="st">"no"</span>,<span class="st">"false"</span>,<span class="st">"f"</span>,<span class="st">"0"</span>) <span class="sc">~</span> <span class="st">"No"</span>,</span>
<span id="cb89-185"><a href="#cb89-185" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb89-186"><a href="#cb89-186" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No"</span>,<span class="st">"Yes"</span>))</span>
<span id="cb89-187"><a href="#cb89-187" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-188"><a href="#cb89-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-189"><a href="#cb89-189" aria-hidden="true" tabindex="-1"></a><span class="co"># Quick checks</span></span>
<span id="cb89-190"><a href="#cb89-190" aria-hidden="true" tabindex="-1"></a>limpet_size <span class="sc">%&gt;%</span> <span class="fu">count</span>(season)</span>
<span id="cb89-191"><a href="#cb89-191" aria-hidden="true" tabindex="-1"></a>mobile <span class="sc">%&gt;%</span> <span class="fu">count</span>(season, col_pres) </span>
<span id="cb89-192"><a href="#cb89-192" aria-hidden="true" tabindex="-1"></a>sessile <span class="sc">%&gt;%</span> <span class="fu">count</span>(season, col_pres) <span class="do">## looks like there are missing pairs of col present</span></span>
<span id="cb89-193"><a href="#cb89-193" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-194"><a href="#cb89-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-195"><a href="#cb89-195" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-196"><a href="#cb89-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-197"><a href="#cb89-197" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 1: Do limpet density and size change by season?</span></span>
<span id="cb89-198"><a href="#cb89-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-199"><a href="#cb89-199" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1A. Density (true density; transect area = 50 m²)</span></span>
<span id="cb89-200"><a href="#cb89-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-201"><a href="#cb89-201" aria-hidden="true" tabindex="-1"></a>You specified that each limpet-density sampling unit corresponds to a **50 m² transect**.</span>
<span id="cb89-202"><a href="#cb89-202" aria-hidden="true" tabindex="-1"></a>We therefore compute:</span>
<span id="cb89-203"><a href="#cb89-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-204"><a href="#cb89-204" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`n_limpets`</span> = number of limpets observed in a sampling unit</span>
<span id="cb89-205"><a href="#cb89-205" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`density_m2`</span> = <span class="in">`n_limpets / 50`</span></span>
<span id="cb89-206"><a href="#cb89-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-209"><a href="#cb89-209" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-210"><a href="#cb89-210" aria-hidden="true" tabindex="-1"></a>limpet_density <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb89-211"><a href="#cb89-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(season, date, plot_name) <span class="sc">%&gt;%</span></span>
<span id="cb89-212"><a href="#cb89-212" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb89-213"><a href="#cb89-213" aria-hidden="true" tabindex="-1"></a>    <span class="at">n_limpets =</span> <span class="fu">n</span>(),<span class="co"># count all the limpets</span></span>
<span id="cb89-214"><a href="#cb89-214" aria-hidden="true" tabindex="-1"></a>    <span class="co"># True density (per m²) using known transect area</span></span>
<span id="cb89-215"><a href="#cb89-215" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="dv">50</span>, <span class="do">## double check this is correct. How long was the transect and how many meters on either size of the transect did you go? </span></span>
<span id="cb89-216"><a href="#cb89-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_m2 =</span> n_limpets <span class="sc">/</span> area_m2,</span>
<span id="cb89-217"><a href="#cb89-217" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_sl =</span> <span class="fu">mean</span>(sl_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># mean size per transect</span></span>
<span id="cb89-218"><a href="#cb89-218" aria-hidden="true" tabindex="-1"></a>    <span class="at">sd_sl =</span> <span class="fu">sd</span>(sl_mm, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="co"># standard deviation in size per transect</span></span>
<span id="cb89-219"><a href="#cb89-219" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span> <span class="co"># drop the groupings</span></span>
<span id="cb89-220"><a href="#cb89-220" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-221"><a href="#cb89-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-222"><a href="#cb89-222" aria-hidden="true" tabindex="-1"></a>limpet_density <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span>
<span id="cb89-223"><a href="#cb89-223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-224"><a href="#cb89-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-225"><a href="#cb89-225" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Exploratory plot (density by season)</span></span>
<span id="cb89-226"><a href="#cb89-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-229"><a href="#cb89-229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-230"><a href="#cb89-230" aria-hidden="true" tabindex="-1"></a>p_density <span class="ot">&lt;-</span> limpet_density <span class="sc">%&gt;%</span></span>
<span id="cb89-231"><a href="#cb89-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb89-232"><a href="#cb89-232" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2, <span class="at">fill =</span> season),<span class="at">adjust =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.15</span>) <span class="sc">+</span></span>
<span id="cb89-233"><a href="#cb89-233" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.18</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span> <span class="do">## this removes the outliers from the boxplot-- only OK because I also have the stat_halfeye and the jitter</span></span>
<span id="cb89-234"><a href="#cb89-234" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.35</span>) <span class="sc">+</span></span>
<span id="cb89-235"><a href="#cb89-235" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Owl limpet density (individuals m⁻²)"</span></span>
<span id="cb89-236"><a href="#cb89-236" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal variation in owl limpet density"</span></span>
<span id="cb89-237"><a href="#cb89-237" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb89-238"><a href="#cb89-238" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb89-239"><a href="#cb89-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb89-240"><a href="#cb89-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))<span class="sc">+</span></span>
<span id="cb89-241"><a href="#cb89-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb89-242"><a href="#cb89-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-243"><a href="#cb89-243" aria-hidden="true" tabindex="-1"></a>p_density</span>
<span id="cb89-244"><a href="#cb89-244" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-245"><a href="#cb89-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-246"><a href="#cb89-246" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model: negative binomial GLMM (random effects for plot)</span></span>
<span id="cb89-247"><a href="#cb89-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-248"><a href="#cb89-248" aria-hidden="true" tabindex="-1"></a>Counts are typically overdispersed; negative binomial is usually appropriate.</span>
<span id="cb89-249"><a href="#cb89-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-252"><a href="#cb89-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-253"><a href="#cb89-253" aria-hidden="true" tabindex="-1"></a>m_density <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb89-254"><a href="#cb89-254" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts because negative binomial requires count data with an offset for sampled area to estimate density</span></span>
<span id="cb89-255"><a href="#cb89-255" aria-hidden="true" tabindex="-1"></a>  n_limpets <span class="sc">~</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot_name),</span>
<span id="cb89-256"><a href="#cb89-256" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb89-257"><a href="#cb89-257" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> limpet_density</span>
<span id="cb89-258"><a href="#cb89-258" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-259"><a href="#cb89-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-260"><a href="#cb89-260" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_density)</span>
<span id="cb89-261"><a href="#cb89-261" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_overdispersion</span>(m_density)</span>
<span id="cb89-262"><a href="#cb89-262" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_zeroinflation</span>(m_density)</span>
<span id="cb89-263"><a href="#cb89-263" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-264"><a href="#cb89-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-265"><a href="#cb89-265" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics (DHARMa)</span></span>
<span id="cb89-266"><a href="#cb89-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-269"><a href="#cb89-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-270"><a href="#cb89-270" aria-hidden="true" tabindex="-1"></a>sim_density <span class="ot">&lt;-</span> DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(m_density, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb89-271"><a href="#cb89-271" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_density)</span>
<span id="cb89-272"><a href="#cb89-272" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testDispersion</span>(sim_density)</span>
<span id="cb89-273"><a href="#cb89-273" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testZeroInflation</span>(sim_density)</span>
<span id="cb89-274"><a href="#cb89-274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-275"><a href="#cb89-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-276"><a href="#cb89-276" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Effect sizes: estimated marginal means and contrasts</span></span>
<span id="cb89-277"><a href="#cb89-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-280"><a href="#cb89-280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-281"><a href="#cb89-281" aria-hidden="true" tabindex="-1"></a>emm_density <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_density, <span class="sc">~</span> season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb89-282"><a href="#cb89-282" aria-hidden="true" tabindex="-1"></a><span class="co"># With the area offset, 'response' is on the expected count scale; divide by area to report density</span></span>
<span id="cb89-283"><a href="#cb89-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-284"><a href="#cb89-284" aria-hidden="true" tabindex="-1"></a>emm_density</span>
<span id="cb89-285"><a href="#cb89-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-286"><a href="#cb89-286" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_density, <span class="at">adjust =</span> <span class="st">"tukey"</span>) </span>
<span id="cb89-287"><a href="#cb89-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-288"><a href="#cb89-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-289"><a href="#cb89-289" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Figure showing the actual model results: model-based means with uncertainty</span></span>
<span id="cb89-290"><a href="#cb89-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-293"><a href="#cb89-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-294"><a href="#cb89-294" aria-hidden="true" tabindex="-1"></a>df_density_emm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_density) <span class="sc">%&gt;%</span></span>
<span id="cb89-295"><a href="#cb89-295" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb89-296"><a href="#cb89-296" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="dv">50</span>,</span>
<span id="cb89-297"><a href="#cb89-297" aria-hidden="true" tabindex="-1"></a>    <span class="at">density =</span> response <span class="sc">/</span> area_m2,</span>
<span id="cb89-298"><a href="#cb89-298" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_lower =</span> asymp.LCL <span class="sc">/</span> area_m2,</span>
<span id="cb89-299"><a href="#cb89-299" aria-hidden="true" tabindex="-1"></a>    <span class="at">density_upper =</span> asymp.UCL <span class="sc">/</span> area_m2</span>
<span id="cb89-300"><a href="#cb89-300" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-301"><a href="#cb89-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-302"><a href="#cb89-302" aria-hidden="true" tabindex="-1"></a><span class="co"># Note add in stars or letters or brackets based on significance testing from the emmeans</span></span>
<span id="cb89-303"><a href="#cb89-303" aria-hidden="true" tabindex="-1"></a>p_density_emm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_density_emm, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density)) <span class="sc">+</span></span>
<span id="cb89-304"><a href="#cb89-304" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data =</span> limpet_density, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> density_m2), </span>
<span id="cb89-305"><a href="#cb89-305" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.5</span>, <span class="at">width =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb89-306"><a href="#cb89-306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb89-307"><a href="#cb89-307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> density_lower, <span class="at">ymax =</span> density_upper), <span class="at">width =</span> <span class="fl">0.12</span>) <span class="sc">+</span></span>
<span id="cb89-308"><a href="#cb89-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Estimated owl limpet density (individuals m⁻²)"</span>,</span>
<span id="cb89-309"><a href="#cb89-309" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Seasonal effect on owl limpet density (model-based NB-GLMM with area offset)"</span>) <span class="sc">+</span></span>
<span id="cb89-310"><a href="#cb89-310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))</span>
<span id="cb89-311"><a href="#cb89-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-312"><a href="#cb89-312" aria-hidden="true" tabindex="-1"></a>p_density_emm</span>
<span id="cb89-313"><a href="#cb89-313" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-314"><a href="#cb89-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-315"><a href="#cb89-315" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-316"><a href="#cb89-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-317"><a href="#cb89-317" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1B. Size (`sl_mm`) by season</span></span>
<span id="cb89-318"><a href="#cb89-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-319"><a href="#cb89-319" aria-hidden="true" tabindex="-1"></a>Because <span class="in">`sl_mm`</span> is continuous and strictly positive, we typically choose either:</span>
<span id="cb89-320"><a href="#cb89-320" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Gamma GLMM** or **Tweedie GLMM** with log link, or</span>
<span id="cb89-321"><a href="#cb89-321" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**LMM** on log-transformed sizes.</span>
<span id="cb89-322"><a href="#cb89-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-323"><a href="#cb89-323" aria-hidden="true" tabindex="-1"></a>Here, we start with **Gamma GLMM** and fallback if needed.</span>
<span id="cb89-324"><a href="#cb89-324" aria-hidden="true" tabindex="-1"></a>The **Gamma** was not a good fit so I went to *Tweedie* which was better but still not great. Keep looking.... the bimodal sizes makes this harder</span>
<span id="cb89-325"><a href="#cb89-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-328"><a href="#cb89-328" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-329"><a href="#cb89-329" aria-hidden="true" tabindex="-1"></a>p_size <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb89-330"><a href="#cb89-330" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> sl_mm, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb89-331"><a href="#cb89-331" aria-hidden="true" tabindex="-1"></a>  ggdist<span class="sc">::</span><span class="fu">stat_halfeye</span>(<span class="at">adjust =</span> <span class="fl">0.7</span>, <span class="at">width =</span> <span class="fl">0.6</span>, <span class="at">justification =</span> <span class="sc">-</span><span class="fl">0.15</span>, <span class="fu">aes</span>(<span class="at">fill =</span> season)) <span class="sc">+</span></span>
<span id="cb89-332"><a href="#cb89-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.18</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb89-333"><a href="#cb89-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.08</span>, <span class="at">height =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.20</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb89-334"><a href="#cb89-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Shell length (mm)"</span></span>
<span id="cb89-335"><a href="#cb89-335" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Owl limpet size distribution by season"</span></span>
<span id="cb89-336"><a href="#cb89-336" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb89-337"><a href="#cb89-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))<span class="sc">+</span></span>
<span id="cb89-338"><a href="#cb89-338" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb89-339"><a href="#cb89-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb89-340"><a href="#cb89-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb89-341"><a href="#cb89-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-342"><a href="#cb89-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-343"><a href="#cb89-343" aria-hidden="true" tabindex="-1"></a>p_size</span>
<span id="cb89-344"><a href="#cb89-344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-345"><a href="#cb89-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-346"><a href="#cb89-346" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Gamma  or Tweedie GLMM with random effects for plot</span></span>
<span id="cb89-347"><a href="#cb89-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-350"><a href="#cb89-350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-351"><a href="#cb89-351" aria-hidden="true" tabindex="-1"></a>m_size_gamma <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb89-352"><a href="#cb89-352" aria-hidden="true" tabindex="-1"></a>  sl_mm <span class="sc">~</span> season <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> plot_name),</span>
<span id="cb89-353"><a href="#cb89-353" aria-hidden="true" tabindex="-1"></a>  <span class="at">dispformula =</span> <span class="sc">~</span> season,  <span class="co"># Model dispersion as a function of season because unequal variances</span></span>
<span id="cb89-354"><a href="#cb89-354" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">tweedie</span>(<span class="at">link =</span> <span class="st">"log"</span>), <span class="co"># better but still not the best, but I trust more this model</span></span>
<span id="cb89-355"><a href="#cb89-355" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> limpet_size</span>
<span id="cb89-356"><a href="#cb89-356" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-357"><a href="#cb89-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-358"><a href="#cb89-358" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_size_gamma)</span>
<span id="cb89-359"><a href="#cb89-359" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-360"><a href="#cb89-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-361"><a href="#cb89-361" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Diagnostics</span></span>
<span id="cb89-362"><a href="#cb89-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-365"><a href="#cb89-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-366"><a href="#cb89-366" aria-hidden="true" tabindex="-1"></a>sim_size <span class="ot">&lt;-</span> DHARMa<span class="sc">::</span><span class="fu">simulateResiduals</span>(m_size_gamma, <span class="at">n =</span> <span class="dv">1000</span>)</span>
<span id="cb89-367"><a href="#cb89-367" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sim_size)</span>
<span id="cb89-368"><a href="#cb89-368" aria-hidden="true" tabindex="-1"></a>DHARMa<span class="sc">::</span><span class="fu">testDispersion</span>(sim_size)</span>
<span id="cb89-369"><a href="#cb89-369" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-370"><a href="#cb89-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-371"><a href="#cb89-371" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Estimated marginal means (back-transformed to mm)</span></span>
<span id="cb89-372"><a href="#cb89-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-375"><a href="#cb89-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-376"><a href="#cb89-376" aria-hidden="true" tabindex="-1"></a>emm_size <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_size_gamma, <span class="sc">~</span> season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb89-377"><a href="#cb89-377" aria-hidden="true" tabindex="-1"></a>emm_size</span>
<span id="cb89-378"><a href="#cb89-378" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_size, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb89-379"><a href="#cb89-379" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-380"><a href="#cb89-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-381"><a href="#cb89-381" aria-hidden="true" tabindex="-1"></a><span class="fu">##### Figure: model-based seasonal means</span></span>
<span id="cb89-382"><a href="#cb89-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-385"><a href="#cb89-385" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-386"><a href="#cb89-386" aria-hidden="true" tabindex="-1"></a>df_size_emm <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(emm_size)</span>
<span id="cb89-387"><a href="#cb89-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-388"><a href="#cb89-388" aria-hidden="true" tabindex="-1"></a>p_size_emm <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_size_emm, <span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> response)) <span class="sc">+</span></span>
<span id="cb89-389"><a href="#cb89-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb89-390"><a href="#cb89-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> asymp.LCL, <span class="at">ymax =</span> asymp.UCL), <span class="at">width =</span> <span class="fl">0.12</span>) <span class="sc">+</span></span>
<span id="cb89-391"><a href="#cb89-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Estimated mean shell length (mm)"</span>,</span>
<span id="cb89-392"><a href="#cb89-392" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal effect on owl limpet size (Gamma GLMM)"</span></span>
<span id="cb89-393"><a href="#cb89-393" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb89-394"><a href="#cb89-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.08</span>)))</span>
<span id="cb89-395"><a href="#cb89-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-396"><a href="#cb89-396" aria-hidden="true" tabindex="-1"></a>p_size_emm</span>
<span id="cb89-397"><a href="#cb89-397" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-398"><a href="#cb89-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-399"><a href="#cb89-399" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Different kind of visual to look at size structure shifts (CDFs)</span></span>
<span id="cb89-400"><a href="#cb89-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-401"><a href="#cb89-401" aria-hidden="true" tabindex="-1"></a>Cumulative distributions are great for communicating shifts in size structure (e.g., truncation).</span>
<span id="cb89-402"><a href="#cb89-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-403"><a href="#cb89-403" aria-hidden="true" tabindex="-1"></a>You would interprethis this plot byt saying: “For each season, what fraction of limpets are smaller than a given shell length?” </span>
<span id="cb89-404"><a href="#cb89-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-405"><a href="#cb89-405" aria-hidden="true" tabindex="-1"></a>Example interpretations of the plot</span>
<span id="cb89-406"><a href="#cb89-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-407"><a href="#cb89-407" aria-hidden="true" tabindex="-1"></a>Steeper ECDF at small sizes in Spring</span>
<span id="cb89-408"><a href="#cb89-408" aria-hidden="true" tabindex="-1"></a>→ Maybe recent recruitment or better post-settlement survival</span>
<span id="cb89-409"><a href="#cb89-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-410"><a href="#cb89-410" aria-hidden="true" tabindex="-1"></a>Right-shifted ECDF in Fall/Summer </span>
<span id="cb89-411"><a href="#cb89-411" aria-hidden="true" tabindex="-1"></a>→ growth of survivors after spring recruitment?</span>
<span id="cb89-412"><a href="#cb89-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-413"><a href="#cb89-413" aria-hidden="true" tabindex="-1"></a>These patterns often cannot be detected by mean-based models alone.</span>
<span id="cb89-414"><a href="#cb89-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-415"><a href="#cb89-415" aria-hidden="true" tabindex="-1"></a>“We visualized seasonal shifts in owl limpet size structure using empirical cumulative distribution functions (ECDFs), which depict the proportion of individuals that are smaller than a given shell length without assuming an underlying distribution.”</span>
<span id="cb89-418"><a href="#cb89-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-419"><a href="#cb89-419" aria-hidden="true" tabindex="-1"></a>p_cdf <span class="ot">&lt;-</span> limpet_size <span class="sc">%&gt;%</span></span>
<span id="cb89-420"><a href="#cb89-420" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sl_mm, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb89-421"><a href="#cb89-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ecdf</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb89-422"><a href="#cb89-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb89-423"><a href="#cb89-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Shell length (mm)"</span>, <span class="at">y =</span> <span class="st">"Empirical CDF"</span>,</span>
<span id="cb89-424"><a href="#cb89-424" aria-hidden="true" tabindex="-1"></a>       <span class="co">#title = "Seasonal shifts in size structure (ECDF)"</span></span>
<span id="cb89-425"><a href="#cb89-425" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb89-426"><a href="#cb89-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb89-427"><a href="#cb89-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-428"><a href="#cb89-428" aria-hidden="true" tabindex="-1"></a>p_cdf</span>
<span id="cb89-429"><a href="#cb89-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-430"><a href="#cb89-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-431"><a href="#cb89-431" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-432"><a href="#cb89-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-433"><a href="#cb89-433" aria-hidden="true" tabindex="-1"></a>You would start with the mean values that you get from the emmeans output of the size model, state if there are any differences and then interpretit this model. The empirical cumulative distribution functions (ECDFs) showed  seasonal differences in size structure beyond mean responses. For a given shell length, the proportion of individuals by size differed among seasons, indicating seasonal shifts in the relative abundance of small versus large individuals. In particular, Spring exhibited a higher proportion of small individuals across much of the size range, whereas Fall and Winter showed a right-shifted distribution consistent with a greater representation of larger individuals.</span>
<span id="cb89-434"><a href="#cb89-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-435"><a href="#cb89-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-438"><a href="#cb89-438" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-439"><a href="#cb89-439" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 14</span></span>
<span id="cb89-440"><a href="#cb89-440" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6</span></span>
<span id="cb89-441"><a href="#cb89-441" aria-hidden="true" tabindex="-1"></a><span class="do">## Bring the figures together for pub quality</span></span>
<span id="cb89-442"><a href="#cb89-442" aria-hidden="true" tabindex="-1"></a><span class="do">## Add in stars with brackes to show significance between seasons based on emmeans</span></span>
<span id="cb89-443"><a href="#cb89-443" aria-hidden="true" tabindex="-1"></a>(p_density<span class="sc">|</span>p_size<span class="sc">|</span>p_cdf)<span class="sc">+</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb89-444"><a href="#cb89-444" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"figure1.png"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb89-445"><a href="#cb89-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-446"><a href="#cb89-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-447"><a href="#cb89-447" aria-hidden="true" tabindex="-1"></a><span class="fu">## Question 2: Does limpet presence affect community composition, and does it interact with season?</span></span>
<span id="cb89-448"><a href="#cb89-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-449"><a href="#cb89-449" aria-hidden="true" tabindex="-1"></a>We analyze both:</span>
<span id="cb89-450"><a href="#cb89-450" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Mobile invertebrate counts** (multivariate &amp; univariate)</span>
<span id="cb89-451"><a href="#cb89-451" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Sessile cover composition** (multivariate &amp; univariate) --  I am having a hard time with the sessile data. Seems like everything is mostly bare rock and I am not sure what the microalgae are here</span>
<span id="cb89-452"><a href="#cb89-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-453"><a href="#cb89-453" aria-hidden="true" tabindex="-1"></a>Key fixed effects:</span>
<span id="cb89-454"><a href="#cb89-454" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`col_pres`</span> (No vs Yes)</span>
<span id="cb89-455"><a href="#cb89-455" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`season`</span></span>
<span id="cb89-456"><a href="#cb89-456" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`col_pres * season`</span> interaction</span>
<span id="cb89-457"><a href="#cb89-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-458"><a href="#cb89-458" aria-hidden="true" tabindex="-1"></a>Random/blocking structure:</span>
<span id="cb89-459"><a href="#cb89-459" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`transect`</span> is used for random effects and permutation strata (to respect spatial non-independence).</span>
<span id="cb89-460"><a href="#cb89-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-461"><a href="#cb89-461" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-462"><a href="#cb89-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-463"><a href="#cb89-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-464"><a href="#cb89-464" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2A. Mobile invertebrates (counts)</span></span>
<span id="cb89-465"><a href="#cb89-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-466"><a href="#cb89-466" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identify species columns</span></span>
<span id="cb89-467"><a href="#cb89-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-470"><a href="#cb89-470" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-471"><a href="#cb89-471" aria-hidden="true" tabindex="-1"></a><span class="co"># group by species groups first</span></span>
<span id="cb89-472"><a href="#cb89-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-473"><a href="#cb89-473" aria-hidden="true" tabindex="-1"></a>mobile_grouped<span class="ot">&lt;-</span>mobile <span class="sc">%&gt;%</span></span>
<span id="cb89-474"><a href="#cb89-474" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Limpets =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(l_limatula, l_scabra, l_gigantea))),</span>
<span id="cb89-475"><a href="#cb89-475" aria-hidden="true" tabindex="-1"></a>         <span class="at">Chitons =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(nuttallina_sp, mopalia_sp, l_hartwegii,l_dentiens))),</span>
<span id="cb89-476"><a href="#cb89-476" aria-hidden="true" tabindex="-1"></a>         <span class="at">Turbans =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(t_eiseni<span class="sc">:</span>t_gallina))),</span>
<span id="cb89-477"><a href="#cb89-477" aria-hidden="true" tabindex="-1"></a>         <span class="at">Periwinkles =</span> <span class="fu">rowSums</span>(<span class="fu">across</span>(<span class="fu">c</span>(l_plena, l_keenae))),</span>
<span id="cb89-478"><a href="#cb89-478" aria-hidden="true" tabindex="-1"></a>         <span class="at">Whelks =</span> m_lugubris) <span class="sc">%&gt;%</span></span>
<span id="cb89-479"><a href="#cb89-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(m_lugubris<span class="sc">:</span>l_gigantea))</span>
<span id="cb89-480"><a href="#cb89-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-481"><a href="#cb89-481" aria-hidden="true" tabindex="-1"></a><span class="co"># metadata</span></span>
<span id="cb89-482"><a href="#cb89-482" aria-hidden="true" tabindex="-1"></a>mobile_meta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"season"</span>,<span class="st">"date"</span>,<span class="st">"transect"</span>,<span class="st">"plot_name"</span>,<span class="st">"l_r"</span>,<span class="st">"meter_no"</span>,<span class="st">"col_pres"</span>,<span class="st">"t_f"</span>,<span class="st">"tag_id"</span>)</span>
<span id="cb89-483"><a href="#cb89-483" aria-hidden="true" tabindex="-1"></a>mobile_spp <span class="ot">&lt;-</span> mobile_grouped <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(mobile_meta))</span>
<span id="cb89-484"><a href="#cb89-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-485"><a href="#cb89-485" aria-hidden="true" tabindex="-1"></a><span class="co"># Sanity checks: are these non-negative counts?</span></span>
<span id="cb89-486"><a href="#cb89-486" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mobile_spp)</span>
<span id="cb89-487"><a href="#cb89-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-488"><a href="#cb89-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-489"><a href="#cb89-489" aria-hidden="true" tabindex="-1"></a><span class="fu">### Transformations for multivariate analyses</span></span>
<span id="cb89-490"><a href="#cb89-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-491"><a href="#cb89-491" aria-hidden="true" tabindex="-1"></a>For community composition, we typically:</span>
<span id="cb89-492"><a href="#cb89-492" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>use **gower** on square-root transformed counts since lots of zeros. Bray-Curtis did not work.</span>
<span id="cb89-493"><a href="#cb89-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-494"><a href="#cb89-494" aria-hidden="true" tabindex="-1"></a>For Gower, multiplying all counts by the same constant (e.g., converting to per m² when all plots have identical area) does **not** change dissimilarities; we still report univariate abundance in **m⁻²** for interpretability.</span>
<span id="cb89-495"><a href="#cb89-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-496"><a href="#cb89-496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-499"><a href="#cb89-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-500"><a href="#cb89-500" aria-hidden="true" tabindex="-1"></a>mobile_mat <span class="ot">&lt;-</span> mobile_spp <span class="sc">%&gt;%</span></span>
<span id="cb89-501"><a href="#cb89-501" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span> <span class="co"># make the missing values zeros</span></span>
<span id="cb89-502"><a href="#cb89-502" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb89-503"><a href="#cb89-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-504"><a href="#cb89-504" aria-hidden="true" tabindex="-1"></a><span class="co"># gower dissimilarity on sqrt counts because 0s present</span></span>
<span id="cb89-505"><a href="#cb89-505" aria-hidden="true" tabindex="-1"></a>mobile_bc <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">sqrt</span>(mobile_mat), <span class="at">method =</span> <span class="st">"gower"</span>)</span>
<span id="cb89-506"><a href="#cb89-506" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-507"><a href="#cb89-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-508"><a href="#cb89-508" aria-hidden="true" tabindex="-1"></a><span class="fu">### PERMANOVA (adonis2) with permutations constrained by transect</span></span>
<span id="cb89-509"><a href="#cb89-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-510"><a href="#cb89-510" aria-hidden="true" tabindex="-1"></a>This tests whether multivariate centroids differ by predictors.</span>
<span id="cb89-511"><a href="#cb89-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-514"><a href="#cb89-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-515"><a href="#cb89-515" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb89-516"><a href="#cb89-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-517"><a href="#cb89-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-518"><a href="#cb89-518" aria-hidden="true" tabindex="-1"></a>adon_mobile <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(</span>
<span id="cb89-519"><a href="#cb89-519" aria-hidden="true" tabindex="-1"></a>  mobile_bc <span class="sc">~</span> col_pres <span class="sc">*</span> season,</span>
<span id="cb89-520"><a href="#cb89-520" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile,</span>
<span id="cb89-521"><a href="#cb89-521" aria-hidden="true" tabindex="-1"></a>  <span class="at">permutations =</span> <span class="dv">999</span>,</span>
<span id="cb89-522"><a href="#cb89-522" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> mobile<span class="sc">$</span>transect</span>
<span id="cb89-523"><a href="#cb89-523" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-524"><a href="#cb89-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-525"><a href="#cb89-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-526"><a href="#cb89-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-527"><a href="#cb89-527" aria-hidden="true" tabindex="-1"></a>adon_mobile</span>
<span id="cb89-528"><a href="#cb89-528" aria-hidden="true" tabindex="-1"></a><span class="do">## Need to add in the pairwise differences-- follow up with this</span></span>
<span id="cb89-529"><a href="#cb89-529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-530"><a href="#cb89-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-531"><a href="#cb89-531" aria-hidden="true" tabindex="-1"></a><span class="fu">### Check dispersion (PERMDISP)</span></span>
<span id="cb89-532"><a href="#cb89-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-533"><a href="#cb89-533" aria-hidden="true" tabindex="-1"></a>PERMANOVA can be sensitive to differences in within-group dispersion.</span>
<span id="cb89-534"><a href="#cb89-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-537"><a href="#cb89-537" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-538"><a href="#cb89-538" aria-hidden="true" tabindex="-1"></a>disp_mobile <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(mobile_bc, <span class="fu">interaction</span>(mobile<span class="sc">$</span>col_pres, mobile<span class="sc">$</span>season))</span>
<span id="cb89-539"><a href="#cb89-539" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(disp_mobile)</span>
<span id="cb89-540"><a href="#cb89-540" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(disp_mobile, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb89-541"><a href="#cb89-541" aria-hidden="true" tabindex="-1"></a><span class="fu">TukeyHSD</span>(disp_mobile) <span class="co"># get pairwise differences</span></span>
<span id="cb89-542"><a href="#cb89-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-543"><a href="#cb89-543" aria-hidden="true" tabindex="-1"></a><span class="co"># Yes clearly very different dispersion (the size of the circle)--but driven by season based on pairwise</span></span>
<span id="cb89-544"><a href="#cb89-544" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-545"><a href="#cb89-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-546"><a href="#cb89-546" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ordination: NMDS (visualize patterns)</span></span>
<span id="cb89-547"><a href="#cb89-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-550"><a href="#cb89-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-551"><a href="#cb89-551" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2</span>)</span>
<span id="cb89-552"><a href="#cb89-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-553"><a href="#cb89-553" aria-hidden="true" tabindex="-1"></a>nmds_mobile <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(<span class="fu">sqrt</span>(mobile_mat), <span class="at">distance =</span> <span class="st">"gower"</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trymax =</span> <span class="dv">100</span>)</span>
<span id="cb89-554"><a href="#cb89-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-555"><a href="#cb89-555" aria-hidden="true" tabindex="-1"></a>nmds_mobile<span class="sc">$</span>stress <span class="co">#get the stress</span></span>
<span id="cb89-556"><a href="#cb89-556" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-557"><a href="#cb89-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-558"><a href="#cb89-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-561"><a href="#cb89-561" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-562"><a href="#cb89-562" aria-hidden="true" tabindex="-1"></a><span class="co"># --- NMDS biplot for MOBILE invertebrates ( species vectors) ----</span></span>
<span id="cb89-563"><a href="#cb89-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-564"><a href="#cb89-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-565"><a href="#cb89-565" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb89-566"><a href="#cb89-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-567"><a href="#cb89-567" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit species vectors to the NMDS using envfit</span></span>
<span id="cb89-568"><a href="#cb89-568" aria-hidden="true" tabindex="-1"></a><span class="co">#    - "display = 'species'" returns directions for each taxa</span></span>
<span id="cb89-569"><a href="#cb89-569" aria-hidden="true" tabindex="-1"></a><span class="co">#    - we fit to sqrt(mobile_mat) if NMDS was based on sqrt counts</span></span>
<span id="cb89-570"><a href="#cb89-570" aria-hidden="true" tabindex="-1"></a>fit_spp <span class="ot">&lt;-</span> <span class="fu">envfit</span>(nmds_mobile, <span class="fu">sqrt</span>(mobile_mat), <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb89-571"><a href="#cb89-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-572"><a href="#cb89-572" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract site scores</span></span>
<span id="cb89-573"><a href="#cb89-573" aria-hidden="true" tabindex="-1"></a>sites_df <span class="ot">&lt;-</span> <span class="fu">scores</span>(nmds_mobile, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-574"><a href="#cb89-574" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb89-575"><a href="#cb89-575" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"site_id"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-576"><a href="#cb89-576" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(mobile_grouped <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">site_id =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> <span class="fu">select</span>(site_id, season, col_pres, transect))</span>
<span id="cb89-577"><a href="#cb89-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-578"><a href="#cb89-578" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract species vectors + p-values; keep only significant / strong ones</span></span>
<span id="cb89-579"><a href="#cb89-579" aria-hidden="true" tabindex="-1"></a>vec_df <span class="ot">&lt;-</span> <span class="fu">scores</span>(fit_spp, <span class="at">display =</span> <span class="st">"vectors"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-580"><a href="#cb89-580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb89-581"><a href="#cb89-581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">"taxon"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-582"><a href="#cb89-582" aria-hidden="true" tabindex="-1"></a>  <span class="co"># p-values are in fit_spp$vectors$pvals; same order as rows in scores()</span></span>
<span id="cb89-583"><a href="#cb89-583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> fit_spp<span class="sc">$</span>vectors<span class="sc">$</span>pvals) <span class="sc">%&gt;%</span></span>
<span id="cb89-584"><a href="#cb89-584" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vector strength (longer = stronger relationship with ordination)</span></span>
<span id="cb89-585"><a href="#cb89-585" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">r =</span> <span class="fu">sqrt</span>(NMDS1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> NMDS2<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb89-586"><a href="#cb89-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(p) <span class="do">## all the species have significant vectors</span></span>
<span id="cb89-587"><a href="#cb89-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-588"><a href="#cb89-588" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose which taxa to label: either significant + top N by vector length</span></span>
<span id="cb89-589"><a href="#cb89-589" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb89-590"><a href="#cb89-590" aria-hidden="true" tabindex="-1"></a>top_n <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb89-591"><a href="#cb89-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-592"><a href="#cb89-592" aria-hidden="true" tabindex="-1"></a>vec_keep <span class="ot">&lt;-</span> vec_df <span class="sc">%&gt;%</span></span>
<span id="cb89-593"><a href="#cb89-593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p <span class="sc">&lt;=</span> alpha) <span class="sc">%&gt;%</span></span>
<span id="cb89-594"><a href="#cb89-594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(<span class="at">order_by =</span> r, <span class="at">n =</span> top_n)</span>
<span id="cb89-595"><a href="#cb89-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-596"><a href="#cb89-596" aria-hidden="true" tabindex="-1"></a><span class="co"># Scale vectors to match plot extent (so arrows look nice)</span></span>
<span id="cb89-597"><a href="#cb89-597" aria-hidden="true" tabindex="-1"></a><span class="co">#    This rescales arrows relative to NMDS axes range.</span></span>
<span id="cb89-598"><a href="#cb89-598" aria-hidden="true" tabindex="-1"></a>arrow_mult <span class="ot">&lt;-</span> <span class="fl">0.85</span> <span class="sc">*</span> <span class="fu">min</span>(</span>
<span id="cb89-599"><a href="#cb89-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="fu">range</span>(sites_df<span class="sc">$</span>NMDS1)) <span class="sc">/</span> <span class="fu">diff</span>(<span class="fu">range</span>(vec_keep<span class="sc">$</span>NMDS1)),</span>
<span id="cb89-600"><a href="#cb89-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diff</span>(<span class="fu">range</span>(sites_df<span class="sc">$</span>NMDS2)) <span class="sc">/</span> <span class="fu">diff</span>(<span class="fu">range</span>(vec_keep<span class="sc">$</span>NMDS2))</span>
<span id="cb89-601"><a href="#cb89-601" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-602"><a href="#cb89-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-603"><a href="#cb89-603" aria-hidden="true" tabindex="-1"></a>vec_keep <span class="ot">&lt;-</span> vec_keep <span class="sc">%&gt;%</span></span>
<span id="cb89-604"><a href="#cb89-604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NMDS1 =</span> NMDS1 <span class="sc">*</span> arrow_mult,</span>
<span id="cb89-605"><a href="#cb89-605" aria-hidden="true" tabindex="-1"></a>         <span class="at">NMDS2 =</span> NMDS2 <span class="sc">*</span> arrow_mult)</span>
<span id="cb89-606"><a href="#cb89-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-607"><a href="#cb89-607" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot: sites + ellipses + species vectors (biplot)</span></span>
<span id="cb89-608"><a href="#cb89-608" aria-hidden="true" tabindex="-1"></a>p_biplot_mobile <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(sites_df, <span class="fu">aes</span>(NMDS1, NMDS2)) <span class="sc">+</span></span>
<span id="cb89-609"><a href="#cb89-609" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sites</span></span>
<span id="cb89-610"><a href="#cb89-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> season, <span class="at">shape =</span> col_pres), <span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb89-611"><a href="#cb89-611" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Group ellipses</span></span>
<span id="cb89-612"><a href="#cb89-612" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(season, col_pres), <span class="at">color =</span> season),</span>
<span id="cb89-613"><a href="#cb89-613" aria-hidden="true" tabindex="-1"></a>               <span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">linewidth =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb89-614"><a href="#cb89-614" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Species arrows</span></span>
<span id="cb89-615"><a href="#cb89-615" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(</span>
<span id="cb89-616"><a href="#cb89-616" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> vec_keep,</span>
<span id="cb89-617"><a href="#cb89-617" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> NMDS1, <span class="at">yend =</span> NMDS2),</span>
<span id="cb89-618"><a href="#cb89-618" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-619"><a href="#cb89-619" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.7</span>,</span>
<span id="cb89-620"><a href="#cb89-620" aria-hidden="true" tabindex="-1"></a>    <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.18</span>, <span class="st">"cm"</span>))</span>
<span id="cb89-621"><a href="#cb89-621" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-622"><a href="#cb89-622" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Species labels</span></span>
<span id="cb89-623"><a href="#cb89-623" aria-hidden="true" tabindex="-1"></a>  ggrepel<span class="sc">::</span><span class="fu">geom_text_repel</span>(</span>
<span id="cb89-624"><a href="#cb89-624" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> vec_keep,</span>
<span id="cb89-625"><a href="#cb89-625" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">label =</span> taxon),</span>
<span id="cb89-626"><a href="#cb89-626" aria-hidden="true" tabindex="-1"></a>    <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb89-627"><a href="#cb89-627" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="dv">3</span>,</span>
<span id="cb89-628"><a href="#cb89-628" aria-hidden="true" tabindex="-1"></a>    <span class="at">max.overlaps =</span> <span class="cn">Inf</span>,</span>
<span id="cb89-629"><a href="#cb89-629" aria-hidden="true" tabindex="-1"></a>    <span class="at">min.segment.length =</span> <span class="dv">0</span></span>
<span id="cb89-630"><a href="#cb89-630" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-631"><a href="#cb89-631" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors) <span class="sc">+</span></span>
<span id="cb89-632"><a href="#cb89-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb89-633"><a href="#cb89-633" aria-hidden="true" tabindex="-1"></a>    <span class="co">#title = "Mobile invertebrates NMDS biplot",</span></span>
<span id="cb89-634"><a href="#cb89-634" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Stress = "</span>, <span class="fu">round</span>(nmds_mobile<span class="sc">$</span>stress, <span class="dv">3</span>)),</span>
<span id="cb89-635"><a href="#cb89-635" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Season"</span>,</span>
<span id="cb89-636"><a href="#cb89-636" aria-hidden="true" tabindex="-1"></a>    <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span></span>
<span id="cb89-637"><a href="#cb89-637" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb89-638"><a href="#cb89-638" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb89-639"><a href="#cb89-639" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb89-640"><a href="#cb89-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-641"><a href="#cb89-641" aria-hidden="true" tabindex="-1"></a>p_biplot_mobile</span>
<span id="cb89-642"><a href="#cb89-642" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-643"><a href="#cb89-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-644"><a href="#cb89-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-645"><a href="#cb89-645" aria-hidden="true" tabindex="-1"></a><span class="fu">### Univariate summaries (total abundance)</span></span>
<span id="cb89-646"><a href="#cb89-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-647"><a href="#cb89-647" aria-hidden="true" tabindex="-1"></a>These are interpretable “whole-community” metrics.</span>
<span id="cb89-648"><a href="#cb89-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-651"><a href="#cb89-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-652"><a href="#cb89-652" aria-hidden="true" tabindex="-1"></a>mobile_alpha <span class="ot">&lt;-</span> mobile_grouped <span class="sc">%&gt;%</span></span>
<span id="cb89-653"><a href="#cb89-653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rowwise</span>() <span class="sc">%&gt;%</span></span>
<span id="cb89-654"><a href="#cb89-654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb89-655"><a href="#cb89-655" aria-hidden="true" tabindex="-1"></a>    <span class="co">#  mobile plot is 0.25 m² -- I think??? what is it?</span></span>
<span id="cb89-656"><a href="#cb89-656" aria-hidden="true" tabindex="-1"></a>    <span class="at">area_m2 =</span> <span class="fl">0.25</span>,</span>
<span id="cb89-657"><a href="#cb89-657" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_abund =</span> <span class="fu">sum</span>(<span class="fu">c_across</span>(<span class="fu">all_of</span>(<span class="fu">colnames</span>(mobile_mat))), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb89-658"><a href="#cb89-658" aria-hidden="true" tabindex="-1"></a>    <span class="at">total_abund_m2 =</span> total_abund <span class="sc">/</span> area_m2,</span>
<span id="cb89-659"><a href="#cb89-659" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb89-660"><a href="#cb89-660" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb89-661"><a href="#cb89-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-662"><a href="#cb89-662" aria-hidden="true" tabindex="-1"></a>mobile_alpha <span class="sc">%&gt;%</span> <span class="fu">select</span>(season, col_pres, transect, total_abund) <span class="sc">%&gt;%</span> <span class="fu">glimpse</span>()</span>
<span id="cb89-663"><a href="#cb89-663" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-664"><a href="#cb89-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-665"><a href="#cb89-665" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Mixed models for Individual metrics</span></span>
<span id="cb89-666"><a href="#cb89-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-667"><a href="#cb89-667" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`total_abund`</span>: NB GLMM</span>
<span id="cb89-668"><a href="#cb89-668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-671"><a href="#cb89-671" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-672"><a href="#cb89-672" aria-hidden="true" tabindex="-1"></a>m_mobile_total <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb89-673"><a href="#cb89-673" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts with area offset to infer abundance density (per m²)</span></span>
<span id="cb89-674"><a href="#cb89-674" aria-hidden="true" tabindex="-1"></a>  total_abund <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect),</span>
<span id="cb89-675"><a href="#cb89-675" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb89-676"><a href="#cb89-676" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile_alpha</span>
<span id="cb89-677"><a href="#cb89-677" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-678"><a href="#cb89-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-679"><a href="#cb89-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-680"><a href="#cb89-680" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mobile_total)</span>
<span id="cb89-681"><a href="#cb89-681" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at the species pairs</span></span>
<span id="cb89-682"><a href="#cb89-682" aria-hidden="true" tabindex="-1"></a>emm_total <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_mobile_total, <span class="sc">~</span> col_pres<span class="sc">|</span>season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb89-683"><a href="#cb89-683" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_total, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb89-684"><a href="#cb89-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-685"><a href="#cb89-685" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(m_mobile_total)</span>
<span id="cb89-686"><a href="#cb89-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-687"><a href="#cb89-687" aria-hidden="true" tabindex="-1"></a><span class="co"># here is your example for limpets.  Do for the rest of the species</span></span>
<span id="cb89-688"><a href="#cb89-688" aria-hidden="true" tabindex="-1"></a>m_mobile_Limpet <span class="ot">&lt;-</span> <span class="fu">glmmTMB</span>(</span>
<span id="cb89-689"><a href="#cb89-689" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Model counts with area offset to infer abundance density (per m²)</span></span>
<span id="cb89-690"><a href="#cb89-690" aria-hidden="true" tabindex="-1"></a>  Limpets <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> <span class="fu">offset</span>(<span class="fu">log</span>(area_m2)) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect),</span>
<span id="cb89-691"><a href="#cb89-691" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">nbinom2</span>(),</span>
<span id="cb89-692"><a href="#cb89-692" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> mobile_alpha</span>
<span id="cb89-693"><a href="#cb89-693" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-694"><a href="#cb89-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-695"><a href="#cb89-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-696"><a href="#cb89-696" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m_mobile_Limpet)</span>
<span id="cb89-697"><a href="#cb89-697" aria-hidden="true" tabindex="-1"></a>emm_limpet <span class="ot">&lt;-</span> <span class="fu">emmeans</span>(m_mobile_Limpet, <span class="sc">~</span> col_pres<span class="sc">|</span>season, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb89-698"><a href="#cb89-698" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(emm_limpet, <span class="at">adjust =</span> <span class="st">"tukey"</span>)</span>
<span id="cb89-699"><a href="#cb89-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-700"><a href="#cb89-700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-701"><a href="#cb89-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-702"><a href="#cb89-702" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure: total abundance by COL presence and season</span></span>
<span id="cb89-703"><a href="#cb89-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-706"><a href="#cb89-706" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-707"><a href="#cb89-707" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 14</span></span>
<span id="cb89-708"><a href="#cb89-708" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 6 </span></span>
<span id="cb89-709"><a href="#cb89-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-710"><a href="#cb89-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-711"><a href="#cb89-711" aria-hidden="true" tabindex="-1"></a><span class="co"># everything</span></span>
<span id="cb89-712"><a href="#cb89-712" aria-hidden="true" tabindex="-1"></a>p_alpha <span class="ot">&lt;-</span> mobile_alpha <span class="sc">%&gt;%</span></span>
<span id="cb89-713"><a href="#cb89-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(Limpets<span class="sc">:</span>Whelks, total_abund_m2 </span>
<span id="cb89-714"><a href="#cb89-714" aria-hidden="true" tabindex="-1"></a>                       </span>
<span id="cb89-715"><a href="#cb89-715" aria-hidden="true" tabindex="-1"></a>                        ), <span class="at">names_to =</span> <span class="st">"metric"</span>, <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-716"><a href="#cb89-716" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_log =</span> value<span class="sc">+</span><span class="dv">1</span>)<span class="sc">%&gt;%</span></span>
<span id="cb89-717"><a href="#cb89-717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> value_log, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb89-718"><a href="#cb89-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log"</span>)<span class="sc">+</span></span>
<span id="cb89-719"><a href="#cb89-719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb89-720"><a href="#cb89-720" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb89-721"><a href="#cb89-721" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb89-722"><a href="#cb89-722" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb89-723"><a href="#cb89-723" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> season), <span class="at">color =</span> <span class="cn">NULL</span>)<span class="sc">+</span> <span class="co">#outlier.shape = NA, alpha = 0.5) +</span></span>
<span id="cb89-724"><a href="#cb89-724" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>))<span class="sc">+</span></span>
<span id="cb89-725"><a href="#cb89-725" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> metric, <span class="at">scales =</span> <span class="st">"free_y"</span>)<span class="sc">+</span></span>
<span id="cb89-726"><a href="#cb89-726" aria-hidden="true" tabindex="-1"></a>            <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Density (m⁻²)"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">fill =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb89-727"><a href="#cb89-727" aria-hidden="true" tabindex="-1"></a>      <span class="co"># title = "Mobile invertebrate alpha metrics vs limpet presence and season"</span></span>
<span id="cb89-728"><a href="#cb89-728" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb89-729"><a href="#cb89-729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb89-730"><a href="#cb89-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-731"><a href="#cb89-731" aria-hidden="true" tabindex="-1"></a><span class="do">## total abundance only</span></span>
<span id="cb89-732"><a href="#cb89-732" aria-hidden="true" tabindex="-1"></a>p_total <span class="ot">&lt;-</span> mobile_alpha <span class="sc">%&gt;%</span></span>
<span id="cb89-733"><a href="#cb89-733" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> total_abund_m2<span class="sc">+</span><span class="dv">1</span>, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb89-734"><a href="#cb89-734" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_trans</span>(<span class="at">y =</span> <span class="st">"log"</span>)<span class="sc">+</span></span>
<span id="cb89-735"><a href="#cb89-735" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb89-736"><a href="#cb89-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> season_colors)<span class="sc">+</span></span>
<span id="cb89-737"><a href="#cb89-737" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb89-738"><a href="#cb89-738" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">alpha =</span> <span class="fl">0.25</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>,</span>
<span id="cb89-739"><a href="#cb89-739" aria-hidden="true" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">fill =</span> season), <span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>)<span class="sc">+</span> <span class="co">#outlier.shape = NA, alpha = 0.5) +</span></span>
<span id="cb89-740"><a href="#cb89-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), <span class="at">size =</span> <span class="fl">1.5</span>)<span class="sc">+</span></span>
<span id="cb89-741"><a href="#cb89-741" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Total density (m⁻²)"</span>, <span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb89-742"><a href="#cb89-742" aria-hidden="true" tabindex="-1"></a>      <span class="co"># title = "Mobile invertebrate alpha metrics vs limpet presence and season"</span></span>
<span id="cb89-743"><a href="#cb89-743" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb89-744"><a href="#cb89-744" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb89-745"><a href="#cb89-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-746"><a href="#cb89-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-747"><a href="#cb89-747" aria-hidden="true" tabindex="-1"></a><span class="do">## add in brackets for yes/no pairs for ones that are significant based on emmeans and clean up the title of total_abunc... and double check that the area is correct since I think you did it two different ways</span></span>
<span id="cb89-748"><a href="#cb89-748" aria-hidden="true" tabindex="-1"></a>p_alpha<span class="sc">+</span>p_biplot_mobile<span class="sc">+</span><span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"a"</span>)</span>
<span id="cb89-749"><a href="#cb89-749" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"figure2.png"</span>, <span class="at">width =</span> <span class="dv">14</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb89-750"><a href="#cb89-750" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-751"><a href="#cb89-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-752"><a href="#cb89-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-753"><a href="#cb89-753" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-754"><a href="#cb89-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-755"><a href="#cb89-755" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sessile community (% cover / proportional cover)</span></span>
<span id="cb89-756"><a href="#cb89-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-757"><a href="#cb89-757" aria-hidden="true" tabindex="-1"></a><span class="fu">### Identify sessile cover columns --- i dont trust this analysis rn</span></span>
<span id="cb89-758"><a href="#cb89-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-761"><a href="#cb89-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-762"><a href="#cb89-762" aria-hidden="true" tabindex="-1"></a>sess_meta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"season"</span>,<span class="st">"date"</span>,<span class="st">"transect"</span>,<span class="st">"plot_name"</span>,<span class="st">"l_r"</span>,<span class="st">"meter_no"</span>,<span class="st">"col_pres"</span>,<span class="st">"t_f"</span>,<span class="st">"tag_id"</span>)</span>
<span id="cb89-763"><a href="#cb89-763" aria-hidden="true" tabindex="-1"></a>sess_spp <span class="ot">&lt;-</span> sessile <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">any_of</span>(sess_meta))</span>
<span id="cb89-764"><a href="#cb89-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-765"><a href="#cb89-765" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sess_spp)</span>
<span id="cb89-766"><a href="#cb89-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-767"><a href="#cb89-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-768"><a href="#cb89-768" aria-hidden="true" tabindex="-1"></a><span class="fu">### Multivariate test: PERMANOVA on gower</span></span>
<span id="cb89-769"><a href="#cb89-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-770"><a href="#cb89-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-773"><a href="#cb89-773" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-774"><a href="#cb89-774" aria-hidden="true" tabindex="-1"></a>sess_mat <span class="ot">&lt;-</span> sess_spp <span class="sc">%&gt;%</span></span>
<span id="cb89-775"><a href="#cb89-775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), <span class="sc">~</span><span class="fu">replace_na</span>(., <span class="dv">0</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb89-776"><a href="#cb89-776" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb89-777"><a href="#cb89-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-778"><a href="#cb89-778" aria-hidden="true" tabindex="-1"></a>sess_bc <span class="ot">&lt;-</span> <span class="fu">vegdist</span>(<span class="fu">sqrt</span>(sess_mat), <span class="at">method =</span> <span class="st">"gower"</span>)</span>
<span id="cb89-779"><a href="#cb89-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-780"><a href="#cb89-780" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb89-781"><a href="#cb89-781" aria-hidden="true" tabindex="-1"></a>adon_sess <span class="ot">&lt;-</span> <span class="fu">adonis2</span>(</span>
<span id="cb89-782"><a href="#cb89-782" aria-hidden="true" tabindex="-1"></a>  sess_bc <span class="sc">~</span> col_pres <span class="sc">*</span> season,</span>
<span id="cb89-783"><a href="#cb89-783" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> sessile,</span>
<span id="cb89-784"><a href="#cb89-784" aria-hidden="true" tabindex="-1"></a>  <span class="at">permutations =</span> <span class="dv">999</span>,</span>
<span id="cb89-785"><a href="#cb89-785" aria-hidden="true" tabindex="-1"></a>  <span class="at">strata =</span> sessile<span class="sc">$</span>transect</span>
<span id="cb89-786"><a href="#cb89-786" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb89-787"><a href="#cb89-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-788"><a href="#cb89-788" aria-hidden="true" tabindex="-1"></a>adon_sess</span>
<span id="cb89-789"><a href="#cb89-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-790"><a href="#cb89-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-791"><a href="#cb89-791" aria-hidden="true" tabindex="-1"></a><span class="fu">### Dispersion check</span></span>
<span id="cb89-792"><a href="#cb89-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-795"><a href="#cb89-795" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-796"><a href="#cb89-796" aria-hidden="true" tabindex="-1"></a>disp_sess <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(sess_bc, <span class="fu">interaction</span>(sessile<span class="sc">$</span>col_pres, sessile<span class="sc">$</span>season))</span>
<span id="cb89-797"><a href="#cb89-797" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(disp_sess)</span>
<span id="cb89-798"><a href="#cb89-798" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(disp_sess, <span class="at">permutations =</span> <span class="dv">999</span>)</span>
<span id="cb89-799"><a href="#cb89-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-800"><a href="#cb89-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-801"><a href="#cb89-801" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ordination: NMDS</span></span>
<span id="cb89-802"><a href="#cb89-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-805"><a href="#cb89-805" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-806"><a href="#cb89-806" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb89-807"><a href="#cb89-807" aria-hidden="true" tabindex="-1"></a>nmds_sess <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(sess_mat, <span class="at">distance =</span> <span class="st">"gower"</span>, <span class="at">k =</span> <span class="dv">2</span>, <span class="at">trymax =</span> <span class="dv">100</span>)</span>
<span id="cb89-808"><a href="#cb89-808" aria-hidden="true" tabindex="-1"></a>nmds_sess<span class="sc">$</span>stress</span>
<span id="cb89-809"><a href="#cb89-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-810"><a href="#cb89-810" aria-hidden="true" tabindex="-1"></a>scores_sess <span class="ot">&lt;-</span> <span class="fu">scores</span>(nmds_sess, <span class="at">display =</span> <span class="st">"sites"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-811"><a href="#cb89-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span></span>
<span id="cb89-812"><a href="#cb89-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_cols</span>(sessile <span class="sc">%&gt;%</span> <span class="fu">select</span>(season, col_pres, transect))</span>
<span id="cb89-813"><a href="#cb89-813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-814"><a href="#cb89-814" aria-hidden="true" tabindex="-1"></a>p_nmds_sess <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(scores_sess, <span class="fu">aes</span>(<span class="at">x =</span> NMDS1, <span class="at">y =</span> NMDS2, <span class="at">shape =</span> col_pres, <span class="at">color =</span> season)) <span class="sc">+</span></span>
<span id="cb89-815"><a href="#cb89-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.85</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb89-816"><a href="#cb89-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_ellipse</span>(<span class="fu">aes</span>(<span class="at">group =</span> <span class="fu">interaction</span>(season, col_pres)), <span class="at">level =</span> <span class="fl">0.68</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb89-817"><a href="#cb89-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sessile community: NMDS (gower on proportional cover)"</span>,</span>
<span id="cb89-818"><a href="#cb89-818" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste0</span>(<span class="st">"Stress = "</span>, <span class="fu">round</span>(nmds_sess<span class="sc">$</span>stress, <span class="dv">3</span>)),</span>
<span id="cb89-819"><a href="#cb89-819" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Owl limpet present?"</span>, <span class="at">color =</span> <span class="st">"Season"</span>) <span class="sc">+</span></span>
<span id="cb89-820"><a href="#cb89-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"right"</span>)</span>
<span id="cb89-821"><a href="#cb89-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-822"><a href="#cb89-822" aria-hidden="true" tabindex="-1"></a>p_nmds_sess</span>
<span id="cb89-823"><a href="#cb89-823" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-824"><a href="#cb89-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-825"><a href="#cb89-825" aria-hidden="true" tabindex="-1"></a><span class="fu">### Univariate analyses for key functional groups</span></span>
<span id="cb89-826"><a href="#cb89-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-827"><a href="#cb89-827" aria-hidden="true" tabindex="-1"></a>Depending on your ecological framing,  response variables may include:</span>
<span id="cb89-828"><a href="#cb89-828" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Bare rock** (space availability)</span>
<span id="cb89-829"><a href="#cb89-829" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Erect fleshy algae** (here likely <span class="in">`ulva_sp`</span>, <span class="in">`endocaldia_sp`</span>, etc.)</span>
<span id="cb89-830"><a href="#cb89-830" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Crustose coralline algae** (<span class="in">`coralline_crust`</span>)</span>
<span id="cb89-831"><a href="#cb89-831" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Barnacles** (<span class="in">`chtalmus_balanus`</span>)</span>
<span id="cb89-832"><a href="#cb89-832" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Tube worms** (<span class="in">`phragmatopoma_californica`</span>) etc.</span>
<span id="cb89-833"><a href="#cb89-833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-834"><a href="#cb89-834" aria-hidden="true" tabindex="-1"></a>Where is the microalgae?</span>
<span id="cb89-835"><a href="#cb89-835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-836"><a href="#cb89-836" aria-hidden="true" tabindex="-1"></a>Because cover is proportional (0–1), a practical approach is:</span>
<span id="cb89-837"><a href="#cb89-837" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>transform with <span class="in">`logit01()`</span> and use LMM/GLMM with Gaussian errors, OR</span>
<span id="cb89-838"><a href="#cb89-838" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Beta regression (more complex; <span class="in">`glmmTMB`</span> can do it with <span class="in">`family = beta_family()`</span>).</span>
<span id="cb89-839"><a href="#cb89-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-840"><a href="#cb89-840" aria-hidden="true" tabindex="-1"></a>Here we demonstrate logit-transformed LMMs with transect random intercepts.</span>
<span id="cb89-841"><a href="#cb89-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-844"><a href="#cb89-844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-845"><a href="#cb89-845" aria-hidden="true" tabindex="-1"></a><span class="co"># Choose a few focal cover variables to test (edit for your hypotheses)</span></span>
<span id="cb89-846"><a href="#cb89-846" aria-hidden="true" tabindex="-1"></a>focal_cover <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"bare_rock"</span>, <span class="st">"ulva_sp"</span>, <span class="st">"coralline_crust"</span>, <span class="st">"chtalmus_balanus"</span>, <span class="st">"ralfsia_sp"</span>)</span>
<span id="cb89-847"><a href="#cb89-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-848"><a href="#cb89-848" aria-hidden="true" tabindex="-1"></a>sess_long <span class="ot">&lt;-</span> sessile <span class="sc">%&gt;%</span></span>
<span id="cb89-849"><a href="#cb89-849" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">all_of</span>(focal_cover), <span class="at">names_to =</span> <span class="st">"taxon"</span>, <span class="at">values_to =</span> <span class="st">"cover"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb89-850"><a href="#cb89-850" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb89-851"><a href="#cb89-851" aria-hidden="true" tabindex="-1"></a>    <span class="at">cover =</span> <span class="fu">as.numeric</span>(cover),</span>
<span id="cb89-852"><a href="#cb89-852" aria-hidden="true" tabindex="-1"></a>    <span class="at">cover_logit =</span> <span class="fu">logit01</span>(cover)</span>
<span id="cb89-853"><a href="#cb89-853" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-854"><a href="#cb89-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-855"><a href="#cb89-855" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit one model per taxon (pre-specified list!)</span></span>
<span id="cb89-856"><a href="#cb89-856" aria-hidden="true" tabindex="-1"></a>models_cover <span class="ot">&lt;-</span> sess_long <span class="sc">%&gt;%</span></span>
<span id="cb89-857"><a href="#cb89-857" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(taxon) <span class="sc">%&gt;%</span></span>
<span id="cb89-858"><a href="#cb89-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_map</span>(<span class="sc">~</span>{</span>
<span id="cb89-859"><a href="#cb89-859" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lmer</span>(cover_logit <span class="sc">~</span> col_pres <span class="sc">*</span> season <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> transect), <span class="at">data =</span> .x)</span>
<span id="cb89-860"><a href="#cb89-860" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb89-861"><a href="#cb89-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-862"><a href="#cb89-862" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(models_cover) <span class="ot">&lt;-</span> <span class="fu">unique</span>(sess_long<span class="sc">$</span>taxon)</span>
<span id="cb89-863"><a href="#cb89-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-864"><a href="#cb89-864" aria-hidden="true" tabindex="-1"></a><span class="co"># Summaries</span></span>
<span id="cb89-865"><a href="#cb89-865" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(models_cover, summary)</span>
<span id="cb89-866"><a href="#cb89-866" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-867"><a href="#cb89-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-868"><a href="#cb89-868" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Figure: focal cover responses</span></span>
<span id="cb89-869"><a href="#cb89-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-872"><a href="#cb89-872" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb89-873"><a href="#cb89-873" aria-hidden="true" tabindex="-1"></a>p_cover <span class="ot">&lt;-</span> sess_long <span class="sc">%&gt;%</span></span>
<span id="cb89-874"><a href="#cb89-874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> season, <span class="at">y =</span> cover, <span class="at">fill =</span> col_pres)) <span class="sc">+</span></span>
<span id="cb89-875"><a href="#cb89-875" aria-hidden="true" tabindex="-1"></a><span class="co">#  geom_point(position = position_dodge(width = 0.7))+</span></span>
<span id="cb89-876"><a href="#cb89-876" aria-hidden="true" tabindex="-1"></a> <span class="co"># ggdist::stat_halfeye(position = position_dodge(width = 0.7), alpha = 0.7) +</span></span>
<span id="cb89-877"><a href="#cb89-877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="fl">0.7</span>), </span>
<span id="cb89-878"><a href="#cb89-878" aria-hidden="true" tabindex="-1"></a>              <span class="co"># outlier.shape = NA, </span></span>
<span id="cb89-879"><a href="#cb89-879" aria-hidden="true" tabindex="-1"></a>               <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb89-880"><a href="#cb89-880" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> taxon, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb89-881"><a href="#cb89-881" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Proportional cover"</span>, <span class="at">fill =</span> <span class="st">"Owl limpet present?"</span>,</span>
<span id="cb89-882"><a href="#cb89-882" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Sessile functional/taxon cover vs limpet presence and season"</span>) <span class="sc">+</span></span>
<span id="cb89-883"><a href="#cb89-883" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span>
<span id="cb89-884"><a href="#cb89-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-885"><a href="#cb89-885" aria-hidden="true" tabindex="-1"></a>p_cover</span>
<span id="cb89-886"><a href="#cb89-886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb89-887"><a href="#cb89-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-888"><a href="#cb89-888" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-889"><a href="#cb89-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-890"><a href="#cb89-890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-891"><a href="#cb89-891" aria-hidden="true" tabindex="-1"></a><span class="fu">## Ecological interpretation (how to read results -- fill in below with your references)</span></span>
<span id="cb89-892"><a href="#cb89-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-893"><a href="#cb89-893" aria-hidden="true" tabindex="-1"></a><span class="fu">### 1) Seasonal density and size patterns (what’s plausible)</span></span>
<span id="cb89-894"><a href="#cb89-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-895"><a href="#cb89-895" aria-hidden="true" tabindex="-1"></a>Depending on your results, common mechanisms include:</span>
<span id="cb89-896"><a href="#cb89-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-897"><a href="#cb89-897" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Recruitment pulses** (seasonal larval supply) can increase density of **small** limpets after settlement.</span>
<span id="cb89-898"><a href="#cb89-898" aria-hidden="true" tabindex="-1"></a>-- What else do you think?</span>
<span id="cb89-899"><a href="#cb89-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-900"><a href="#cb89-900" aria-hidden="true" tabindex="-1"></a>For owl limpets specifically:</span>
<span id="cb89-901"><a href="#cb89-901" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*Lottia gigantea* is well known for **territorial grazing** that can maintain “gardens” of microalgae and influence space availability and algal cover (citations).  </span>
<span id="cb89-902"><a href="#cb89-902" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>What else?</span>
<span id="cb89-903"><a href="#cb89-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-904"><a href="#cb89-904" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2) Limpet presence effects on community composition (expected directions)</span></span>
<span id="cb89-905"><a href="#cb89-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-906"><a href="#cb89-906" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>fill in</span>
<span id="cb89-907"><a href="#cb89-907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-908"><a href="#cb89-908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-909"><a href="#cb89-909" aria-hidden="true" tabindex="-1"></a>**Season interactions** are common because:</span>
<span id="cb89-910"><a href="#cb89-910" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>why?</span>
<span id="cb89-911"><a href="#cb89-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-912"><a href="#cb89-912" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-913"><a href="#cb89-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-914"><a href="#cb89-914" aria-hidden="true" tabindex="-1"></a><span class="fu">### potenitial storyline</span></span>
<span id="cb89-915"><a href="#cb89-915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-916"><a href="#cb89-916" aria-hidden="true" tabindex="-1"></a>**“Seasonal dynamics modulate the engineering role of a territorial grazer.”**</span>
<span id="cb89-917"><a href="#cb89-917" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-918"><a href="#cb89-918" aria-hidden="true" tabindex="-1"></a><span class="fu">### Journals to think about</span></span>
<span id="cb89-919"><a href="#cb89-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-920"><a href="#cb89-920" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*Marine Ecology Progress Series* (MEPS)</span>
<span id="cb89-921"><a href="#cb89-921" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*Journal of Experimental Marine Biology and Ecology*</span>
<span id="cb89-922"><a href="#cb89-922" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>*PeerJ*</span>
<span id="cb89-923"><a href="#cb89-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-924"><a href="#cb89-924" aria-hidden="true" tabindex="-1"></a>---</span>
<span id="cb89-925"><a href="#cb89-925" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>